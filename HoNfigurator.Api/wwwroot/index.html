<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoNfigurator Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ===== BASE STYLES ===== */
        [x-cloak] { display: none !important; }
        body { font-family: 'Inter', sans-serif; }
        
        /* HoN Background */
        .bg-hon-dashboard {
            background: 
                radial-gradient(ellipse at top, rgba(10, 20, 30, 0.7) 0%, rgba(5, 10, 15, 0.9) 100%),
                radial-gradient(ellipse at center, transparent 0%, rgba(0, 0, 0, 0.4) 100%),
                linear-gradient(180deg, rgba(0, 30, 60, 0.3) 0%, rgba(0, 10, 20, 0.5) 100%),
                url('https://media.discordapp.net/attachments/1453364977535549574/1453368049028563077/wallpaper.png?ex=694d31f9&is=694be079&hm=488453cd11bb752a6668eb4322049e4425949f9861004336c915f55f345fac1b&=&format=webp&quality=lossless&width=550&height=309') center center / cover no-repeat fixed;
        }
        
        /* Custom Selection */
        ::selection { background: rgba(59, 130, 246, 0.3); color: white; }
        
        /* ===== STATUS INDICATORS ===== */
        .status-ready { background-color: #10B981; box-shadow: 0 0 15px rgba(16, 185, 129, 0.6); }
        .status-occupied { background-color: #F59E0B; box-shadow: 0 0 15px rgba(245, 158, 11, 0.6); }
        .status-starting { background-color: #3B82F6; box-shadow: 0 0 15px rgba(59, 130, 246, 0.6); }
        .status-idle { background-color: #8B5CF6; box-shadow: 0 0 15px rgba(139, 92, 246, 0.6); }
        .status-unknown { background-color: #6B7280; box-shadow: 0 0 10px rgba(107, 114, 128, 0.4); }
        .status-crashed { background-color: #EF4444; box-shadow: 0 0 15px rgba(239, 68, 68, 0.6); }
        .status-offline { background-color: #374151; box-shadow: 0 0 10px rgba(55, 65, 81, 0.4); }
        
        /* ===== ANIMATIONS ===== */
        @keyframes pulse-slow { 
            0%, 100% { opacity: 1; } 
            50% { opacity: 0.5; } 
        }
        .animate-pulse-slow { animation: pulse-slow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }
        
        @keyframes fadeInUp { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        .animate-fadeInUp { animation: fadeInUp 0.4s ease-out forwards; }
        
        @keyframes slideIn { 
            from { opacity: 0; transform: scale(0.95); } 
            to { opacity: 1; transform: scale(1); } 
        }
        .animate-slideIn { animation: slideIn 0.2s ease-out forwards; }
        
        @keyframes slideInRight { 
            from { opacity: 0; transform: translateX(20px); } 
            to { opacity: 1; transform: translateX(0); } 
        }
        .animate-slideInRight { animation: slideInRight 0.3s ease-out forwards; }
        
        @keyframes shimmer { 
            0% { background-position: -200% 0; } 
            100% { background-position: 200% 0; } 
        }
        .skeleton { 
            background: linear-gradient(90deg, #374151 25%, #4B5563 50%, #374151 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        .animate-float { animation: float 3s ease-in-out infinite; }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px currentColor; }
            50% { box-shadow: 0 0 20px currentColor, 0 0 30px currentColor; }
        }
        .animate-glow { animation: glow 2s ease-in-out infinite; }
        
        @keyframes spin-slow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin-slow { animation: spin-slow 3s linear infinite; }
        
        @keyframes bounce-subtle {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        .animate-bounce-subtle { animation: bounce-subtle 2s ease-in-out infinite; }
        
        /* ===== GLASS MORPHISM ===== */
        .glass {
            background: rgba(31, 41, 55, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        .glass-card {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.9), rgba(17, 24, 39, 0.9));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        .glass-hover:hover {
            background: rgba(55, 65, 81, 0.6);
            border-color: rgba(107, 114, 128, 0.5);
        }
        
        /* ===== CARD STYLES ===== */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.4), 0 10px 20px -5px rgba(0, 0, 0, 0.3);
        }
        
        .card-glow {
            position: relative;
            overflow: hidden;
        }
        .card-glow::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            transition: left 0.5s ease;
        }
        .card-glow:hover::before {
            left: 100%;
        }
        
        /* ===== GRADIENT EFFECTS ===== */
        .gradient-text {
            background: linear-gradient(135deg, #60A5FA, #A78BFA);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .gradient-border {
            position: relative;
            background: linear-gradient(135deg, #1F2937, #111827);
        }
        .gradient-border::before {
            content: '';
            position: absolute;
            inset: 0;
            padding: 1px;
            border-radius: inherit;
            background: linear-gradient(135deg, #3B82F6, #8B5CF6);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }
        
        /* ===== BUTTON STYLES ===== */
        .btn-primary {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #60A5FA, #3B82F6);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }
        .btn-success:hover {
            background: linear-gradient(135deg, #34D399, #10B981);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
            transition: all 0.3s ease;
        }
        .btn-danger:hover {
            background: linear-gradient(135deg, #F87171, #EF4444);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
            transition: all 0.3s ease;
        }
        .btn-warning:hover {
            background: linear-gradient(135deg, #FBBF24, #F59E0B);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
            transform: translateY(-2px);
        }
        
        .btn-ghost {
            background: transparent;
            border: 1px solid rgba(75, 85, 99, 0.5);
            transition: all 0.3s ease;
        }
        .btn-ghost:hover {
            background: rgba(75, 85, 99, 0.3);
            border-color: rgba(107, 114, 128, 0.7);
        }
        
        .btn-glow:hover {
            box-shadow: 0 0 25px rgba(59, 130, 246, 0.5);
        }
        
        .btn-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            transition: all 0.2s ease;
        }
        .btn-icon:hover {
            transform: scale(1.1);
        }
        
        /* ===== INPUT STYLES ===== */
        .input-field {
            background: rgba(31, 41, 55, 0.5);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 12px;
            padding: 12px 16px;
            transition: all 0.3s ease;
            color: white;
        }
        .input-field:focus {
            outline: none;
            border-color: #3B82F6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
            background: rgba(31, 41, 55, 0.8);
        }
        .input-field::placeholder {
            color: #6B7280;
        }
        
        .input-number {
            -moz-appearance: textfield;
        }
        .input-number::-webkit-outer-spin-button,
        .input-number::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        /* ===== SCROLLBAR ===== */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1F2937; border-radius: 4px; }
        ::-webkit-scrollbar-thumb { 
            background: linear-gradient(180deg, #4B5563, #374151); 
            border-radius: 4px; 
        }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(180deg, #6B7280, #4B5563); }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { 
            background: rgba(75, 85, 99, 0.5); 
            border-radius: 3px; 
        }
        
        /* ===== SIDEBAR ===== */
        .sidebar-overlay {
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            transition: opacity 0.3s ease;
        }
        
        .sidebar-mobile {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        @media (max-width: 768px) {
            .sidebar-mobile {
                transform: translateX(-100%);
            }
            .sidebar-mobile.open {
                transform: translateX(0);
            }
        }
        
        .sidebar-item {
            position: relative;
            transition: all 0.2s ease;
        }
        .sidebar-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 0;
            background: linear-gradient(180deg, #3B82F6, #8B5CF6);
            border-radius: 0 2px 2px 0;
            transition: height 0.2s ease;
        }
        .sidebar-item:hover::before,
        .sidebar-item.active::before {
            height: 60%;
        }
        
        /* ===== TABLE STYLES ===== */
        .table-row-hover {
            transition: all 0.2s ease;
        }
        .table-row-hover:hover {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1), transparent);
        }
        
        .table-header {
            background: linear-gradient(180deg, rgba(31, 41, 55, 0.9), rgba(17, 24, 39, 0.9));
            backdrop-filter: blur(10px);
        }
        
        /* ===== MODAL STYLES ===== */
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1F2937 0%, #111827 100%);
            border: 1px solid rgba(75, 85, 99, 0.3);
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.05) inset;
        }
        
        .modal-header {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1), transparent);
            border-bottom: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        /* ===== PROGRESS BAR ===== */
        .progress-bar {
            transition: width 0.5s ease-out;
        }
        
        .progress-bar-animated {
            background-size: 30px 30px;
            background-image: linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.15) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, 0.15) 50%,
                rgba(255, 255, 255, 0.15) 75%,
                transparent 75%,
                transparent
            );
            animation: progress-animation 1s linear infinite;
        }
        @keyframes progress-animation {
            0% { background-position: 30px 0; }
            100% { background-position: 0 0; }
        }
        
        /* ===== TOOLTIP ===== */
        .tooltip {
            position: relative;
        }
        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%) scale(0.8);
            padding: 6px 12px;
            background: linear-gradient(135deg, #1F2937, #111827);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 8px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .tooltip:hover::after {
            opacity: 1;
            transform: translateX(-50%) scale(1);
        }
        
        /* ===== TOAST NOTIFICATIONS ===== */
        .toast {
            animation: toast-in 0.3s ease-out;
        }
        @keyframes toast-in {
            from { 
                opacity: 0; 
                transform: translateX(100%); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }
        
        .toast-success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1));
            border-left: 4px solid #10B981;
        }
        .toast-error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            border-left: 4px solid #EF4444;
        }
        .toast-warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(245, 158, 11, 0.1));
            border-left: 4px solid #F59E0B;
        }
        .toast-info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(59, 130, 246, 0.1));
            border-left: 4px solid #3B82F6;
        }
        
        /* ===== BADGE STYLES ===== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 9999px;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .badge-success {
            background: rgba(16, 185, 129, 0.2);
            color: #34D399;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        .badge-warning {
            background: rgba(245, 158, 11, 0.2);
            color: #FBBF24;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        .badge-danger {
            background: rgba(239, 68, 68, 0.2);
            color: #F87171;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        .badge-info {
            background: rgba(59, 130, 246, 0.2);
            color: #60A5FA;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        .badge-purple {
            background: rgba(139, 92, 246, 0.2);
            color: #A78BFA;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        /* ===== SWITCH/TOGGLE ===== */
        .switch {
            position: relative;
            width: 48px;
            height: 24px;
            background: #374151;
            border-radius: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .switch.active {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.4);
        }
        .switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .switch.active::after {
            left: 26px;
        }
        
        /* ===== TAB STYLES ===== */
        .tab-item {
            position: relative;
            padding: 10px 16px;
            color: #9CA3AF;
            transition: all 0.2s ease;
        }
        .tab-item::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #3B82F6, #8B5CF6);
            transition: width 0.2s ease;
        }
        .tab-item:hover {
            color: #E5E7EB;
        }
        .tab-item.active {
            color: white;
        }
        .tab-item.active::after {
            width: 80%;
        }
        
        /* ===== CONSOLE/LOG STYLES ===== */
        .console-log {
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 13px;
            line-height: 1.6;
        }
        .log-line {
            padding: 2px 0;
            transition: background 0.1s ease;
        }
        .log-line:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        .log-timestamp {
            color: #6B7280;
        }
        .log-info {
            color: #60A5FA;
        }
        .log-success {
            color: #34D399;
        }
        .log-warning {
            color: #FBBF24;
        }
        .log-error {
            color: #F87171;
        }
        
        /* ===== CHART STYLES ===== */
        .chart-container {
            position: relative;
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.5), rgba(17, 24, 39, 0.5));
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        /* ===== RING/CIRCULAR PROGRESS ===== */
        .ring-progress {
            transform: rotate(-90deg);
        }
        .ring-progress circle {
            transition: stroke-dashoffset 0.5s ease;
        }
        
        /* ===== TEAM COLORS ===== */
        .team-legion {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(59, 130, 246, 0.1));
            border: 1px solid rgba(59, 130, 246, 0.3);
        }
        .team-hellbourne {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        .team-spectator {
            background: linear-gradient(135deg, rgba(107, 114, 128, 0.2), rgba(107, 114, 128, 0.1));
            border: 1px solid rgba(107, 114, 128, 0.3);
        }
        
        /* ===== RESPONSIVE UTILITIES ===== */
        @media (max-width: 640px) {
            .mobile-full { width: 100%; }
            .mobile-hidden { display: none; }
        }
        
        /* ===== LOADING STATES ===== */
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        .loading-spinner {
            border: 3px solid rgba(59, 130, 246, 0.2);
            border-top-color: #3B82F6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ===== FOCUS STYLES ===== */
        .focus-ring:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        /* ===== HOVER LIFT ===== */
        .hover-lift {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .hover-lift:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.3);
        }
        
        /* ===== SHINE EFFECT ===== */
        .shine {
            position: relative;
            overflow: hidden;
        }
        .shine::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to right,
                transparent 0%,
                rgba(255, 255, 255, 0.05) 50%,
                transparent 100%
            );
            transform: rotate(30deg);
            animation: shine 3s infinite;
        }
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(30deg); }
            100% { transform: translateX(100%) rotate(30deg); }
        }
    </style>
</head>
<body class="bg-hon-dashboard bg-gray-900 text-white min-h-screen" x-data="dashboard()" x-init="init()">
    <!-- Header -->
    <header class="glass border-b border-gray-700/50 px-4 md:px-6 py-3 md:py-4 sticky top-0 z-40">
        <div class="flex items-center justify-between max-w-[2000px] mx-auto">
            <div class="flex items-center space-x-2 md:space-x-4">
                <!-- Mobile Menu Button -->
                <button @click="sidebarOpen = !sidebarOpen" class="md:hidden text-gray-400 hover:text-white p-2 rounded-lg hover:bg-gray-700/50 transition-all">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="flex items-center">
                    <img src="https://media.discordapp.net/attachments/1453364977535549574/1453549147327299614/Gemini_Generated_Image_rkhw4hrkhw4hrkhw-Photoroom.png?ex=694ddaa2&is=694c8922&hm=8d1077142e226a49c3cb10fb47679a6ffa18eb8f9e0db978a399f86f72606c3a&=&format=webp&quality=lossless" alt="HoNfigurator" class="w-44 h-25">
                </div>
                <span class="px-3 py-1.5 bg-gradient-to-r from-blue-600 to-blue-700 rounded-full text-xs font-medium shadow-lg" x-text="serverName"></span>

                
                <!-- Connection Status Indicator (in header) -->
                <div class="flex items-center space-x-2 px-3 py-1.5 bg-red-500/10 border border-red-500/30 rounded-full animate-pulse-slow"
                     x-show="!status.master_server_connected || !status.chat_server_connected">
                    <i class="fas fa-exclamation-triangle text-red-400 text-sm"></i>
                    <span class="text-red-400 text-xs font-medium hidden sm:inline">
                        <span x-show="!status.master_server_connected && !status.chat_server_connected">Servers Offline</span>
                        <span x-show="!status.master_server_connected && status.chat_server_connected">Master Offline</span>
                        <span x-show="status.master_server_connected && !status.chat_server_connected">Chat Offline</span>
                    </span>
                </div>
            </div>
            <div class="flex items-center space-x-2 md:space-x-3">
                <!-- User Info - Hidden on mobile -->
                <div class="hidden md:flex items-center space-x-3 bg-gray-800/50 rounded-full px-3 py-1.5" x-show="authUser">
                    <div class="w-7 h-7 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-user text-xs"></i>
                    </div>
                    <span class="text-gray-300 text-sm font-medium" x-text="window.authUser || 'Admin'"></span>
                    <button @click="logout()" class="text-gray-400 hover:text-red-400 transition-colors p-1 hover:bg-red-500/10 rounded-full" title="Logout">
                        <i class="fas fa-sign-out-alt text-sm"></i>
                    </button>
                </div>
                <!-- Auto Refresh - Compact on mobile -->
                <div class="hidden sm:flex items-center space-x-2 bg-gray-800/50 rounded-full px-3 py-1.5">
                    <span class="text-gray-400 text-xs hidden lg:inline" x-text="t('autoRefresh')"></span>
                    <button @click="toggleAutoRefresh()" 
                            :class="autoRefresh ? 'bg-green-500 shadow-green-500/30' : 'bg-gray-600'"
                            class="w-12 h-6 rounded-full relative transition-all duration-300 shadow-lg">
                        <span class="absolute top-1 transition-all duration-300 w-4 h-4 bg-white rounded-full shadow"
                              :class="autoRefresh ? 'left-7' : 'left-1'"></span>
                    </button>
                </div>
                <!-- Language Selector -->
                <div class="relative" x-data="{ langOpen: false }">
                    <button @click="langOpen = !langOpen" 
                            class="flex items-center space-x-1.5 bg-gray-800/50 hover:bg-gray-700/50 px-3 py-2 rounded-full text-sm transition-all border border-gray-700/50">
                        <i class="fas fa-globe text-blue-400"></i>
                        <span class="hidden md:inline font-medium" x-text="currentLang === 'en' ? 'EN' : 'TH'"></span>
                        <i class="fas fa-chevron-down text-xs text-gray-500"></i>
                    </button>
                    <div x-show="langOpen" @click.away="langOpen = false" x-cloak x-transition:enter="transition ease-out duration-200"
                         x-transition:enter-start="opacity-0 transform scale-95" x-transition:enter-end="opacity-100 transform scale-100"
                         class="absolute right-0 mt-2 w-36 glass border border-gray-700/50 rounded-xl shadow-2xl overflow-hidden z-50">
                        <button @click="setLanguage('en'); langOpen = false" 
                                class="w-full px-4 py-2.5 text-left hover:bg-gray-700/50 flex items-center space-x-2 transition-all"
                                :class="currentLang === 'en' ? 'bg-blue-600/20 text-blue-400' : ''">
                            <span class="text-lg">๐ฌ๐ง</span>
                            <span class="font-medium">English</span>
                        </button>
                        <button @click="setLanguage('th'); langOpen = false" 
                                class="w-full px-4 py-2.5 text-left hover:bg-gray-700/50 flex items-center space-x-2 transition-all"
                                :class="currentLang === 'th' ? 'bg-blue-600/20 text-blue-400' : ''">
                            <span class="text-lg">๐น๐ญ</span>
                            <span class="font-medium">เนเธ—เธข</span>
                        </button>
                    </div>
                </div>
                <!-- Keyboard Shortcuts Button -->
                <button @click="showShortcutsModal = true" 
                        class="hidden lg:flex items-center space-x-1.5 bg-gray-800/50 hover:bg-gray-700/50 px-3 py-2 rounded-full text-sm transition-all border border-gray-700/50"
                        title="Keyboard Shortcuts (?)">
                    <i class="fas fa-keyboard text-gray-400"></i>
                    <kbd class="text-xs bg-gray-700 px-1.5 py-0.5 rounded font-mono">?</kbd>
                </button>
                <button @click="refresh()" class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 px-4 py-2 rounded-full transition-all shadow-lg btn-glow text-sm font-medium">
                    <i class="fas fa-sync-alt" :class="loading && 'animate-spin'"></i>
                    <span class="hidden sm:inline ml-2" x-text="t('refresh')"></span>
                </button>
                <!-- Mobile logout -->
                <a href="/logout" class="md:hidden text-gray-400 hover:text-red-400 p-2 rounded-lg hover:bg-red-500/10 transition-all" title="Logout" x-show="authUser">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex relative">
        <!-- Mobile Sidebar Overlay -->
        <div x-show="sidebarOpen" 
             @click="sidebarOpen = false"
             class="sidebar-overlay fixed inset-0 z-40 md:hidden"
             x-transition:enter="transition-opacity ease-out duration-300"
             x-transition:enter-start="opacity-0"
             x-transition:enter-end="opacity-100"
             x-transition:leave="transition-opacity ease-in duration-200"
             x-transition:leave-start="opacity-100"
             x-transition:leave-end="opacity-0"></div>
        
        <!-- Sidebar Navigation -->
        <div :class="sidebarOpen ? 'open' : ''" 
             class="sidebar-mobile fixed md:relative z-50 w-64 md:w-60 glass border-r border-gray-700/50 min-h-[calc(100vh-73px)] md:min-h-[calc(100vh-73px)] p-4 md:translate-x-0">
            <!-- Mobile Close Button -->
            <div class="flex justify-between items-center mb-6 md:hidden">
                <span class="text-lg font-semibold gradient-text">Menu</span>
                <button @click="sidebarOpen = false" class="text-gray-400 hover:text-white p-2 hover:bg-gray-700/50 rounded-lg transition-all">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav class="space-y-1">
                <button @click="activeTab = 'console'; refreshLogs(); sidebarOpen = false" 
                        :class="activeTab === 'console' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-terminal mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('console')"></span>
                </button>
                <button @click="activeTab = 'servers'; sidebarOpen = false" 
                        :class="activeTab === 'servers' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg flex items-center justify-between group">
                    <span><i class="fas fa-server mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('servers')"></span></span>
                    <span class="px-2 py-0.5 rounded-full text-xs font-bold" 
                          :class="instances.length > 0 ? 'bg-blue-500/20 text-blue-400' : 'bg-gray-600/50 text-gray-500'"
                          x-text="instances.length"></span>
                </button>
                <button @click="activeTab = 'config'; sidebarOpen = false" 
                        :class="activeTab === 'config' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-cog mr-3 group-hover:rotate-90 transition-transform"></i><span x-text="t('config')"></span>
                </button>
                <button @click="activeTab = 'system'; refreshSystemStatus(); sidebarOpen = false" 
                        :class="activeTab === 'system' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-microchip mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('system')"></span>
                </button>
                <button @click="activeTab = 'logs'; refreshServerLogs(); sidebarOpen = false" 
                        :class="activeTab === 'logs' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-file-alt mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('logs')"></span>
                </button>
                <button @click="activeTab = 'replays'; refreshReplays(); sidebarOpen = false" 
                        :class="activeTab === 'replays' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-film mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('replays')"></span>
                </button>
                <button @click="activeTab = 'statistics'; loadStatistics(); sidebarOpen = false" 
                        :class="activeTab === 'statistics' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-chart-bar mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('statistics')"></span>
                </button>
                <button @click="activeTab = 'scaling'; loadScalingStatus(); sidebarOpen = false" 
                        :class="activeTab === 'scaling' ? 'bg-gradient-to-r from-blue-600/20 to-transparent text-blue-400 border-l-2 border-blue-500' : 'text-gray-400 hover:bg-gray-700/30 hover:text-white border-l-2 border-transparent'"
                        class="w-full px-4 py-2.5 text-left font-medium transition-all rounded-r-lg group">
                    <i class="fas fa-expand-arrows-alt mr-3 group-hover:scale-110 transition-transform"></i><span x-text="t('autoScaling')"></span>
                </button>
            </nav>
            
            <!-- Status Summary in Sidebar -->
            <div class="mt-6 pt-6 border-t border-gray-700/50 space-y-3">
                <div class="bg-gray-800/30 rounded-xl p-3 space-y-3">
                    <div class="flex items-center justify-between text-sm">
                        <span class="text-gray-500 text-xs uppercase tracking-wide" x-text="t('masterServer')"></span>
                        <div class="flex items-center space-x-2">
                            <span class="w-2 h-2 rounded-full animate-pulse" :class="status.master_server_connected ? 'bg-green-500' : 'bg-red-500'"></span>
                            <span class="text-xs" :class="status.master_server_connected ? 'text-green-400' : 'text-red-400'" 
                                  x-text="status.master_server_connected ? 'Online' : 'Offline'"></span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between text-sm">
                        <span class="text-gray-500 text-xs uppercase tracking-wide" x-text="t('chatServer')"></span>
                        <div class="flex items-center space-x-2">
                            <span class="w-2 h-2 rounded-full animate-pulse" :class="status.chat_server_connected ? 'bg-green-500' : 'bg-red-500'"></span>
                            <span class="text-xs" :class="status.chat_server_connected ? 'text-green-400' : 'text-red-400'" 
                                  x-text="status.chat_server_connected ? 'Online' : 'Offline'"></span>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-2">
                    <div class="bg-gray-800/30 rounded-xl p-3 text-center">
                        <div class="text-2xl font-bold text-blue-400" x-text="instances.length"></div>
                        <div class="text-xs text-gray-500 uppercase tracking-wide" x-text="t('servers')"></div>
                    </div>
                    <div class="bg-gray-800/30 rounded-xl p-3 text-center cursor-pointer hover:bg-gray-700/30 transition-all" @click="showPlayerListModal = true">
                        <div class="text-2xl font-bold text-green-400" x-text="totalPlayers"></div>
                        <div class="text-xs text-gray-500 uppercase tracking-wide" x-text="t('players')"></div>
                    </div>
                </div>
                
                <button @click="openHealthCheck()" 
                        class="w-full text-sm bg-gradient-to-r from-red-600/20 to-pink-600/20 hover:from-red-600/30 hover:to-pink-600/30 border border-red-500/30 px-3 py-2.5 rounded-xl transition-all flex items-center justify-center space-x-2 group">
                    <i class="fas fa-heartbeat text-red-400 group-hover:animate-pulse"></i>
                    <span class="text-red-400 font-medium" x-text="t('healthCheck')"></span>
                </button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1 p-3 md:p-6 w-full md:w-auto max-w-[2000px]">
            <!-- Tab: Console -->
            <div x-show="activeTab === 'console'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
                <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-3 md:p-4 border border-gray-700/50 shadow-xl">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-4 space-y-2 sm:space-y-0">
                        <h2 class="text-lg font-semibold flex items-center">
                            <div class="w-8 h-8 bg-green-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-terminal text-green-400"></i>
                            </div>
                            Console
                        </h2>
                        <div class="flex items-center space-x-2">
                            <button @click="refreshLogs()" class="bg-gray-700/50 hover:bg-gray-600/50 px-3 py-1.5 rounded-lg text-sm transition-all border border-gray-600/50">
                                <i class="fas fa-sync-alt" :class="logsLoading && 'animate-spin'"></i>
                            </button>
                            <button @click="clearConsole()" class="bg-gray-700/50 hover:bg-gray-600/50 px-3 py-1.5 rounded-lg text-sm transition-all border border-gray-600/50">
                                <i class="fas fa-trash"></i>
                            </button>
                            <label class="hidden sm:flex items-center space-x-2 text-sm text-gray-400 bg-gray-700/30 px-3 py-1.5 rounded-lg">
                                <input type="checkbox" x-model="autoScrollLogs" class="rounded bg-gray-600 border-gray-500">
                                <span>Auto-scroll</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Log Output -->
                    <div x-ref="logContainer" 
                         class="bg-gray-950 rounded-xl border border-gray-700/50 p-3 md:p-4 h-[calc(100vh-350px)] md:h-[calc(100vh-320px)] overflow-y-auto font-mono text-xs leading-relaxed">
                        <template x-for="(log, index) in consoleLogs" :key="index">
                            <div class="hover:bg-gray-900/50 py-0.5 px-2 rounded break-all transition-colors"
                                 :class="{
                                     'text-red-400': log.includes('ERROR'),
                                     'text-yellow-400': log.includes('WARNING'),
                                     'text-green-400': log.includes('INFO') && !log.includes('ERROR'),
                                     'text-blue-400': log.includes('DEBUG'),
                                     'text-cyan-400': log.startsWith('>'),
                                     'text-gray-300': !log.includes('ERROR') && !log.includes('WARNING') && !log.includes('INFO') && !log.includes('DEBUG') && !log.startsWith('>')
                                 }"
                                 x-text="log"></div>
                        </template>
                        <div x-show="consoleLogs.length === 0" class="text-gray-500 text-center py-4" x-text="t('noLogsConsole')"></div>
                    </div>
                    
                    <!-- Command Input -->
                    <div class="flex border-x border-b border-gray-600 rounded-b overflow-hidden">
                        <span class="bg-gray-700 px-2 md:px-3 py-2 text-green-400 font-mono">$</span>
                        <input type="text" x-model="commandInput" 
                               :placeholder="t('typeCommand')"
                               class="flex-1 bg-gray-900 px-2 md:px-3 py-2 font-mono text-sm focus:outline-none"
                               @keyup.enter="executeCommand()"
                               @keyup.up="prevCommand()"
                               @keyup.down="nextCommand()">
                        <button @click="executeCommand()" 
                                class="bg-green-600 hover:bg-green-700 px-4 py-2 transition-colors">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                    
                    <!-- Quick Commands -->
                    <div class="flex flex-wrap gap-2 mt-3">
                        <button @click="quickCommand('status')" class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-xs transition-colors">
                            <i class="fas fa-info-circle mr-1"></i>status
                        </button>
                        <button @click="quickCommand('help')" class="bg-gray-700/50 hover:bg-gray-600/50 px-3 py-1.5 rounded-lg text-xs transition-all border border-gray-600/50">
                            <i class="fas fa-question-circle mr-1"></i>help
                        </button>
                        <button @click="quickCommand('shutdown all')" class="bg-red-600/20 hover:bg-red-600/40 px-3 py-1.5 rounded-lg text-xs transition-all text-red-400 border border-red-500/30">
                            <i class="fas fa-stop mr-1"></i>shutdown all
                        </button>
                        <button @click="quickCommand('startup all')" class="bg-green-600/20 hover:bg-green-600/40 px-3 py-1.5 rounded-lg text-xs transition-all text-green-400 border border-green-500/30">
                            <i class="fas fa-play mr-1"></i>startup all
                        </button>
                        <button @click="quickCommand('restart all')" class="bg-yellow-600/20 hover:bg-yellow-600/40 px-3 py-1.5 rounded-lg text-xs transition-all text-yellow-400 border border-yellow-500/30">
                            <i class="fas fa-redo mr-1"></i>restart all
                        </button>
                        <button @click="quickCommand('add')" class="bg-blue-600/20 hover:bg-blue-600/40 px-3 py-1.5 rounded-lg text-xs transition-all text-blue-400 border border-blue-500/30">
                            <i class="fas fa-plus mr-1"></i>add server
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab: Servers -->
        <div x-show="activeTab === 'servers'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 shadow-xl">
                <h2 class="text-lg font-semibold mb-5 flex items-center">
                    <div class="w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-server text-blue-400"></i>
                    </div>
                    <span x-text="t('serverManager')"></span>
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-5">
                    <!-- Current Servers -->
                    <div class="bg-gradient-to-br from-blue-600/10 to-blue-700/5 rounded-xl p-4 text-center border border-blue-500/20">
                        <div class="text-4xl font-bold text-blue-400" x-text="instances.length"></div>
                        <div class="text-sm text-gray-400 mt-1" x-text="t('runningServers')"></div>
                    </div>
                    
                    <!-- Target Servers -->
                    <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                        <label class="text-sm text-gray-400 block mb-3 font-medium text-center" x-text="t('targetServers')"></label>
                        <div class="flex items-center justify-center">
                            <button @click="decreaseTargetServers()" 
                                    class="bg-red-600/20 hover:bg-red-600/40 border border-red-500/30 px-4 py-2.5 rounded-l-lg transition-all text-red-400">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" x-model.number="targetServers" min="0" max="20"
                                   class="w-16 text-center bg-gray-700/50 border-y border-gray-600/50 py-2.5 focus:outline-none font-bold text-lg [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none">
                            <button @click="increaseTargetServers()" 
                                    class="bg-green-600/20 hover:bg-green-600/40 border border-green-500/30 px-4 py-2.5 rounded-r-lg transition-all text-green-400">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Apply Button -->
                    <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 flex items-center justify-center border border-gray-600/30">
                        <button @click="applyTargetServers()" 
                                class="bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 px-6 py-2.5 rounded-xl transition-all w-full shadow-lg shadow-blue-600/30 font-medium">
                            <i class="fas fa-sync-alt mr-2"></i><span x-text="t('applyChanges')"></span>
                        </button>
                    </div>
                    
                    <!-- Quick Scale -->
                    <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                        <label class="text-sm text-gray-400 block mb-3 font-medium" x-text="t('quickScale')"></label>
                        <div class="flex gap-2">
                            <button @click="setTargetServers(1)" class="flex-1 bg-gray-800/50 hover:bg-blue-600/20 hover:border-blue-500/30 border border-gray-600/50 px-3 py-2 rounded-lg text-sm font-medium transition-all">1</button>
                            <button @click="setTargetServers(2)" class="flex-1 bg-gray-800/50 hover:bg-blue-600/20 hover:border-blue-500/30 border border-gray-600/50 px-3 py-2 rounded-lg text-sm font-medium transition-all">2</button>
                            <button @click="setTargetServers(4)" class="flex-1 bg-gray-800/50 hover:bg-blue-600/20 hover:border-blue-500/30 border border-gray-600/50 px-3 py-2 rounded-lg text-sm font-medium transition-all">4</button>
                            <button @click="setTargetServers(8)" class="flex-1 bg-gray-800/50 hover:bg-blue-600/20 hover:border-blue-500/30 border border-gray-600/50 px-3 py-2 rounded-lg text-sm font-medium transition-all">8</button>
                            <button @click="setTargetServers(0)" class="flex-1 bg-gray-800/50 hover:bg-red-600/20 hover:border-red-500/30 border border-gray-600/50 px-3 py-2 rounded-lg text-sm font-medium transition-all text-red-400">0</button>
                        </div>
                    </div>
                </div>

                <!-- Quick Settings Panel -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-5 pt-5 border-t border-gray-700/50">
                    <!-- Proxy Toggle -->
                    <div class="bg-gradient-to-br from-purple-600/10 to-purple-700/5 rounded-xl p-4 border border-purple-500/20">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-shield-alt text-purple-400"></i>
                                </div>
                                <div>
                                    <div class="font-medium text-white">Proxy Mode</div>
                                    <div class="text-xs text-gray-500">Port + 10000</div>
                                </div>
                            </div>
                            <button @click="toggleQuickSetting('man_enableProxy')"
                                    class="w-14 h-7 rounded-full relative transition-all duration-300 shadow-lg"
                                    :class="config.man_enableProxy?.value ? 'bg-purple-500 shadow-purple-500/30' : 'bg-gray-600'">
                                <span class="absolute top-1 transition-all duration-300 w-5 h-5 bg-white rounded-full shadow"
                                      :class="config.man_enableProxy?.value ? 'left-8' : 'left-1'"></span>
                            </button>
                        </div>
                    </div>

                    <!-- Starting Port -->
                    <div class="bg-gradient-to-br from-blue-600/10 to-blue-700/5 rounded-xl p-4 border border-blue-500/20">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-plug text-blue-400"></i>
                                </div>
                                <div>
                                    <div class="font-medium text-white">Base Port</div>
                                    <div class="text-xs text-gray-500">Starting game port</div>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <button @click="config.svr_starting_gamePort && config.svr_starting_gamePort.value > 1000 && config.svr_starting_gamePort.value--" 
                                        class="bg-gray-700 hover:bg-gray-600 w-8 h-8 rounded-l-lg transition-all text-gray-400 hover:text-white">
                                    <i class="fas fa-minus text-xs"></i>
                                </button>
                                <input type="number" x-model.number="config.svr_starting_gamePort.value" 
                                       class="w-20 text-center bg-gray-800 border-y border-gray-600 py-1.5 focus:outline-none font-mono text-sm"
                                       x-show="config.svr_starting_gamePort">
                                <button @click="config.svr_starting_gamePort && config.svr_starting_gamePort.value++" 
                                        class="bg-gray-700 hover:bg-gray-600 w-8 h-8 rounded-r-lg transition-all text-gray-400 hover:text-white">
                                    <i class="fas fa-plus text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Max Clients -->
                    <div class="bg-gradient-to-br from-green-600/10 to-green-700/5 rounded-xl p-4 border border-green-500/20">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-users text-green-400"></i>
                                </div>
                                <div>
                                    <div class="font-medium text-white">Max Players</div>
                                    <div class="text-xs text-gray-500">Per server</div>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <button @click="config.svr_maxClients && config.svr_maxClients.value > 1 && config.svr_maxClients.value--" 
                                        class="bg-gray-700 hover:bg-gray-600 w-8 h-8 rounded-l-lg transition-all text-gray-400 hover:text-white">
                                    <i class="fas fa-minus text-xs"></i>
                                </button>
                                <input type="number" x-model.number="config.svr_maxClients.value" 
                                       class="w-16 text-center bg-gray-800 border-y border-gray-600 py-1.5 focus:outline-none font-mono text-sm"
                                       x-show="config.svr_maxClients">
                                <button @click="config.svr_maxClients && config.svr_maxClients.value++" 
                                        class="bg-gray-700 hover:bg-gray-600 w-8 h-8 rounded-r-lg transition-all text-gray-400 hover:text-white">
                                    <i class="fas fa-plus text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Server Actions -->
                <div class="flex flex-wrap gap-3 pt-5 border-t border-gray-700/50">
                    <button @click="startupAll()" 
                            class="bg-gradient-to-r from-green-600/20 to-green-500/10 hover:from-green-600/30 hover:to-green-500/20 border border-green-500/30 px-5 py-2.5 rounded-xl transition-all text-green-400 font-medium">
                        <i class="fas fa-play mr-2"></i><span x-text="t('startAll')"></span>
                    </button>
                    <button @click="shutdownAll()" 
                            class="bg-gradient-to-r from-red-600/20 to-red-500/10 hover:from-red-600/30 hover:to-red-500/20 border border-red-500/30 px-5 py-2.5 rounded-xl transition-all text-red-400 font-medium">
                        <i class="fas fa-stop mr-2"></i><span x-text="t('shutdownAll')"></span>
                    </button>
                    <button @click="restartAll()" 
                            class="bg-gradient-to-r from-yellow-600/20 to-yellow-500/10 hover:from-yellow-600/30 hover:to-yellow-500/20 border border-yellow-500/30 px-5 py-2.5 rounded-xl transition-all text-yellow-400 font-medium">
                        <i class="fas fa-redo mr-2"></i><span x-text="t('restartAll')"></span>
                    </button>
                    <button @click="showAddServerModal = true; addServerCount = 1" 
                            class="bg-gradient-to-r from-blue-600/20 to-blue-500/10 hover:from-blue-600/30 hover:to-blue-500/20 border border-blue-500/30 px-5 py-2.5 rounded-xl transition-all text-blue-400 font-medium">
                        <i class="fas fa-plus mr-2"></i><span x-text="t('addServer')"></span>
                    </button>
                    <button @click="showDeleteServerModal = true; deleteServerCount = 1; deleteMode = 'count'" 
                            class="bg-gradient-to-r from-gray-600/20 to-gray-500/10 hover:from-red-600/20 hover:to-red-500/10 border border-gray-600/30 hover:border-red-500/30 px-5 py-2.5 rounded-xl transition-all text-gray-400 hover:text-red-400 font-medium">
                        <i class="fas fa-trash mr-2"></i><span x-text="t('deleteAll')"></span>
                    </button>
                    <button @click="messageAll()" 
                            class="bg-gradient-to-r from-purple-600/20 to-purple-500/10 hover:from-purple-600/30 hover:to-purple-500/20 border border-purple-500/30 px-5 py-2.5 rounded-xl transition-all text-purple-400 font-medium">
                        <i class="fas fa-bullhorn mr-2"></i><span x-text="t('broadcastMessage')"></span>
                    </button>
                </div>
            </div>
            
            <!-- Game Instances Section (moved from Instances tab) -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 shadow-xl mt-4">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-5">
                    <h2 class="text-lg font-semibold flex items-center">
                        <div class="w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-gamepad text-purple-400"></i>
                        </div>
                        <span x-text="t('gameInstances')"></span>
                        <span class="text-sm font-normal text-gray-500 ml-2 bg-gray-700/30 px-2 py-0.5 rounded-lg" x-text="filteredInstances().length + '/' + instances.length" x-show="instances.length > 0"></span>
                    </h2>
                    
                    <!-- Controls -->
                    <div class="flex flex-wrap items-center gap-2">
                        <!-- Search -->
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm"></i>
                            <input type="text" x-model="instanceSearch" :placeholder="t('search')" 
                                   class="bg-gray-700/50 border border-gray-600/50 rounded-lg pl-9 pr-8 py-2 text-sm focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 w-44 transition-all">
                            <button x-show="instanceSearch" @click="instanceSearch = ''" 
                                    class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-white transition-colors">
                                <i class="fas fa-times text-xs"></i>
                            </button>
                        </div>
                        
                        <!-- Status Filter -->
                        <select x-model="instanceFilter" 
                                class="bg-gray-700 border border-gray-600 rounded px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500">
                            <option value="all" x-text="t('allStatus')"></option>
                            <option value="READY" x-text="t('ready')"></option>
                            <option value="OCCUPIED" x-text="t('occupied')"></option>
                            <option value="IDLE" x-text="t('idle')"></option>
                            <option value="STARTING" x-text="t('starting')"></option>
                            <option value="CRASHED" x-text="t('crashed')"></option>
                        </select>
                        
                        <!-- Sort -->
                        <div class="flex items-center">
                            <select x-model="instanceSort" 
                                    class="bg-gray-700 border border-gray-600 rounded-l px-3 py-1.5 text-sm focus:outline-none focus:border-blue-500">
                                <option value="id" x-text="t('sortById')"></option>
                                <option value="port" x-text="t('sortByPort')"></option>
                                <option value="status" x-text="t('sortByStatus')"></option>
                                <option value="players" x-text="t('sortByPlayers')"></option>
                                <option value="uptime" x-text="t('sortByUptime')"></option>
                            </select>
                            <button @click="instanceSortAsc = !instanceSortAsc" 
                                    class="bg-gray-700 border border-gray-600 border-l-0 rounded-r-lg px-3 py-1.5 hover:bg-gray-600 transition-all">
                                <i class="fas" :class="instanceSortAsc ? 'fa-sort-amount-up' : 'fa-sort-amount-down'"></i>
                            </button>
                        </div>
                        
                        <!-- View Mode Toggle -->
                        <div class="flex bg-gray-800/50 rounded-lg border border-gray-700/50 p-1">
                            <button @click="instanceViewMode = 'grid'" 
                                    class="px-3 py-1.5 rounded-md transition-all"
                                    :class="instanceViewMode === 'grid' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-400 hover:text-white hover:bg-gray-700/50'">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button @click="instanceViewMode = 'list'" 
                                    class="px-3 py-1.5 rounded-md transition-all"
                                    :class="instanceViewMode === 'list' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-400 hover:text-white hover:bg-gray-700/50'">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Empty States -->
                <div x-show="instances.length === 0" class="text-center py-16 animate-fadeIn">
                    <div class="w-24 h-24 bg-gradient-to-br from-gray-800 to-gray-700/50 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl">
                        <i class="fas fa-server text-4xl text-gray-500"></i>
                    </div>
                    <p class="text-gray-300 text-lg font-medium" x-text="t('noInstances')"></p>
                    <p class="text-gray-500 text-sm mt-2 mb-6">Add servers to get started</p>
                    <button @click="showAddServerModal = true; addServerCount = 1" 
                            class="bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 px-6 py-3 rounded-xl transition-all shadow-lg shadow-blue-600/30 font-medium">
                        <i class="fas fa-plus mr-2"></i>Add Server
                    </button>
                </div>
                
                <div x-show="filteredInstances().length === 0 && instances.length > 0" class="text-center py-16 animate-fadeIn">
                    <div class="w-24 h-24 bg-gradient-to-br from-gray-800 to-gray-700/50 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl">
                        <i class="fas fa-filter text-4xl text-gray-500"></i>
                    </div>
                    <p class="text-gray-300 text-lg font-medium" x-text="t('noMatchFilter')"></p>
                    <p class="text-gray-500 text-sm mt-2 mb-6">Try adjusting your filters</p>
                    <button @click="instanceSearch = ''; instanceFilter = 'all'" 
                            class="bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 px-6 py-3 rounded-xl transition-all shadow-lg shadow-blue-600/30 font-medium">
                        <i class="fas fa-times mr-2"></i><span x-text="t('clearFilters')"></span>
                    </button>
                </div>
                
                <!-- Grid View -->
                <div x-show="instanceViewMode === 'grid' && filteredInstances().length > 0" 
                     class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-4">
                    <template x-for="(instance, idx) in filteredInstances()" :key="instance.id">
                        <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 card-hover cursor-pointer relative overflow-hidden group"
                             @click="showInstanceDetails(instance)"
                             :style="'animation-delay: ' + (idx * 50) + 'ms'"
                             x-init="$el.classList.add('animate-fadeIn')">
                            <!-- Gradient overlay based on status -->
                            <div class="absolute inset-0 opacity-10 transition-opacity group-hover:opacity-20"
                                 :class="{
                                     'bg-gradient-to-br from-green-500 to-transparent': instance.status === 'READY',
                                     'bg-gradient-to-br from-yellow-500 to-transparent': instance.status === 'OCCUPIED',
                                     'bg-gradient-to-br from-red-500 to-transparent': instance.status === 'CRASHED',
                                     'bg-gradient-to-br from-blue-500 to-transparent': instance.status === 'STARTING'
                                 }"></div>
                            
                            <!-- Header -->
                            <div class="flex items-center justify-between mb-3 relative">
                                <div class="flex items-center space-x-2">
                                    <span class="w-3 h-3 rounded-full animate-pulse" 
                                          :class="getStatusColor(instance.status)"></span>
                                    <span class="font-semibold text-white" x-text="'Server #' + instance.id"></span>
                                </div>
                                <span class="text-xs px-2.5 py-1 rounded-full font-medium" 
                                      :class="getStatusBadgeClass(instance.status)"
                                      x-text="instance.status"></span>
                            </div>
                            
                            <!-- Info -->
                            <div class="space-y-2 text-sm relative">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-500" x-text="t('port') + ':'"></span>
                                    <div class="flex items-center space-x-2">
                                        <span class="font-mono text-gray-300" x-text="instance.port"></span>
                                        <template x-if="instance.proxy_enabled && instance.public_port != instance.port">
                                            <span class="text-xs px-1.5 py-0.5 bg-purple-500/20 text-purple-400 rounded font-mono flex items-center">
                                                <i class="fas fa-arrow-right text-[8px] mr-1"></i>
                                                <span x-text="instance.public_port"></span>
                                            </span>
                                        </template>
                                    </div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-500" x-text="t('players') + ':'"></span>
                                    <div class="flex items-center space-x-2">
                                        <div class="w-16 h-1.5 bg-gray-700 rounded-full overflow-hidden">
                                            <div class="h-full bg-gradient-to-r from-green-500 to-green-400 progress-bar rounded-full"
                                                 :style="'width: ' + (instance.num_clients / instance.max_clients * 100) + '%'"></div>
                                        </div>
                                        <span class="text-gray-300" x-text="instance.num_clients + '/' + instance.max_clients"></span>
                                    </div>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-500" x-text="t('phase') + ':'"></span>
                                    <span class="text-gray-300 truncate max-w-[100px]" x-text="instance.game_phase || '-'"></span>
                                </div>
                                <div class="flex justify-between" x-show="instance.match_id">
                                    <span class="text-gray-500" x-text="t('match') + ':'"></span>
                                    <span class="text-blue-400 font-mono text-xs" x-text="instance.match_id"></span>
                                </div>
                                <div class="flex justify-between" x-show="instance.uptime">
                                    <span class="text-gray-500" x-text="t('uptime') + ':'"></span>
                                    <span class="text-gray-300" x-text="formatUptime(instance.uptime)"></span>
                                </div>
                            </div>
                            
                            <!-- Players List by Team -->
                            <div class="mt-3 pt-3 border-t border-gray-700/50 relative" x-show="(instance.players_by_team && (instance.players_by_team.legion.length > 0 || instance.players_by_team.hellbourne.length > 0)) || (instance.players && instance.players.length > 0)">
                                <div class="text-xs text-gray-500 mb-2 flex items-center">
                                    <i class="fas fa-users mr-1.5"></i><span x-text="t('playersInMatch') + ':'"></span>
                                </div>
                                
                                <!-- Team Display (when team data available) -->
                                <template x-if="instance.players_by_team && (instance.players_by_team.legion.length > 0 || instance.players_by_team.hellbourne.length > 0)">
                                    <div class="space-y-2">
                                        <!-- Legion Team -->
                                        <div x-show="instance.players_by_team.legion.length > 0">
                                            <div class="text-xs text-green-400 mb-1 flex items-center font-medium">
                                                <i class="fas fa-shield-alt mr-1"></i>
                                                <span x-text="t('legion')"></span>
                                                <span class="text-gray-600 ml-1 font-normal" x-text="'(' + instance.players_by_team.legion.length + ')'"></span>
                                            </div>
                                            <div class="flex flex-wrap gap-1">
                                                <template x-for="player in instance.players_by_team.legion" :key="player.name">
                                                    <span class="bg-green-500/10 border border-green-500/30 px-2 py-0.5 rounded-md text-xs text-green-400 hover:bg-green-500/20 transition-colors" 
                                                          x-text="player.name" 
                                                          :title="player.psr ? ('PSR: ' + player.psr) : ''"></span>
                                                </template>
                                            </div>
                                        </div>
                                        
                                        <!-- Hellbourne Team -->
                                        <div x-show="instance.players_by_team.hellbourne.length > 0">
                                            <div class="text-xs text-red-400 mb-1 flex items-center font-medium">
                                                <i class="fas fa-skull mr-1"></i>
                                                <span x-text="t('hellbourne')"></span>
                                                <span class="text-gray-600 ml-1 font-normal" x-text="'(' + instance.players_by_team.hellbourne.length + ')'"></span>
                                            </div>
                                            <div class="flex flex-wrap gap-1">
                                                <template x-for="player in instance.players_by_team.hellbourne" :key="player.name">
                                                    <span class="bg-red-500/10 border border-red-500/30 px-2 py-0.5 rounded-md text-xs text-red-400 hover:bg-red-500/20 transition-colors" 
                                                          x-text="player.name" 
                                                          :title="player.psr ? ('PSR: ' + player.psr) : ''"></span>
                                                </template>
                                            </div>
                                        </div>
                                        
                                        <!-- Spectators -->
                                        <div x-show="instance.players_by_team.spectators && instance.players_by_team.spectators.length > 0">
                                            <div class="text-xs text-gray-400 mb-1 flex items-center font-medium">
                                                <i class="fas fa-eye mr-1"></i>
                                                <span x-text="t('spectators')"></span>
                                                <span class="text-gray-600 ml-1 font-normal" x-text="'(' + instance.players_by_team.spectators.length + ')'"></span>
                                            </div>
                                            <div class="flex flex-wrap gap-1">
                                                <template x-for="player in instance.players_by_team.spectators" :key="player.name">
                                                    <span class="bg-gray-500/10 border border-gray-500/30 px-2 py-0.5 rounded-md text-xs text-gray-400 hover:bg-gray-500/20 transition-colors" 
                                                          x-text="player.name"></span>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                                
                                <!-- Fallback: Simple player list when no team data -->
                                <template x-if="!(instance.players_by_team && (instance.players_by_team.legion.length > 0 || instance.players_by_team.hellbourne.length > 0)) && instance.players && instance.players.length > 0">
                                    <div class="flex flex-wrap gap-1">
                                        <template x-for="player in instance.players.slice(0, 10)" :key="player.name">
                                            <span class="bg-blue-500/10 border border-blue-500/30 px-2 py-0.5 rounded-md text-xs text-blue-400 hover:bg-blue-500/20 transition-colors" 
                                            <span @click.stop="showPlayerDetails(player)" class="bg-blue-500/10 border border-blue-500/30 px-2 py-0.5 rounded-md text-xs text-blue-400 hover:bg-blue-500/20 transition-colors cursor-pointer"
                                                  :title="player.location || ''"></span>
                                        </template>
                                        <span x-show="instance.players.length > 10" 
                                              class="bg-gray-500/10 border border-gray-500/30 px-2 py-0.5 rounded-md text-xs text-gray-400"
                                              x-text="'+' + (instance.players.length - 10) + ' more'"></span>
                                    </div>
                                </template>
                            </div>
                            
                            <!-- Actions -->
                            <div class="flex space-x-1.5 mt-4 pt-3 border-t border-gray-700/50 relative">
                                <button @click.stop="startServer(instance.id)" 
                                        class="flex-1 bg-green-500/20 hover:bg-green-500/30 text-green-400 px-2 py-1.5 rounded-lg text-xs transition-all border border-green-500/30 hover:border-green-500/50"
                                        :disabled="instance.status === 'READY' || instance.status === 'OCCUPIED'"
                                        title="Start">
                                    <i class="fas fa-play"></i>
                                </button>
                                <button @click.stop="stopServer(instance.id)" 
                                        class="flex-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 px-2 py-1.5 rounded-lg text-xs transition-all border border-red-500/30 hover:border-red-500/50"
                                        title="Stop">
                                    <i class="fas fa-stop"></i>
                                </button>
                                <button @click.stop="restartServer(instance.id)" 
                                        class="flex-1 bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-400 px-2 py-1.5 rounded-lg text-xs transition-all border border-yellow-500/30 hover:border-yellow-500/50"
                                        title="Restart">
                                    <i class="fas fa-redo"></i>
                                </button>
                                
                                <button @click.stop="deleteServer(instance.id)" 
                                        class="flex-1 bg-gray-500/20 hover:bg-red-500/30 text-gray-400 hover:text-red-400 px-2 py-1.5 rounded-lg text-xs transition-all border border-gray-500/30 hover:border-red-500/50"
                                        title="Delete Server">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </template>
                </div>
                
                <!-- List View -->
                <div x-show="instanceViewMode === 'list' && filteredInstances().length > 0" class="overflow-x-auto rounded-xl border border-gray-700/50">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-800/80 text-gray-400">
                            <tr>
                                <th class="px-4 py-3 text-left cursor-pointer hover:bg-gray-700/50 transition-colors" @click="toggleSort('id')">
                                    <i class="fas fa-hashtag mr-2 text-blue-400"></i><span x-text="t('id')"></span>
                                    <i class="fas fa-sort ml-1 text-gray-600" x-show="instanceSort !== 'id'"></i>
                                    <i class="fas text-blue-400" :class="instanceSortAsc ? 'fa-sort-up' : 'fa-sort-down'" x-show="instanceSort === 'id'"></i>
                                </th>
                                <th class="px-4 py-3 text-left cursor-pointer hover:bg-gray-700/50 transition-colors" @click="toggleSort('status')">
                                    <i class="fas fa-circle mr-2 text-blue-400"></i><span x-text="t('status')"></span>
                                    <i class="fas fa-sort ml-1 text-gray-600" x-show="instanceSort !== 'status'"></i>
                                    <i class="fas text-blue-400" :class="instanceSortAsc ? 'fa-sort-up' : 'fa-sort-down'" x-show="instanceSort === 'status'"></i>
                                </th>
                                <th class="px-4 py-3 text-left cursor-pointer hover:bg-gray-700/50 transition-colors" @click="toggleSort('port')">
                                    <i class="fas fa-plug mr-2 text-blue-400"></i><span x-text="t('port')"></span>
                                    <i class="fas fa-sort ml-1 text-gray-600" x-show="instanceSort !== 'port'"></i>
                                    <i class="fas text-blue-400" :class="instanceSortAsc ? 'fa-sort-up' : 'fa-sort-down'" x-show="instanceSort === 'port'"></i>
                                </th>
                                <th class="px-4 py-3 text-left cursor-pointer hover:bg-gray-700/50 transition-colors" @click="toggleSort('players')">
                                    <i class="fas fa-users mr-2 text-blue-400"></i><span x-text="t('players')"></span>
                                    <i class="fas fa-sort ml-1 text-gray-500" x-show="instanceSort !== 'players'"></i>
                                    <i class="fas" :class="instanceSortAsc ? 'fa-sort-up' : 'fa-sort-down'" x-show="instanceSort === 'players'"></i>
                                </th>
                                <th class="px-4 py-3 text-left">
                                    <i class="fas fa-gamepad mr-2"></i><span x-text="t('phase')"></span>
                                </th>
                                <th class="px-4 py-3 text-left cursor-pointer hover:bg-gray-600" @click="toggleSort('uptime')">
                                    <i class="fas fa-clock mr-2"></i><span x-text="t('uptime')"></span>
                                    <i class="fas fa-sort ml-1 text-gray-500" x-show="instanceSort !== 'uptime'"></i>
                                    <i class="fas" :class="instanceSortAsc ? 'fa-sort-up' : 'fa-sort-down'" x-show="instanceSort === 'uptime'"></i>
                                </th>
                                <th class="px-4 py-3 text-center">
                                    <i class="fas fa-cogs mr-2"></i><span x-text="t('actions')"></span>
                                </th>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-700">
                            <template x-for="instance in filteredInstances()" :key="instance.id">
                                <tr class="hover:bg-gray-700/50 cursor-pointer transition-colors" @click="showInstanceDetails(instance)">
                                    <td class="px-4 py-3 font-semibold" x-text="'#' + instance.id"></td>
                                    <td class="px-4 py-3">
                                        <span class="inline-flex items-center space-x-2">
                                            <span class="w-2 h-2 rounded-full" :class="getStatusColor(instance.status)"></span>
                                            <span class="text-xs px-2 py-0.5 rounded" :class="getStatusBadgeClass(instance.status)" x-text="instance.status"></span>
                                        </span>
                                    </td>
                                    <td class="px-4 py-3">
                                        <span x-text="instance.port"></span>
                                        <template x-if="instance.proxy_enabled && instance.public_port != instance.port">
                                            <span class="ml-1 text-xs text-purple-400">
                                                โ’ <span x-text="instance.public_port"></span>
                                            </span>
                                        </template>
                                    </td>
                                    <td class="px-4 py-3">
                                        <span :class="instance.num_clients > 0 ? 'text-green-400' : 'text-gray-400'" x-text="instance.num_clients + '/' + instance.max_clients"></span>
                                    </td>
                                    <td class="px-4 py-3 text-gray-400" x-text="instance.game_phase || '-'"></td>
                                    <td class="px-4 py-3 text-gray-400" x-text="formatUptime(instance.uptime) || '-'"></td>
                                    <td class="px-4 py-3" @click.stop>
                                        <div class="flex justify-center space-x-1">
                                            <button @click="startServer(instance.id)" class="bg-green-600 hover:bg-green-700 px-2 py-1 rounded text-xs transition-colors" title="Start">
                                                <i class="fas fa-play"></i>
                                            </button>
                                            <button @click="stopServer(instance.id)" class="bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs transition-colors" title="Stop">
                                                <i class="fas fa-stop"></i>
                                            </button>
                                            <button @click="restartServer(instance.id)" class="bg-yellow-600 hover:bg-yellow-700 px-2 py-1 rounded text-xs transition-colors" title="Restart">
                                                <i class="fas fa-redo"></i>
                                            </button>
                                            
                                            <button @click="deleteServer(instance.id)" class="bg-gray-600 hover:bg-red-700 px-2 py-1 rounded text-xs transition-colors" title="Delete">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab: Config -->
        <div x-show="activeTab === 'config'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 shadow-xl">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3">
                    <h2 class="text-lg font-semibold flex items-center">
                        <div class="w-8 h-8 bg-gray-500/20 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-cog text-gray-400"></i>
                        </div>
                        <span x-text="t('configuration')"></span>
                    </h2>
                    <div class="flex items-center space-x-2">
                        <!-- Config Search -->
                        <div class="relative">
                            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm"></i>
                            <input type="text" x-model="configSearch" placeholder="Search settings..." 
                                   class="bg-gray-700/50 border border-gray-600/50 rounded-lg pl-9 pr-8 py-2 text-sm focus:outline-none focus:border-blue-500 w-48 transition-all">
                            <button x-show="configSearch" @click="configSearch = ''" 
                                    class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-white">
                                <i class="fas fa-times text-xs"></i>
                            </button>
                        </div>
                        <!-- Config View Toggle -->
                        <div class="bg-gray-800/50 rounded-lg p-1 flex border border-gray-700/50">
                            <button @click="configViewMode = 'grouped'" 
                                    :class="configViewMode === 'grouped' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-400 hover:text-white'"
                                    class="px-3 py-1.5 rounded-md text-sm transition-all" title="Grouped View">
                                <i class="fas fa-layer-group"></i>
                            </button>
                            <button @click="configViewMode = 'list'" 
                                    :class="configViewMode === 'list' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-400 hover:text-white'"
                                    class="px-3 py-1.5 rounded-md text-sm transition-all" title="List View">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                        <button @click="saveConfig()" 
                                class="bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 px-5 py-2.5 rounded-xl text-sm transition-all shadow-lg shadow-green-600/30">
                            <i class="fas fa-save mr-2"></i><span x-text="t('saveConfig')"></span>
                        </button>
                    </div>
                </div>
                
                <!-- Config Quick Info -->
                <div class="mb-5 p-3 bg-blue-600/10 border border-blue-500/20 rounded-xl flex items-start space-x-3">
                    <i class="fas fa-info-circle text-blue-400 mt-0.5"></i>
                    <div class="text-sm">
                        <p class="text-blue-300">Settings with <i class="fas fa-lock text-gray-500 mx-1"></i> are read-only and cannot be changed from the dashboard.</p>
                        <p class="text-gray-400 mt-1">Changes will take effect after saving. Some settings may require server restart.</p>
                    </div>
                </div>

                <!-- Grouped View -->
                <div x-show="configViewMode === 'grouped'" class="space-y-6">
                    <!-- Server Settings Group -->
                    <div class="border border-gray-700/50 rounded-xl overflow-hidden" x-show="Object.keys(config).filter(k => k.startsWith('svr_') && filterConfig(k)).length > 0">
                        <div class="bg-gradient-to-r from-blue-600/20 to-transparent px-4 py-3 border-b border-gray-700/50 flex items-center">
                            <div class="w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-server text-blue-400"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-blue-400">Server Settings</h3>
                                <p class="text-xs text-gray-500">Game server configuration</p>
                            </div>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <template x-for="(item, key) in config" :key="key">
                                <div x-show="key.startsWith('svr_') && filterConfig(key)" class="config-item">
                                    <template x-if="typeof item === 'object'">
                                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 hover:border-blue-500/30 transition-all group">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm text-gray-300 font-medium flex items-center">
                                                    <span x-text="formatConfigKey(key)"></span>
                                                    <template x-if="getConfigTooltip(key)">
                                                        <span class="ml-2 text-gray-500 cursor-help" :title="getConfigTooltip(key)">
                                                            <i class="fas fa-question-circle text-xs"></i>
                                                        </span>
                                                    </template>
                                                </label>
                                                <template x-if="!item.editable">
                                                    <span class="text-xs text-gray-600"><i class="fas fa-lock"></i></span>
                                                </template>
                                            </div>
                                            <!-- Boolean Toggle -->
                                            <template x-if="item.editable && typeof item.value === 'boolean'">
                                                <button @click="config[key].value = !config[key].value"
                                                        class="w-full text-left px-4 py-2.5 rounded-lg transition-all font-medium flex items-center justify-between"
                                                        :class="item.value ? 'bg-green-600/20 border border-green-500/30 text-green-400' : 'bg-gray-600/50 border border-gray-600/50 text-gray-400'">
                                                    <span x-text="item.value ? t('enabled') : t('disabled')"></span>
                                                    <i class="fas text-xl" :class="item.value ? 'fa-toggle-on text-green-400' : 'fa-toggle-off text-gray-500'"></i>
                                                </button>
                                            </template>
                                            <!-- Number Input -->
                                            <template x-if="item.editable && typeof item.value === 'number'">
                                                <div class="relative">
                                                    <input type="number" x-model.number="config[key].value"
                                                           class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                                                    <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex flex-col">
                                                        <button @click="config[key].value++" class="text-gray-500 hover:text-white px-1 text-xs"><i class="fas fa-chevron-up"></i></button>
                                                        <button @click="config[key].value > 0 && config[key].value--" class="text-gray-500 hover:text-white px-1 text-xs"><i class="fas fa-chevron-down"></i></button>
                                                    </div>
                                                </div>
                                            </template>
                                            <!-- String Input -->
                                            <template x-if="item.editable && typeof item.value === 'string'">
                                                <input type="text" x-model="config[key].value"
                                                       class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                                            </template>
                                            <!-- Read-only -->
                                            <template x-if="!item.editable">
                                                <div class="px-4 py-2.5 bg-gray-800/50 rounded-lg text-gray-400 border border-gray-700/50 flex items-center justify-between">
                                                    <span x-text="item.value" class="truncate font-mono text-sm"></span>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Manager Settings Group -->
                    <div class="border border-gray-700/50 rounded-xl overflow-hidden" x-show="Object.keys(config).filter(k => k.startsWith('man_') && filterConfig(k)).length > 0">
                        <div class="bg-gradient-to-r from-purple-600/20 to-transparent px-4 py-3 border-b border-gray-700/50 flex items-center">
                            <div class="w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-sliders-h text-purple-400"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-purple-400">Manager Settings</h3>
                                <p class="text-xs text-gray-500">HoNfigurator manager options</p>
                            </div>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <template x-for="(item, key) in config" :key="key">
                                <div x-show="key.startsWith('man_') && filterConfig(key)" class="config-item">
                                    <template x-if="typeof item === 'object'">
                                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 hover:border-purple-500/30 transition-all group">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm text-gray-300 font-medium flex items-center">
                                                    <span x-text="formatConfigKey(key)"></span>
                                                    <template x-if="getConfigTooltip(key)">
                                                        <span class="ml-2 text-gray-500 cursor-help" :title="getConfigTooltip(key)">
                                                            <i class="fas fa-question-circle text-xs"></i>
                                                        </span>
                                                    </template>
                                                </label>
                                                <template x-if="!item.editable">
                                                    <span class="text-xs text-gray-600"><i class="fas fa-lock"></i></span>
                                                </template>
                                            </div>
                                            <!-- Boolean Toggle -->
                                            <template x-if="item.editable && typeof item.value === 'boolean'">
                                                <button @click="config[key].value = !config[key].value"
                                                        class="w-full text-left px-4 py-2.5 rounded-lg transition-all font-medium flex items-center justify-between"
                                                        :class="item.value ? 'bg-green-600/20 border border-green-500/30 text-green-400' : 'bg-gray-600/50 border border-gray-600/50 text-gray-400'">
                                                    <span x-text="item.value ? t('enabled') : t('disabled')"></span>
                                                    <i class="fas text-xl" :class="item.value ? 'fa-toggle-on text-green-400' : 'fa-toggle-off text-gray-500'"></i>
                                                </button>
                                            </template>
                                            <!-- Number Input -->
                                            <template x-if="item.editable && typeof item.value === 'number'">
                                                <div class="relative">
                                                    <input type="number" x-model.number="config[key].value"
                                                           class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                                                    <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex flex-col">
                                                        <button @click="config[key].value++" class="text-gray-500 hover:text-white px-1 text-xs"><i class="fas fa-chevron-up"></i></button>
                                                        <button @click="config[key].value > 0 && config[key].value--" class="text-gray-500 hover:text-white px-1 text-xs"><i class="fas fa-chevron-down"></i></button>
                                                    </div>
                                                </div>
                                            </template>
                                            <!-- String Input -->
                                            <template x-if="item.editable && typeof item.value === 'string'">
                                                <input type="text" x-model="config[key].value"
                                                       class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                                            </template>
                                            <!-- Read-only -->
                                            <template x-if="!item.editable">
                                                <div class="px-4 py-2.5 bg-gray-800/50 rounded-lg text-gray-400 border border-gray-700/50 flex items-center justify-between">
                                                    <span x-text="item.value" class="truncate font-mono text-sm"></span>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Other Settings Group -->
                    <div class="border border-gray-700/50 rounded-xl overflow-hidden" x-show="Object.keys(config).filter(k => !k.startsWith('svr_') && !k.startsWith('man_') && filterConfig(k)).length > 0">
                        <div class="bg-gradient-to-r from-gray-600/20 to-transparent px-4 py-3 border-b border-gray-700/50 flex items-center">
                            <div class="w-8 h-8 bg-gray-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-cogs text-gray-400"></i>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-300">Other Settings</h3>
                                <p class="text-xs text-gray-500">Additional configuration</p>
                            </div>
                        </div>
                        <div class="p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <template x-for="(item, key) in config" :key="key">
                                <div x-show="!key.startsWith('svr_') && !key.startsWith('man_') && filterConfig(key)" class="config-item">
                                    <template x-if="typeof item === 'object'">
                                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 hover:border-gray-500/50 transition-all group">
                                            <div class="flex items-center justify-between mb-2">
                                                <label class="text-sm text-gray-300 font-medium flex items-center">
                                                    <span x-text="formatConfigKey(key)"></span>
                                                    <template x-if="getConfigTooltip(key)">
                                                        <span class="ml-2 text-gray-500 cursor-help" :title="getConfigTooltip(key)">
                                                            <i class="fas fa-question-circle text-xs"></i>
                                                        </span>
                                                    </template>
                                                </label>
                                                <template x-if="!item.editable">
                                                    <span class="text-xs text-gray-600"><i class="fas fa-lock"></i></span>
                                                </template>
                                            </div>
                                            <!-- Boolean Toggle -->
                                            <template x-if="item.editable && typeof item.value === 'boolean'">
                                                <button @click="config[key].value = !config[key].value"
                                                        class="w-full text-left px-4 py-2.5 rounded-lg transition-all font-medium flex items-center justify-between"
                                                        :class="item.value ? 'bg-green-600/20 border border-green-500/30 text-green-400' : 'bg-gray-600/50 border border-gray-600/50 text-gray-400'">
                                                    <span x-text="item.value ? t('enabled') : t('disabled')"></span>
                                                    <i class="fas text-xl" :class="item.value ? 'fa-toggle-on text-green-400' : 'fa-toggle-off text-gray-500'"></i>
                                                </button>
                                            </template>
                                            <!-- Number Input -->
                                            <template x-if="item.editable && typeof item.value === 'number'">
                                                <div class="relative">
                                                    <input type="number" x-model.number="config[key].value"
                                                           class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                                                    <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex flex-col">
                                                        <button @click="config[key].value++" class="text-gray-500 hover:text-white px-1 text-xs"><i class="fas fa-chevron-up"></i></button>
                                                        <button @click="config[key].value > 0 && config[key].value--" class="text-gray-500 hover:text-white px-1 text-xs"><i class="fas fa-chevron-down"></i></button>
                                                    </div>
                                                </div>
                                            </template>
                                            <!-- String Input -->
                                            <template x-if="item.editable && typeof item.value === 'string'">
                                                <input type="text" x-model="config[key].value"
                                                       class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                                            </template>
                                            <!-- Read-only -->
                                            <template x-if="!item.editable">
                                                <div class="px-4 py-2.5 bg-gray-800/50 rounded-lg text-gray-400 border border-gray-700/50 flex items-center justify-between">
                                                    <span x-text="item.value" class="truncate font-mono text-sm"></span>
                                                </div>
                                            </template>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- List View (Original) -->
                <div x-show="configViewMode === 'list'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <template x-for="(item, key) in config" :key="key">
                        <div x-show="filterConfig(key)" class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 hover:border-gray-500/50 transition-all">
                            <label class="block text-sm text-gray-400 mb-2 font-medium" x-text="formatConfigKey(key)"></label>
                            <template x-if="typeof item === 'object' && item.editable">
                                <template x-if="typeof item.value === 'boolean'">
                                    <button @click="config[key].value = !config[key].value"
                                            class="w-full text-left px-4 py-2.5 rounded-lg transition-all font-medium"
                                            :class="item.value ? 'bg-green-600/20 border border-green-500/30 text-green-400' : 'bg-gray-600/50 border border-gray-600/50 text-gray-400'">
                                        <i class="fas" :class="item.value ? 'fa-toggle-on text-green-400' : 'fa-toggle-off text-gray-500'"></i>
                                        <span x-text="item.value ? t('enabled') : t('disabled')" class="ml-2"></span>
                                    </button>
                                </template>
                            </template>
                            <template x-if="typeof item === 'object' && item.editable && typeof item.value === 'number'">
                                <input type="number" x-model.number="config[key].value"
                                       class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                            </template>
                            <template x-if="typeof item === 'object' && item.editable && typeof item.value === 'string'">
                                <input type="text" x-model="config[key].value"
                                       class="w-full bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2.5 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all">
                            </template>
                            <template x-if="typeof item === 'object' && !item.editable">
                                <div class="px-4 py-2.5 bg-gray-800/50 rounded-lg text-gray-300 border border-gray-700/50 flex items-center justify-between">
                                    <span x-text="item.value" class="truncate"></span>
                                    <i class="fas fa-lock text-gray-600 text-xs ml-2"></i>
                                </div>
                            </template>
                        </div>
                    </template>
                </div>

                <!-- No Results -->
                <div x-show="configSearch && Object.keys(config).filter(k => filterConfig(k)).length === 0" class="text-center py-12">
                    <div class="w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-search text-2xl text-gray-600"></i>
                    </div>
                    <p class="text-gray-400">No settings found matching "<span x-text="configSearch" class="text-white"></span>"</p>
                    <button @click="configSearch = ''" class="mt-3 text-blue-400 hover:text-blue-300 text-sm">Clear search</button>
                </div>
            </div>
        </div>

        <!-- Tab: System Status -->
        <div x-show="activeTab === 'system'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 shadow-xl">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3">
                    <h2 class="text-lg font-semibold flex items-center">
                        <div class="w-8 h-8 bg-cyan-500/20 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-microchip text-cyan-400"></i>
                        </div>
                        <span x-text="t('systemStatus')"></span>
                    </h2>
                    <div class="flex items-center space-x-2">
                        <!-- Toggle buttons -->
                        <div class="bg-gray-800/50 rounded-lg p-1 flex border border-gray-700/50">
                            <button @click="systemView = 'info'" 
                                    :class="systemView === 'info' ? 'bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-lg' : 'text-gray-400 hover:text-white hover:bg-gray-700/50'"
                                    class="px-4 py-1.5 rounded-md text-sm font-medium transition-all">
                                <i class="fas fa-info-circle mr-1.5"></i><span x-text="t('info')"></span>
                            </button>
                            <button @click="systemView = 'graphs'; initCharts()" 
                                    :class="systemView === 'graphs' ? 'bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-lg' : 'text-gray-400 hover:text-white hover:bg-gray-700/50'"
                                    class="px-4 py-1.5 rounded-md text-sm font-medium transition-all">
                                <i class="fas fa-chart-line mr-1.5"></i><span x-text="t('graphs')"></span>
                            </button>
                        </div>
                        <button @click="refreshSystemStatus()" 
                                class="bg-gray-700/50 hover:bg-gray-600/50 px-3 py-1.5 rounded-lg text-sm transition-all border border-gray-600/50">
                            <i class="fas fa-sync-alt" :class="systemLoading && 'animate-spin'"></i>
                        </button>
                    </div>
                </div>
                
                <!-- System Info View -->
                <div x-show="systemView === 'info'" class="animate-fadeIn">
                
                <!-- System Info Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <!-- CPU -->
                    <div class="relative bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 overflow-hidden group hover:border-gray-500/50 transition-all">
                        <div class="absolute inset-0 bg-gradient-to-r opacity-10 group-hover:opacity-20 transition-opacity"
                             :class="systemStatus.cpu_percent > 80 ? 'from-red-500 to-red-600' : systemStatus.cpu_percent > 50 ? 'from-yellow-500 to-yellow-600' : 'from-green-500 to-green-600'"></div>
                        <div class="relative">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-gray-400 text-sm flex items-center">
                                    <div class="w-7 h-7 bg-gray-600/50 rounded-lg flex items-center justify-center mr-2">
                                        <i class="fas fa-microchip text-cyan-400 text-xs"></i>
                                    </div>
                                    CPU
                                </span>
                                <span class="text-2xl font-bold" :class="systemStatus.cpu_percent > 80 ? 'text-red-400' : systemStatus.cpu_percent > 50 ? 'text-yellow-400' : 'text-green-400'" 
                                      x-text="systemStatus.cpu_percent + '%'"></span>
                            </div>
                            <div class="w-full bg-gray-900/50 rounded-full h-2.5 overflow-hidden">
                                <div class="h-2.5 rounded-full transition-all duration-500 progress-animated"
                                     :class="systemStatus.cpu_percent > 80 ? 'bg-gradient-to-r from-red-500 to-red-400' : systemStatus.cpu_percent > 50 ? 'bg-gradient-to-r from-yellow-500 to-yellow-400' : 'bg-gradient-to-r from-green-500 to-green-400'"
                                     :style="'width: ' + systemStatus.cpu_percent + '%'"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                <span x-text="systemStatus.cpu_count + ' cores'"></span>
                                <span x-show="systemStatus.cpu_freq"> @ <span x-text="systemStatus.cpu_freq"></span> MHz</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Memory -->
                    <div class="relative bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 overflow-hidden group hover:border-gray-500/50 transition-all">
                        <div class="absolute inset-0 bg-gradient-to-r opacity-10 group-hover:opacity-20 transition-opacity"
                             :class="systemStatus.memory_percent > 80 ? 'from-red-500 to-red-600' : systemStatus.memory_percent > 50 ? 'from-yellow-500 to-yellow-600' : 'from-green-500 to-green-600'"></div>
                        <div class="relative">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-gray-400 text-sm flex items-center">
                                    <div class="w-7 h-7 bg-gray-600/50 rounded-lg flex items-center justify-center mr-2">
                                        <i class="fas fa-memory text-purple-400 text-xs"></i>
                                    </div>
                                    Memory
                                </span>
                                <span class="text-2xl font-bold" :class="systemStatus.memory_percent > 80 ? 'text-red-400' : systemStatus.memory_percent > 50 ? 'text-yellow-400' : 'text-green-400'" 
                                      x-text="systemStatus.memory_percent + '%'"></span>
                            </div>
                            <div class="w-full bg-gray-900/50 rounded-full h-2.5 overflow-hidden">
                                <div class="h-2.5 rounded-full transition-all duration-500 progress-animated"
                                     :class="systemStatus.memory_percent > 80 ? 'bg-gradient-to-r from-red-500 to-red-400' : systemStatus.memory_percent > 50 ? 'bg-gradient-to-r from-yellow-500 to-yellow-400' : 'bg-gradient-to-r from-green-500 to-green-400'"
                                     :style="'width: ' + systemStatus.memory_percent + '%'"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                <span x-text="systemStatus.memory_used"></span> / <span x-text="systemStatus.memory_total"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Disk -->
                    <div class="relative bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 overflow-hidden group hover:border-gray-500/50 transition-all">
                        <div class="absolute inset-0 bg-gradient-to-r opacity-10 group-hover:opacity-20 transition-opacity"
                             :class="systemStatus.disk_percent > 90 ? 'from-red-500 to-red-600' : systemStatus.disk_percent > 70 ? 'from-yellow-500 to-yellow-600' : 'from-green-500 to-green-600'"></div>
                        <div class="relative">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-gray-400 text-sm flex items-center">
                                    <div class="w-7 h-7 bg-gray-600/50 rounded-lg flex items-center justify-center mr-2">
                                        <i class="fas fa-hdd text-orange-400 text-xs"></i>
                                    </div>
                                    Disk
                                </span>
                                <span class="text-2xl font-bold" :class="systemStatus.disk_percent > 90 ? 'text-red-400' : systemStatus.disk_percent > 70 ? 'text-yellow-400' : 'text-green-400'" 
                                      x-text="systemStatus.disk_percent + '%'"></span>
                            </div>
                            <div class="w-full bg-gray-900/50 rounded-full h-2.5 overflow-hidden">
                                <div class="h-2.5 rounded-full transition-all duration-500 progress-animated"
                                     :class="systemStatus.disk_percent > 90 ? 'bg-gradient-to-r from-red-500 to-red-400' : systemStatus.disk_percent > 70 ? 'bg-gradient-to-r from-yellow-500 to-yellow-400' : 'bg-gradient-to-r from-green-500 to-green-400'"
                                     :style="'width: ' + systemStatus.disk_percent + '%'"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">
                                <span x-text="systemStatus.disk_used"></span> / <span x-text="systemStatus.disk_total"></span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Uptime -->
                    <div class="relative bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30 overflow-hidden group hover:border-gray-500/50 transition-all">
                        <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-blue-600 opacity-10 group-hover:opacity-20 transition-opacity"></div>
                        <div class="relative">
                            <div class="flex items-center mb-3">
                                <div class="w-7 h-7 bg-gray-600/50 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-clock text-blue-400 text-xs"></i>
                                </div>
                                <span class="text-gray-400 text-sm">Uptime</span>
                            </div>
                            <div class="text-2xl font-bold text-blue-400" x-text="systemStatus.uptime || '-'"></div>
                            <div class="text-xs text-gray-500 mt-2">
                                <i class="fas fa-power-off mr-1"></i>Boot: <span x-text="systemStatus.boot_time || '-'"></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Network & Process Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <!-- Network -->
                    <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                        <h3 class="text-gray-400 text-sm mb-4 flex items-center">
                            <div class="w-7 h-7 bg-gray-600/50 rounded-lg flex items-center justify-center mr-2">
                                <i class="fas fa-network-wired text-emerald-400 text-xs"></i>
                            </div>
                            Network I/O
                        </h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-gray-800/50 rounded-lg p-3 text-center">
                                <div class="text-xs text-gray-500 uppercase tracking-wide mb-1">Sent</div>
                                <div class="text-xl font-bold text-green-400 flex items-center justify-center">
                                    <i class="fas fa-arrow-up mr-2 text-sm"></i>
                                    <span x-text="systemStatus.network_sent || '-'"></span>
                                </div>
                            </div>
                            <div class="bg-gray-800/50 rounded-lg p-3 text-center">
                                <div class="text-xs text-gray-500 uppercase tracking-wide mb-1">Received</div>
                                <div class="text-xl font-bold text-blue-400 flex items-center justify-center">
                                    <i class="fas fa-arrow-down mr-2 text-sm"></i>
                                    <span x-text="systemStatus.network_recv || '-'"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- System Info -->
                    <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                        <h3 class="text-gray-400 text-sm mb-4 flex items-center">
                            <div class="w-7 h-7 bg-gray-600/50 rounded-lg flex items-center justify-center mr-2">
                                <i class="fas fa-info-circle text-blue-400 text-xs"></i>
                            </div>
                            System Info
                        </h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                <span class="text-gray-500 flex items-center"><i class="fab fa-linux mr-2 text-gray-600"></i>OS</span>
                                <span class="text-gray-300 font-medium" x-text="systemStatus.os_info || '-'"></span>
                            </div>
                            <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                <span class="text-gray-500 flex items-center"><i class="fab fa-python mr-2 text-yellow-500"></i>Python</span>
                                <span class="text-gray-300 font-medium" x-text="systemStatus.python_version || '-'"></span>
                            </div>
                            <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                <span class="text-gray-500 flex items-center"><i class="fas fa-cogs mr-2 text-gray-600"></i>Processes</span>
                                <span class="text-gray-300 font-medium" x-text="systemStatus.process_count || '-'"></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- HoN Process Info -->
                <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                    <h3 class="text-gray-400 text-sm mb-4 flex items-center">
                        <div class="w-7 h-7 bg-purple-500/20 rounded-lg flex items-center justify-center mr-2">
                            <i class="fas fa-gamepad text-purple-400 text-xs"></i>
                        </div>
                        HoN Server Processes
                    </h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                        <div class="bg-gradient-to-br from-blue-600/10 to-blue-700/5 rounded-xl p-4 text-center border border-blue-500/20">
                            <div class="text-3xl font-bold text-blue-400" x-text="systemStatus.hon_process_count || 0"></div>
                            <div class="text-xs text-gray-500 mt-1 uppercase tracking-wide">Running</div>
                        </div>
                        <div class="bg-gradient-to-br from-yellow-600/10 to-yellow-700/5 rounded-xl p-4 text-center border border-yellow-500/20">
                            <div class="text-3xl font-bold text-yellow-400" x-text="systemStatus.hon_total_memory || '-'"></div>
                            <div class="text-xs text-gray-500 mt-1 uppercase tracking-wide">Total Memory</div>
                        </div>
                        <div class="bg-gradient-to-br from-green-600/10 to-green-700/5 rounded-xl p-4 text-center border border-green-500/20">
                            <div class="text-3xl font-bold text-green-400" x-text="systemStatus.hon_total_cpu || '-'"></div>
                            <div class="text-xs text-gray-500 mt-1 uppercase tracking-wide">Total CPU %</div>
                        </div>
                        <div class="bg-gradient-to-br from-purple-600/10 to-purple-700/5 rounded-xl p-4 text-center border border-purple-500/20">
                            <div class="text-3xl font-bold text-purple-400" x-text="systemStatus.hon_avg_memory || '-'"></div>
                            <div class="text-xs text-gray-500 mt-1 uppercase tracking-wide">Avg Mem/Instance</div>
                        </div>
                    </div>
                </div>
                </div>
                
                <!-- Graphs View -->
                <div x-show="systemView === 'graphs'" class="animate-fadeIn">
                    <div class="flex items-center justify-between mb-4 bg-gray-700/30 rounded-lg px-4 py-2">
                        <span class="text-sm text-gray-400 flex items-center">
                            <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse mr-2"></div>
                            <i class="fas fa-chart-line mr-2 text-green-400"></i>
                            Live Update: <span class="text-green-400 font-semibold ml-1" x-text="chartUpdateCount + ' samples'"></span>
                        </span>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                        <!-- CPU Chart -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h3 class="text-sm text-gray-400 mb-3 flex items-center">
                                <div class="w-6 h-6 bg-cyan-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-microchip text-cyan-400 text-xs"></i>
                                </div>
                                CPU Usage
                            </h3>
                            <div class="h-48">
                                <canvas id="cpuChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Memory Chart -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h3 class="text-sm text-gray-400 mb-3 flex items-center">
                                <div class="w-6 h-6 bg-purple-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-memory text-purple-400 text-xs"></i>
                                </div>
                                Memory Usage
                            </h3>
                            <div class="h-48">
                                <canvas id="memoryChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Network Chart -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h3 class="text-sm text-gray-400 mb-3 flex items-center">
                                <div class="w-6 h-6 bg-emerald-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-network-wired text-emerald-400 text-xs"></i>
                                </div>
                                Network I/O
                            </h3>
                            <div class="h-48">
                                <canvas id="networkChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Players Chart -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h3 class="text-sm text-gray-400 mb-3 flex items-center">
                                <div class="w-6 h-6 bg-orange-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-users text-orange-400 text-xs"></i>
                                </div>
                                Players Online
                            </h3>
                            <div class="h-48">
                                <canvas id="playersChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Logs -->
        <div x-show="activeTab === 'logs'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 shadow-xl">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3">
                    <h2 class="text-lg font-semibold flex items-center">
                        <div class="w-8 h-8 bg-yellow-500/20 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-file-alt text-yellow-400"></i>
                        </div>
                        <span x-text="t('serverLogs')"></span>
                    </h2>
                    <div class="flex items-center space-x-2">
                        <select x-model="selectedLogServer" @change="refreshServerLogs()"
                                class="bg-gray-700/50 border border-gray-600/50 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-blue-500">
                            <option value="manager" x-text="t('managerLog')"></option>
                            <template x-for="instance in instances" :key="instance.id">
                                <option :value="instance.id" x-text="t('server') + ' #' + instance.id"></option>
                            </template>
                        </select>
                        <button @click="refreshServerLogs()" 
                                class="bg-gray-700/50 hover:bg-gray-600/50 px-3 py-2 rounded-lg text-sm transition-all border border-gray-600/50">
                            <i class="fas fa-sync-alt" :class="serverLogsLoading && 'animate-spin'"></i>
                        </button>
                        <button @click="downloadLog()" 
                                class="bg-blue-600/20 hover:bg-blue-600/40 px-3 py-2 rounded-lg text-sm transition-all border border-blue-500/30 text-blue-400">
                            <i class="fas fa-download mr-1"></i><span x-text="t('download')"></span>
                        </button>
                    </div>
                </div>
                
                <div class="bg-gray-900 rounded-lg p-4 font-mono text-sm h-[600px] overflow-auto" id="serverLogContainer">
                    <template x-if="serverLogsLoading">
                        <div class="flex flex-col items-center justify-center h-full text-gray-500">
                            <i class="fas fa-spinner animate-spin text-2xl mb-2"></i>
                            <span x-text="t('loadingLogs')"></span>
                        </div>
                    </template>
                    <template x-if="!serverLogsLoading && serverLogs.length === 0">
                        <div class="flex flex-col items-center justify-center h-full text-gray-500">
                            <i class="fas fa-file-alt text-4xl mb-2 opacity-50"></i>
                            <span x-text="t('noLogs')"></span>
                        </div>
                    </template>
                    <template x-for="(line, index) in serverLogs" :key="index">
                        <div class="py-0.5 hover:bg-gray-800/50 px-2 rounded transition-colors"
                             :class="{
                                 'text-red-400': line.includes('ERROR'),
                                 'text-yellow-400': line.includes('WARNING'),
                                 'text-green-400': line.includes('INFO'),
                                 'text-gray-400': !line.includes('ERROR') && !line.includes('WARNING') && !line.includes('INFO')
                             }"
                             x-text="line"></div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Tab: Replays -->
        <div x-show="activeTab === 'replays'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50 shadow-xl">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-3">
                    <h2 class="text-lg font-semibold flex items-center">
                        <div class="w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-film text-purple-400"></i>
                        </div>
                        <span x-text="t('replayManager')"></span>
                    </h2>
                    <div class="flex items-center space-x-2 flex-wrap gap-y-2">
                        <span class="text-sm text-gray-400 bg-gray-700/30 px-3 py-1.5 rounded-lg">
                            <i class="fas fa-database mr-1 text-purple-400"></i>
                            <span x-text="filteredReplays.length"></span> <span x-text="t('replays')"></span>
                            <span class="text-gray-500 ml-1">(<span x-text="replaysTotalSize"></span>)</span>
                        </span>
                        <button @click="refreshReplays()" 
                                class="bg-gray-700/50 hover:bg-gray-600/50 px-3 py-1.5 rounded-lg text-sm transition-all border border-gray-600/50">
                            <i class="fas fa-sync-alt" :class="replaysLoading && 'animate-spin'"></i>
                        </button>
                        <button @click="showDeleteOldReplaysModal = true" 
                                class="bg-red-600/20 hover:bg-red-600/40 px-3 py-1.5 rounded-lg text-sm transition-all border border-red-500/30 text-red-400">
                            <i class="fas fa-trash mr-1"></i><span x-text="t('cleanOld')"></span>
                        </button>
                    </div>
                </div>
                
                <!-- Search Box -->
                <div class="mb-4">
                    <div class="relative">
                        <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500"></i>
                        <input type="text" x-model="replaySearchQuery" 
                               placeholder="Search by Match ID..."
                               class="w-full bg-gray-700/50 border border-gray-600/50 rounded-xl pl-11 pr-10 py-2.5 text-sm focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 transition-all">
                        <button x-show="replaySearchQuery" @click="replaySearchQuery = ''" 
                                class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-white transition-colors">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Replays List -->
                <div class="overflow-x-auto rounded-xl border border-gray-700/50">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-800/50 border-b border-gray-700/50">
                            <tr>
                                <th class="px-4 py-3 text-left font-medium text-gray-400">
                                    <i class="fas fa-hashtag mr-2 text-purple-400"></i>Match ID
                                </th>
                                <th class="px-4 py-3 text-left font-medium text-gray-400">
                                    <i class="fas fa-calendar mr-2 text-gray-500"></i>Date
                                </th>
                                <th class="px-4 py-3 text-left font-medium text-gray-400">
                                    <i class="fas fa-file mr-2 text-gray-500"></i>Size
                                </th>
                                <th class="px-4 py-3 text-left font-medium text-gray-400">
                                    <i class="fas fa-clock mr-2 text-gray-500"></i>Duration
                                </th>
                                <th class="px-4 py-3 text-center font-medium text-gray-400">
                                    <i class="fas fa-cogs mr-2 text-gray-500"></i>Actions
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-if="replaysLoading">
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                        <i class="fas fa-spinner animate-spin mr-2"></i>Loading replays...
                                    </td>
                                </tr>
                            </template>
                            <template x-if="!replaysLoading && filteredReplays.length === 0">
                                <tr>
                                    <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                        <i class="fas fa-film mr-2"></i>
                                        <span x-text="replaySearchQuery ? t('noReplayFound') : t('noReplays')"></span>
                                    </td>
                                </tr>
                            </template>
                            <template x-for="replay in filteredReplays" :key="replay.match_id">
                                <tr class="border-b border-gray-700 hover:bg-gray-700">
                                    <td class="px-4 py-2 font-mono text-blue-400" x-text="replay.match_id"></td>
                                    <td class="px-4 py-2 text-gray-300" x-text="replay.date"></td>
                                    <td class="px-4 py-2 text-gray-400" x-text="replay.size"></td>
                                    <td class="px-4 py-2 text-gray-400" x-text="replay.duration || '-'"></td>
                                    <td class="px-4 py-2 text-center">
                                        <a :href="'/api/replays/download/' + replay.filename" 
                                           class="text-blue-400 hover:text-blue-300 mr-3" title="Download">
                                            <i class="fas fa-download"></i>
                                        </a>
                                        <button @click="deleteReplay(replay.filename)" 
                                                class="text-red-400 hover:text-red-300" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Tab: Statistics -->
        <div x-show="activeTab === 'statistics'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="space-y-6">
                <!-- Statistics Summary -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-gradient-to-br from-blue-600/20 to-blue-800/20 rounded-xl p-4 border border-blue-500/30">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm" x-text="t('totalMatches')"></p>
                                <p class="text-2xl font-bold text-blue-400" x-text="statistics.summary?.totalMatches || 0"></p>
                            </div>
                            <div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-gamepad text-blue-400 text-xl"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-green-600/20 to-green-800/20 rounded-xl p-4 border border-green-500/30">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm" x-text="t('totalPlayers')"></p>
                                <p class="text-2xl font-bold text-green-400" x-text="statistics.summary?.totalPlayers || 0"></p>
                            </div>
                            <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-users text-green-400 text-xl"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-purple-600/20 to-purple-800/20 rounded-xl p-4 border border-purple-500/30">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm" x-text="t('avgDuration')"></p>
                                <p class="text-2xl font-bold text-purple-400" x-text="statistics.summary?.avgDuration || '-'"></p>
                            </div>
                            <div class="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-clock text-purple-400 text-xl"></i>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-orange-600/20 to-orange-800/20 rounded-xl p-4 border border-orange-500/30">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm" x-text="t('matchesToday')"></p>
                                <p class="text-2xl font-bold text-orange-400" x-text="statistics.summary?.matchesToday || 0"></p>
                            </div>
                            <div class="w-12 h-12 bg-orange-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-calendar-day text-orange-400 text-xl"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Matches & Top Players -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Recent Matches -->
                    <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-history text-blue-400 mr-2"></i>
                            <span x-text="t('recentMatches')"></span>
                        </h3>
                        <div class="space-y-2 max-h-80 overflow-y-auto">
                            <template x-if="statistics.recentMatches?.length === 0">
                                <p class="text-gray-500 text-center py-4" x-text="t('noMatches')"></p>
                            </template>
                            <template x-for="match in statistics.recentMatches" :key="match.matchId">
                                <div class="bg-gray-700/30 rounded-lg p-3 hover:bg-gray-700/50 transition-colors">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <span class="font-mono text-blue-400">#<span x-text="match.matchId"></span></span>
                                            <span class="text-gray-500 text-sm ml-2" x-text="match.mapName || 'Unknown Map'"></span>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-gray-400 text-sm" x-text="match.duration || '-'"></span>
                                            <span class="text-gray-600 text-xs block" x-text="match.endTime"></span>
                                        </div>
                                    </div>
                                    <div class="flex items-center mt-2 text-sm">
                                        <i class="fas fa-users text-gray-500 mr-2"></i>
                                        <span class="text-gray-400" x-text="match.playerCount + ' players'"></span>
                                        <span class="mx-2 text-gray-600">โ€ข</span>
                                        <span class="text-gray-400" x-text="'Server #' + match.serverId"></span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Top Players -->
                    <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-trophy text-yellow-400 mr-2"></i>
                            <span x-text="t('topPlayers')"></span>
                        </h3>
                        <div class="space-y-2 max-h-80 overflow-y-auto">
                            <template x-if="statistics.topPlayers?.length === 0">
                                <p class="text-gray-500 text-center py-4" x-text="t('noPlayers')"></p>
                            </template>
                            <template x-for="(player, index) in statistics.topPlayers" :key="player.playerName">
                                <div class="bg-gray-700/30 rounded-lg p-3 hover:bg-gray-700/50 transition-colors flex items-center">
                                    <div class="w-8 h-8 rounded-full flex items-center justify-center mr-3"
                                         :class="index === 0 ? 'bg-yellow-500/30 text-yellow-400' : index === 1 ? 'bg-gray-400/30 text-gray-300' : index === 2 ? 'bg-orange-500/30 text-orange-400' : 'bg-gray-600/30 text-gray-500'">
                                        <span class="font-bold text-sm" x-text="index + 1"></span>
                                    </div>
                                    <div class="flex-1">
                                        <span class="font-medium" x-text="player.playerName"></span>
                                        <div class="text-sm text-gray-500">
                                            <span x-text="player.wins + ' wins'"></span>
                                            <span class="mx-1">โ€ข</span>
                                            <span x-text="player.gamesPlayed + ' games'"></span>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <span class="text-green-400 font-bold" x-text="(player.winRate * 100).toFixed(1) + '%'"></span>
                                        <span class="text-gray-500 text-xs block">Win Rate</span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- Daily Chart -->
                <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-4 border border-gray-700/50">
                    <h3 class="text-lg font-semibold mb-4 flex items-center">
                        <i class="fas fa-chart-line text-green-400 mr-2"></i>
                        <span x-text="t('dailyStats')"></span>
                    </h3>
                    <div class="h-64">
                        <canvas id="dailyStatsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Auto-scaling -->
        <div x-show="activeTab === 'scaling'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="space-y-6">
                <!-- Scaling Status -->
                <div class="bg-gradient-to-br from-gray-800 to-gray-800/50 rounded-xl p-6 border border-gray-700/50">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold flex items-center">
                            <i class="fas fa-expand-arrows-alt text-purple-400 mr-2"></i>
                            <span x-text="t('autoScalingStatus')"></span>
                        </h3>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-gray-400" x-text="scaling.enabled ? t('enabled') : t('disabled')"></span>
                            <span class="w-3 h-3 rounded-full" :class="scaling.enabled ? 'bg-green-500 animate-pulse' : 'bg-gray-500'"></span>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="bg-gray-700/30 rounded-lg p-4">
                            <p class="text-gray-400 text-sm mb-1" x-text="t('serverCapacity')"></p>
                            <p class="text-xl font-bold">
                                <span class="text-blue-400" x-text="scaling.totalServers"></span>
                                <span class="text-gray-500">/</span>
                                <span class="text-gray-400" x-text="scaling.maxServers"></span>
                            </p>
                            <div class="mt-2 h-2 bg-gray-700 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 transition-all duration-500"
                                     :style="'width: ' + (scaling.maxServers > 0 ? (scaling.totalServers / scaling.maxServers * 100) : 0) + '%'"></div>
                            </div>
                        </div>
                        <div class="bg-gray-700/30 rounded-lg p-4">
                            <p class="text-gray-400 text-sm mb-1" x-text="t('occupancyRate')"></p>
                            <p class="text-xl font-bold" :class="scaling.occupancyRate > 80 ? 'text-red-400' : scaling.occupancyRate > 50 ? 'text-yellow-400' : 'text-green-400'">
                                <span x-text="scaling.occupancyRate?.toFixed(1) || 0"></span>%
                            </p>
                            <div class="mt-2 h-2 bg-gray-700 rounded-full overflow-hidden">
                                <div class="h-full transition-all duration-500"
                                     :class="scaling.occupancyRate > 80 ? 'bg-red-500' : scaling.occupancyRate > 50 ? 'bg-yellow-500' : 'bg-green-500'"
                                     :style="'width: ' + (scaling.occupancyRate || 0) + '%'"></div>
                            </div>
                        </div>
                        <div class="bg-gray-700/30 rounded-lg p-4">
                            <p class="text-gray-400 text-sm mb-1" x-text="t('readyServers')"></p>
                            <p class="text-xl font-bold">
                                <span class="text-green-400" x-text="scaling.readyServers || 0"></span>
                                <span class="text-gray-500 text-sm ml-1">ready</span>
                            </p>
                            <p class="text-sm text-gray-500 mt-2">
                                <span x-text="scaling.occupiedServers || 0"></span> occupied
                            </p>
                        </div>
                    </div>

                    <!-- Scaling Thresholds -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gray-700/30 rounded-lg p-4">
                            <h4 class="font-medium mb-3 flex items-center">
                                <i class="fas fa-arrow-up text-green-400 mr-2"></i>
                                <span x-text="t('scaleUpThreshold')"></span>
                            </h4>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-400">When occupancy ></span>
                                <span class="text-green-400 font-bold" x-text="scaling.scaleUpThreshold + '%'"></span>
                            </div>
                        </div>
                        <div class="bg-gray-700/30 rounded-lg p-4">
                            <h4 class="font-medium mb-3 flex items-center">
                                <i class="fas fa-arrow-down text-red-400 mr-2"></i>
                                <span x-text="t('scaleDownThreshold')"></span>
                            </h4>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-400">When occupancy <</span>
                                <span class="text-red-400 font-bold" x-text="scaling.scaleDownThreshold + '%'"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Last Action & Cooldown -->
                    <div class="bg-gray-700/30 rounded-lg p-4 mb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-400 text-sm" x-text="t('lastAction')"></p>
                                <p class="font-medium" x-text="scaling.lastScaleAction || 'None'"></p>
                            </div>
                            <div class="text-right">
                                <p class="text-gray-400 text-sm" x-text="t('cooldown')"></p>
                                <p class="font-medium" :class="scaling.inCooldown ? 'text-yellow-400' : 'text-green-400'">
                                    <template x-if="scaling.inCooldown">
                                        <span><i class="fas fa-hourglass-half mr-1"></i><span x-text="scaling.cooldownRemainingSeconds + 's'"></span></span>
                                    </template>
                                    <template x-if="!scaling.inCooldown">
                                        <span><i class="fas fa-check mr-1"></i>Ready</span>
                                    </template>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Manual Controls -->
                    <div class="flex items-center justify-center space-x-4">
                        <button @click="manualScaleUp()" 
                                :disabled="scaling.totalServers >= scaling.maxServers"
                                class="px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 rounded-xl transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fas fa-plus mr-2"></i>
                            <span x-text="t('scaleUp')"></span>
                        </button>
                        <button @click="manualScaleDown()" 
                                :disabled="scaling.totalServers <= scaling.minServers"
                                class="px-6 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-500 hover:to-red-600 rounded-xl transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fas fa-minus mr-2"></i>
                            <span x-text="t('scaleDown')"></span>
                        </button>
                        <button @click="loadScalingStatus()" 
                                class="px-6 py-3 bg-gray-700/50 hover:bg-gray-600/50 rounded-xl transition-all border border-gray-600/50">
                            <i class="fas fa-sync-alt" :class="scalingLoading && 'animate-spin'"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </main>

    <!-- Notifications Panel -->
    <div class="fixed bottom-4 right-4 space-y-2 z-50" x-show="notifications.length > 0">
        <template x-for="notif in notifications" :key="notif.id">
            <div class="bg-gray-800 border rounded-lg p-4 shadow-lg max-w-sm flex items-start space-x-3"
                 :class="{
                     'border-red-500': notif.type === 'error',
                     'border-yellow-500': notif.type === 'warning',
                     'border-green-500': notif.type === 'success',
                     'border-blue-500': notif.type === 'info'
                 }"
                 x-show="notif.show"
                 x-transition>
                <div class="flex-shrink-0">
                    <i class="fas" :class="{
                        'fa-exclamation-circle text-red-500': notif.type === 'error',
                        'fa-exclamation-triangle text-yellow-500': notif.type === 'warning',
                        'fa-check-circle text-green-500': notif.type === 'success',
                        'fa-info-circle text-blue-500': notif.type === 'info'
                    }"></i>
                </div>
                <div class="flex-1">
                    <div class="font-semibold text-sm" x-text="notif.title"></div>
                    <div class="text-gray-400 text-sm" x-text="notif.message"></div>
                </div>
                <button @click="dismissNotification(notif.id)" class="text-gray-500 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </template>
    </div>

    <!-- Delete Old Replays Modal -->
    <div x-show="showDeleteOldReplaysModal" x-cloak
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-lg p-4 md:p-6 w-full max-w-sm border border-gray-700" @click.away="showDeleteOldReplaysModal = false">
            <h3 class="text-lg font-semibold mb-4">
                <i class="fas fa-trash mr-2 text-red-400"></i><span x-text="t('deleteOldReplays')"></span>
            </h3>
            <p class="text-gray-400 text-sm mb-4" x-text="t('deleteReplaysOlderThan')"></p>
            <select x-model="deleteReplaysOlderThan" class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 mb-4">
                <option value="7" x-text="'7 ' + t('days')"></option>
                <option value="14" x-text="'14 ' + t('days')"></option>
                <option value="30" x-text="'30 ' + t('days')"></option>
                <option value="60" x-text="'60 ' + t('days')"></option>
                <option value="90" x-text="'90 ' + t('days')"></option>
            </select>
            <div class="flex justify-end space-x-2">
                <button @click="showDeleteOldReplaysModal = false" 
                        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">
                    <span x-text="t('cancel')"></span>
                </button>
                <button @click="deleteOldReplays()" 
                        class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded transition-colors">
                    <span x-text="t('delete')"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Message Modal -->
    <div x-show="showMessageModal" x-cloak
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-lg p-4 md:p-6 w-full max-w-sm border border-gray-700" @click.away="showMessageModal = false">
            <h3 class="text-lg font-semibold mb-4">
                <i class="fas fa-comment mr-2"></i><span x-text="t('sendMessage') + ' #'"></span><span x-text="messageTargetId"></span>
            </h3>
            <input type="text" x-model="messageText" 
                   :placeholder="t('enterMessage')"
                   class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 mb-4 focus:outline-none focus:border-blue-500"
                   @keyup.enter="sendMessage()">
            <div class="flex justify-end space-x-2">
                <button @click="showMessageModal = false" 
                        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">
                    <span x-text="t('cancel')"></span>
                </button>
                <button @click="sendMessage()" 
                        class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition-colors">
                    Send
                </button>
            </div>
        </div>
    </div>

    <!-- Broadcast Modal -->
    <div x-show="showBroadcastModal" x-cloak
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-gray-800 rounded-lg p-4 md:p-6 w-full max-w-md border border-gray-700" @click.away="showBroadcastModal = false">
            <h3 class="text-lg font-semibold mb-4">
                <i class="fas fa-bullhorn mr-2 text-purple-400"></i><span x-text="t('broadcastToAll')"></span>
            </h3>
            
            <!-- Message Type Selection -->
            <div class="mb-4">
                <label class="block text-sm text-gray-400 mb-2" x-text="t('messageType')"></label>
                <div class="grid grid-cols-2 gap-2">
                    <button @click="broadcastType = 'normal'" 
                            class="px-3 py-2 rounded text-sm transition-colors flex items-center justify-center space-x-2"
                            :class="broadcastType === 'normal' ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'">
                        <i class="fas fa-comment"></i>
                        <span x-text="t('normal')"></span>
                    </button>
                    <button @click="broadcastType = 'announcement'" 
                            class="px-3 py-2 rounded text-sm transition-colors flex items-center justify-center space-x-2"
                            :class="broadcastType === 'announcement' ? 'bg-purple-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'">
                        <i class="fas fa-bullhorn"></i>
                        <span x-text="t('announcement')"></span>
                    </button>
                    <button @click="broadcastType = 'warning'" 
                            class="px-3 py-2 rounded text-sm transition-colors flex items-center justify-center space-x-2"
                            :class="broadcastType === 'warning' ? 'bg-yellow-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span x-text="t('warning')"></span>
                    </button>
                    <button @click="broadcastType = 'system'" 
                            class="px-3 py-2 rounded text-sm transition-colors flex items-center justify-center space-x-2"
                            :class="broadcastType === 'system' ? 'bg-red-600 text-white' : 'bg-gray-700 text-gray-300 hover:bg-gray-600'">
                        <i class="fas fa-cog"></i>
                        <span x-text="t('system')"></span>
                    </button>
                </div>
            </div>
            
            <!-- Message Preview -->
            <div class="mb-4 p-3 rounded text-sm"
                 :class="{
                     'bg-blue-900/30 border border-blue-700': broadcastType === 'normal',
                     'bg-purple-900/30 border border-purple-700': broadcastType === 'announcement',
                     'bg-yellow-900/30 border border-yellow-700': broadcastType === 'warning',
                     'bg-red-900/30 border border-red-700': broadcastType === 'system'
                 }">
                <div class="flex items-center space-x-2 mb-1">
                    <i class="fas" :class="{
                        'fa-comment text-blue-400': broadcastType === 'normal',
                        'fa-bullhorn text-purple-400': broadcastType === 'announcement',
                        'fa-exclamation-triangle text-yellow-400': broadcastType === 'warning',
                        'fa-cog text-red-400': broadcastType === 'system'
                    }"></i>
                    <span class="font-semibold" :class="{
                        'text-blue-400': broadcastType === 'normal',
                        'text-purple-400': broadcastType === 'announcement',
                        'text-yellow-400': broadcastType === 'warning',
                        'text-red-400': broadcastType === 'system'
                    }" x-text="broadcastType === 'normal' ? 'Message' : broadcastType === 'announcement' ? 'ANNOUNCEMENT' : broadcastType === 'warning' ? 'WARNING' : 'SYSTEM'"></span>
                </div>
                <div class="text-gray-300" x-text="broadcastText || 'Your message will appear here...'"></div>
            </div>
            
            <!-- Message Input -->
            <input type="text" x-model="broadcastText" 
                   :placeholder="t('enterMessage')"
                   class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 mb-4 focus:outline-none focus:border-purple-500"
                   @keyup.enter="sendBroadcastMessage()">
            
            <div class="text-sm text-gray-400 mb-4">
                <i class="fas fa-info-circle mr-1"></i>
                <span x-text="t('broadcastInfo')"></span> <span x-text="instances.length"></span> <span x-text="t('runningServers')"></span>
            </div>
            <div class="flex justify-end space-x-2">
                <button @click="showBroadcastModal = false" 
                        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">
                    <span x-text="t('cancel')"></span>
                </button>
                <button @click="sendBroadcastMessage()" 
                        class="px-4 py-2 rounded transition-colors"
                        :class="{
                            'bg-blue-600 hover:bg-blue-700': broadcastType === 'normal',
                            'bg-purple-600 hover:bg-purple-700': broadcastType === 'announcement',
                            'bg-yellow-600 hover:bg-yellow-700': broadcastType === 'warning',
                            'bg-red-600 hover:bg-red-700': broadcastType === 'system'
                        }">
                    <i class="fas fa-paper-plane mr-2"></i><span x-text="t('broadcast')"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Add Server Modal -->
    <div x-show="showAddServerModal" x-cloak
         class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0">
        <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 md:p-6 w-full max-w-md border border-gray-700/50 shadow-2xl" 
             @click.away="showAddServerModal = false"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100">
            <h3 class="text-lg font-semibold mb-5 flex items-center">
                <div class="w-10 h-10 bg-blue-500/20 rounded-xl flex items-center justify-center mr-3">
                    <i class="fas fa-plus-circle text-blue-400 text-lg"></i>
                </div>
                <span x-text="t('addNewServers')"></span>
            </h3>
            
            <!-- Server Count Selection -->
            <div class="mb-5">
                <label class="block text-sm text-gray-400 mb-3" x-text="t('numberOfServersToAdd')"></label>
                <div class="flex items-center justify-center space-x-4">
                    <button @click="addServerCount > 1 ? addServerCount-- : null" 
                            class="w-12 h-12 bg-red-600/20 hover:bg-red-600/40 border border-red-500/30 rounded-xl transition-all text-lg font-bold text-red-400 flex items-center justify-center"
                            :class="addServerCount <= 1 ? 'opacity-50 cursor-not-allowed' : ''">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" x-model.number="addServerCount" min="1" max="20"
                           class="w-24 text-center bg-gray-700/50 border border-gray-600/50 rounded-xl px-3 py-3 text-2xl font-bold focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20">
                    <button @click="addServerCount < 20 ? addServerCount++ : null" 
                            class="w-12 h-12 bg-green-600/20 hover:bg-green-600/40 border border-green-500/30 rounded-xl transition-all text-lg font-bold text-green-400 flex items-center justify-center"
                            :class="addServerCount >= 20 ? 'opacity-50 cursor-not-allowed' : ''">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            
            <!-- Quick Select Buttons -->
            <div class="mb-5">
                <label class="block text-sm text-gray-400 mb-2" x-text="t('quickSelect')"></label>
                <div class="grid grid-cols-5 gap-2">
                    <template x-for="n in [1, 2, 3, 5, 10]" :key="n">
                        <button @click="addServerCount = n" 
                                class="px-3 py-2.5 rounded-lg text-sm font-medium transition-all"
                                :class="addServerCount === n ? 'bg-blue-600 text-white shadow-lg shadow-blue-600/30' : 'bg-gray-700/50 text-gray-300 hover:bg-gray-600/50 border border-gray-600/50'"
                                x-text="n"></button>
                    </template>
                </div>
            </div>
            
            <!-- Info -->
            <div class="text-sm text-gray-400 mb-5 p-4 bg-blue-900/20 border border-blue-500/20 rounded-xl">
                <div class="flex items-start space-x-2">
                    <i class="fas fa-info-circle text-blue-400 mt-0.5"></i>
                    <div>
                        <span x-text="t('willAdd')"></span> <span class="font-bold text-blue-400" x-text="addServerCount"></span> <span x-text="t('newServers')"></span>
                        <div class="text-xs text-gray-500 mt-1"><span x-text="t('current')"></span>: <span class="text-gray-400" x-text="instances.length"></span> โ’ <span x-text="t('after')"></span>: <span class="text-green-400" x-text="instances.length + addServerCount"></span> <span x-text="t('servers')"></span></div>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button @click="showAddServerModal = false" 
                        class="px-5 py-2.5 bg-gray-700/50 hover:bg-gray-600/50 rounded-xl transition-all border border-gray-600/50">
                    <span x-text="t('cancel')"></span>
                </button>
                <button @click="addServers()" 
                        class="px-5 py-2.5 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 rounded-xl transition-all shadow-lg shadow-blue-600/30">
                    <i class="fas fa-plus mr-2"></i><span x-text="t('add')"></span> <span x-text="addServerCount"></span> <span x-text="t('servers')"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Server Modal -->
    <div x-show="showDeleteServerModal" x-cloak
         class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0">
        <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 md:p-6 w-full max-w-md border border-gray-700/50 shadow-2xl" 
             @click.away="showDeleteServerModal = false"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100">
            <h3 class="text-lg font-semibold mb-5 flex items-center">
                <div class="w-10 h-10 bg-red-500/20 rounded-xl flex items-center justify-center mr-3">
                    <i class="fas fa-trash-alt text-red-400 text-lg"></i>
                </div>
                <span x-text="t('deleteServers')"></span>
            </h3>
            
            <!-- Delete Mode Selection -->
            <div class="mb-5">
                <label class="block text-sm text-gray-400 mb-2" x-text="t('deleteMode')"></label>
                <div class="grid grid-cols-2 gap-3">
                    <button @click="deleteMode = 'count'" 
                            class="px-4 py-3 rounded-xl text-sm transition-all flex items-center justify-center space-x-2"
                            :class="deleteMode === 'count' ? 'bg-red-600 text-white shadow-lg shadow-red-600/30' : 'bg-gray-700/50 text-gray-300 hover:bg-gray-600/50 border border-gray-600/50'">
                        <i class="fas fa-hashtag"></i>
                        <span x-text="t('byCount')"></span>
                    </button>
                    <button @click="deleteMode = 'all'" 
                            class="px-4 py-3 rounded-xl text-sm transition-all flex items-center justify-center space-x-2"
                            :class="deleteMode === 'all' ? 'bg-red-600 text-white shadow-lg shadow-red-600/30' : 'bg-gray-700/50 text-gray-300 hover:bg-gray-600/50 border border-gray-600/50'">
                        <i class="fas fa-trash"></i>
                        <span x-text="t('deleteAll')"></span>
                    </button>
                </div>
            </div>
            
            <!-- Server Count Selection (only show for 'count' mode) -->
            <div x-show="deleteMode === 'count'" class="mb-5" x-transition>
                <label class="block text-sm text-gray-400 mb-3" x-text="t('numberOfServersToDelete')"></label>
                <div class="flex items-center justify-center space-x-4">
                    <button @click="deleteServerCount > 1 ? deleteServerCount-- : null" 
                            class="w-12 h-12 bg-gray-700/50 hover:bg-gray-600/50 border border-gray-600/50 rounded-xl transition-all text-lg font-bold flex items-center justify-center"
                            :class="deleteServerCount <= 1 ? 'opacity-50 cursor-not-allowed' : ''">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" x-model.number="deleteServerCount" min="1" :max="instances.length"
                           class="w-24 text-center bg-gray-700/50 border border-gray-600/50 rounded-xl px-3 py-3 text-2xl font-bold focus:outline-none focus:border-red-500 focus:ring-2 focus:ring-red-500/20">
                    <button @click="deleteServerCount < instances.length ? deleteServerCount++ : null" 
                            class="w-12 h-12 bg-gray-700/50 hover:bg-gray-600/50 border border-gray-600/50 rounded-xl transition-all text-lg font-bold flex items-center justify-center"
                            :class="deleteServerCount >= instances.length ? 'opacity-50 cursor-not-allowed' : ''">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </div>
            
            <!-- Quick Select Buttons (only show for 'count' mode) -->
            <div x-show="deleteMode === 'count'" class="mb-5" x-transition>
                <label class="block text-sm text-gray-400 mb-2" x-text="t('quickSelect')"></label>
                <div class="grid grid-cols-5 gap-2">
                    <template x-for="n in [1, 2, 3, 5, 10]" :key="n">
                        <button @click="deleteServerCount = Math.min(n, instances.length)" 
                                class="px-3 py-2.5 rounded-lg text-sm font-medium transition-all"
                                :class="deleteServerCount === n ? 'bg-red-600 text-white shadow-lg shadow-red-600/30' : 'bg-gray-700/50 text-gray-300 hover:bg-gray-600/50 border border-gray-600/50'"
                                :disabled="n > instances.length"
                                x-text="n"></button>
                    </template>
                </div>
            </div>
            
            <!-- Warning for Delete All -->
            <div x-show="deleteMode === 'all'" class="mb-5 p-4 bg-red-900/20 border border-red-500/30 rounded-xl" x-transition>
                <div class="flex items-center space-x-2 text-red-400 mb-2">
                    <i class="fas fa-exclamation-triangle text-lg"></i>
                    <span class="font-semibold" x-text="t('warning') + '!'"></span>
                </div>
                <p class="text-sm text-gray-300"><span x-text="t('deleteAllWarning')"></span> <span class="font-bold text-white" x-text="instances.length"></span> <span x-text="t('servers')"></span></p>
            </div>
            
            <!-- Info -->
            <div class="text-sm text-gray-400 mb-5 p-4 bg-red-900/10 border border-red-500/20 rounded-xl">
                <div class="flex items-start space-x-2">
                    <i class="fas fa-info-circle text-red-400 mt-0.5"></i>
                    <div>
                        <span x-show="deleteMode === 'count'"><span x-text="t('willDelete')"></span> <span class="font-bold text-red-400" x-text="deleteServerCount"></span> <span x-text="deleteServerCount === 1 ? t('server') : t('servers')"></span></span>
                        <span x-show="deleteMode === 'all'"><span x-text="t('willDelete')"></span> <span class="font-bold text-red-400" x-text="instances.length"></span> <span x-text="instances.length === 1 ? t('server') : t('servers')"></span></span>
                        <div class="text-xs text-gray-500 mt-1"><span x-text="t('current')"></span>: <span class="text-gray-400" x-text="instances.length"></span> โ’ <span x-text="t('after')"></span>: <span class="text-red-400" x-text="deleteMode === 'all' ? 0 : Math.max(0, instances.length - deleteServerCount)"></span> <span x-text="t('servers')"></span></div>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button @click="showDeleteServerModal = false" 
                        class="px-5 py-2.5 bg-gray-700/50 hover:bg-gray-600/50 rounded-xl transition-all border border-gray-600/50">
                    <span x-text="t('cancel')"></span>
                </button>
                <button @click="deleteServers()" 
                        class="px-5 py-2.5 bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 rounded-xl transition-all shadow-lg shadow-red-600/30">
                    <i class="fas fa-trash mr-2"></i>
                    <span x-show="deleteMode === 'count'"><span x-text="t('delete')"></span> <span x-text="deleteServerCount"></span> <span x-text="deleteServerCount === 1 ? t('server') : t('servers')"></span></span>
                    <span x-show="deleteMode === 'all'" x-text="t('deleteAllServers')"></span>
                </button>
            </div>
        </div>
    </div>

    <!-- Instance Details Modal -->
    <div x-show="showInstanceModal" x-cloak
         class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"
         @keydown.escape.window="showInstanceModal = false"
         x-transition:enter="transition ease-out duration-200"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0">
        <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-5 md:p-6 w-full max-w-2xl border border-gray-700/50 shadow-2xl max-h-[90vh] overflow-y-auto custom-scrollbar" 
             @click.away="showInstanceModal = false"
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100">
            <template x-if="selectedInstance">
                <div>
                    <!-- Modal Header -->
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 rounded-xl flex items-center justify-center"
                                 :class="{
                                     'bg-green-500/20': selectedInstance.status === 'READY',
                                     'bg-blue-500/20': selectedInstance.status === 'OCCUPIED',
                                     'bg-yellow-500/20': selectedInstance.status === 'IDLE' || selectedInstance.status === 'STARTING',
                                     'bg-red-500/20': selectedInstance.status === 'CRASHED' || selectedInstance.status === 'OFFLINE',
                                     'bg-gray-500/20': !['READY', 'OCCUPIED', 'IDLE', 'STARTING', 'CRASHED', 'OFFLINE'].includes(selectedInstance.status)
                                 }">
                                <span class="w-3 h-3 rounded-full animate-pulse" :class="getStatusColor(selectedInstance.status)"></span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold" x-text="'Server #' + selectedInstance.id"></h3>
                                <span class="text-xs px-2.5 py-1 rounded-full font-medium" 
                                      :class="getStatusBadgeClass(selectedInstance.status)"
                                      x-text="selectedInstance.status"></span>
                            </div>
                        </div>
                        <button @click="showInstanceModal = false" 
                                class="w-10 h-10 rounded-xl bg-gray-700/50 hover:bg-gray-600/50 text-gray-400 hover:text-white transition-all flex items-center justify-center border border-gray-600/50">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <!-- Instance Info Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <!-- Connection Info -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h4 class="text-sm font-semibold text-gray-400 mb-4 flex items-center">
                                <div class="w-6 h-6 bg-blue-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-plug text-blue-400 text-xs"></i>
                                </div>
                                <span x-text="t('connectionInfo')"></span>
                            </h4>
                            <div class="space-y-2.5 text-sm">
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                    <span class="text-gray-400" x-text="t('port') + ' (Local):'"></span>
                                    <span class="font-mono text-white" x-text="selectedInstance.port"></span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2" x-show="selectedInstance.proxy_enabled">
                                    <span class="text-gray-400 flex items-center">
                                        <i class="fas fa-shield-alt text-purple-400 mr-1.5 text-xs"></i>
                                        Public Port:
                                    </span>
                                    <span class="font-mono text-purple-400 font-semibold" x-text="selectedInstance.public_port"></span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                    <span class="text-gray-400" x-text="t('serverId') + ':'"></span>
                                    <span class="font-mono text-white" x-text="selectedInstance.id"></span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2" x-show="selectedInstance.region">
                                    <span class="text-gray-400" x-text="t('region') + ':'"></span>
                                    <span class="text-white" x-text="selectedInstance.region"></span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2" x-show="selectedInstance.ip">
                                    <span class="text-gray-400">IP:</span>
                                    <span class="font-mono text-white" x-text="selectedInstance.ip"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Game Info -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h4 class="text-sm font-semibold text-gray-400 mb-4 flex items-center">
                                <div class="w-6 h-6 bg-purple-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-gamepad text-purple-400 text-xs"></i>
                                </div>
                                <span x-text="t('gameInfo')"></span>
                            </h4>
                            <div class="space-y-2.5 text-sm">
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                    <span class="text-gray-400" x-text="t('phase') + ':'"></span>
                                    <span class="text-white" x-text="selectedInstance.game_phase || 'N/A'"></span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2">
                                    <span class="text-gray-400" x-text="t('players') + ':'"></span>
                                    <span class="text-white">
                                        <span x-text="selectedInstance.num_clients"></span>/<span x-text="selectedInstance.max_clients"></span>
                                    </span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2" x-show="selectedInstance.match_id">
                                    <span class="text-gray-400" x-text="t('match') + ' ID:'"></span>
                                    <span class="font-mono text-xs text-white" x-text="selectedInstance.match_id"></span>
                                </div>
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2" x-show="selectedInstance.match_duration">
                                    <span class="text-gray-400" x-text="t('duration') + ':'"></span>
                                    <span class="text-white" x-text="selectedInstance.match_duration"></span>
                                </div>
                            </div>
                            
                            <!-- Players in this server by Team -->
                            <div class="mt-4 pt-4 border-t border-gray-600/50">
                                <div class="text-xs text-gray-400 mb-3 flex items-center">
                                    <i class="fas fa-users mr-2"></i><span x-text="t('playersInMatch') + ':'"></span>
                                </div>
                                
                                <!-- Team Display (when team data available) -->
                                <div x-show="selectedInstance.players_by_team && (selectedInstance.players_by_team.legion.length > 0 || selectedInstance.players_by_team.hellbourne.length > 0)">
                                    <div class="space-y-3">
                                        <!-- Legion Team -->
                                        <div x-show="selectedInstance.players_by_team && selectedInstance.players_by_team.legion.length > 0">
                                            <div class="text-xs text-green-400 mb-2 flex items-center font-semibold">
                                                <i class="fas fa-shield-alt mr-1.5"></i>
                                                <span x-text="t('legion')"></span>
                                                <span class="text-gray-500 font-normal ml-1" x-text="'(' + (selectedInstance.players_by_team?.legion?.length || 0) + ')'"></span>
                                            </div>
                                            <div class="flex flex-wrap gap-1.5">
                                                <template x-for="player in (selectedInstance.players_by_team?.legion || [])" :key="player.name">
                                                    <span class="bg-green-900/40 border border-green-600/40 px-2.5 py-1.5 rounded-lg text-xs text-green-300 flex items-center space-x-1.5 hover:bg-green-900/60 transition-colors"
                                                          :title="player.psr ? ('PSR: ' + player.psr) : ''">
                                                        <i class="fas fa-user text-[10px]"></i>
                                                        <span x-text="player.name"></span>
                                                    </span>
                                                </template>
                                            </div>
                                        </div>
                                        
                                        <!-- Hellbourne Team -->
                                        <div x-show="selectedInstance.players_by_team && selectedInstance.players_by_team.hellbourne.length > 0">
                                            <div class="text-xs text-red-400 mb-2 flex items-center font-semibold">
                                                <i class="fas fa-skull mr-1.5"></i>
                                                <span x-text="t('hellbourne')"></span>
                                                <span class="text-gray-500 font-normal ml-1" x-text="'(' + (selectedInstance.players_by_team?.hellbourne?.length || 0) + ')'"></span>
                                            </div>
                                            <div class="flex flex-wrap gap-1.5">
                                                <template x-for="player in (selectedInstance.players_by_team?.hellbourne || [])" :key="player.name">
                                                    <span class="bg-red-900/40 border border-red-600/40 px-2.5 py-1.5 rounded-lg text-xs text-red-300 flex items-center space-x-1.5 hover:bg-red-900/60 transition-colors"
                                                          :title="player.psr ? ('PSR: ' + player.psr) : ''">
                                                        <i class="fas fa-user text-[10px]"></i>
                                                        <span x-text="player.name"></span>
                                                    </span>
                                                </template>
                                            </div>
                                        </div>
                                        
                                        <!-- Spectators -->
                                        <div x-show="selectedInstance.players_by_team && selectedInstance.players_by_team.spectators && selectedInstance.players_by_team.spectators.length > 0">
                                            <div class="text-xs text-gray-400 mb-2 flex items-center font-semibold">
                                                <i class="fas fa-eye mr-1.5"></i>
                                                <span x-text="t('spectators')"></span>
                                                <span class="text-gray-500 font-normal ml-1" x-text="'(' + (selectedInstance.players_by_team?.spectators?.length || 0) + ')'"></span>
                                            </div>
                                            <div class="flex flex-wrap gap-1.5">
                                                <template x-for="player in (selectedInstance.players_by_team?.spectators || [])" :key="player.name">
                                                    <span class="bg-gray-800/60 border border-gray-600/50 px-2.5 py-1.5 rounded-lg text-xs text-gray-400 flex items-center space-x-1.5 hover:bg-gray-800 transition-colors">
                                                        <i class="fas fa-eye text-[10px]"></i>
                                                        <span x-text="player.name"></span>
                                                    </span>
                                                </template>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Fallback: Simple player list when no team data -->
                                <div x-show="!(selectedInstance.players_by_team && (selectedInstance.players_by_team.legion.length > 0 || selectedInstance.players_by_team.hellbourne.length > 0)) && selectedInstance.players && selectedInstance.players.length > 0">
                                    <div class="flex flex-wrap gap-1.5">
                                        <template x-for="player in (selectedInstance.players || [])" :key="player.name || player">
                                            <span @click.stop="showPlayerDetails(player)" class="bg-gray-800/60 border border-gray-600/50 px-2.5 py-1.5 rounded-lg text-xs text-green-400 flex items-center space-x-1.5 cursor-pointer hover:bg-gray-700/60"
                                                  :title="(player.location || '') + (player.account_id ? ' #' + player.account_id : '')">
                                                <i class="fas fa-user text-[10px]"></i>
                                                <span x-text="player.name || player"></span>
                                            </span>
                                        </template>
                                    </div>
                                </div>
                                
                                <!-- No players -->
                                <div x-show="(!selectedInstance.players_by_team || (selectedInstance.players_by_team.legion.length === 0 && selectedInstance.players_by_team.hellbourne.length === 0)) && (!selectedInstance.players || selectedInstance.players.length === 0)" class="text-xs text-gray-500 italic bg-gray-800/30 rounded-lg px-3 py-2 text-center">
                                    <i class="fas fa-user-slash mr-1"></i><span x-text="t('noPlayersInMatch')"></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Performance Info -->
                        <div class="bg-gradient-to-br from-gray-700/80 to-gray-800/50 rounded-xl p-4 border border-gray-600/30">
                            <h4 class="text-sm font-semibold text-gray-400 mb-4 flex items-center">
                                <div class="w-6 h-6 bg-cyan-500/20 rounded-lg flex items-center justify-center mr-2">
                                    <i class="fas fa-tachometer-alt text-cyan-400 text-xs"></i>
                                </div>
                                Performance
                            </h4>
                            <div class="space-y-2.5 text-sm">
                                <div class="flex justify-between items-center bg-gray-800/30 rounded-lg px-3 py-2" x-show="selectedInstance.uptime">
                                    <span class="text-gray-400">Uptime:</span>
                                    <span class="text-white" x-text="formatUptime(selectedInstance.uptime)"></span>
                                </div>
                                <div class="flex justify-between" x-show="selectedInstance.memory_mb">
                                    <span class="text-gray-400">Memory:</span>
                                    <span x-text="selectedInstance.memory_mb + ' MB'"></span>
                                </div>
                                <div class="flex justify-between" x-show="selectedInstance.cpu_percent !== undefined">
                                    <span class="text-gray-400">CPU:</span>
                                    <span x-text="selectedInstance.cpu_percent + '%'"></span>
                                </div>
                                <div class="flex justify-between" x-show="selectedInstance.ping">
                                    <span class="text-gray-400">Ping:</span>
                                    <span x-text="selectedInstance.ping + ' ms'"></span>
                                </div>
                            </div>
                        </div>
                    
                    <!-- Modal Actions -->
                    <div class="flex flex-wrap gap-2 pt-4 border-t border-gray-600">
                        <button @click="startServer(selectedInstance.id); showInstanceModal = false" 
                                class="flex-1 min-w-[100px] bg-green-600 hover:bg-green-700 px-4 py-2 rounded transition-colors"
                                :disabled="selectedInstance.status === 'READY' || selectedInstance.status === 'OCCUPIED'">
                            <i class="fas fa-play mr-2"></i>Start
                        </button>
                        <button @click="stopServer(selectedInstance.id); showInstanceModal = false" 
                                class="flex-1 min-w-[100px] bg-red-600 hover:bg-red-700 px-4 py-2 rounded transition-colors">
                            <i class="fas fa-stop mr-2"></i>Stop
                        </button>
                        <button @click="restartServer(selectedInstance.id); showInstanceModal = false" 
                                class="flex-1 min-w-[100px] bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded transition-colors">
                            <i class="fas fa-redo mr-2"></i>Restart
                        </button>
                        
                        <button @click="deleteServer(selectedInstance.id); showInstanceModal = false" 
                                class="flex-1 min-w-[100px] bg-gray-600 hover:bg-red-700 px-4 py-2 rounded transition-colors">
                            <i class="fas fa-trash mr-2"></i>Delete
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Player List Modal -->
    <div x-show="showPlayerListModal" x-cloak
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
         @keydown.escape.window="showPlayerListModal = false">
        <div class="bg-gray-800 rounded-lg p-4 md:p-6 w-full max-w-4xl border border-gray-700 max-h-[90vh] overflow-hidden flex flex-col" 
             @click.away="showPlayerListModal = false">
            <!-- Modal Header -->
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-semibold">
                    <i class="fas fa-users mr-2 text-green-400"></i>All Players
                    <span class="text-sm font-normal text-gray-400 ml-2">(<span x-text="totalPlayers"></span> online)</span>
                </h3>
                <button @click="showPlayerListModal = false" 
                        class="text-gray-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <!-- Search -->
            <div class="mb-4">
                <input type="text" x-model="playerSearchQuery" 
                // Player Details Modal state
                showPlayerDetailsModal: false,
                selectedPlayer: null,
                       placeholder="Search players..."
                       class="w-full bg-gray-700 border border-gray-600 rounded px-4 py-2 focus:outline-none focus:border-green-500">
            </div>
            
            <!-- Player List -->
            <div class="flex-1 overflow-y-auto">
                <template x-for="instance in instances" :key="instance.id">
                    <div class="mb-4" x-show="instance.players && instance.players.length > 0 && (playerSearchQuery === '' || instance.players.some(p => (p.name || p).toLowerCase().includes(playerSearchQuery.toLowerCase())))">
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="w-3 h-3 rounded-full" :class="getStatusColor(instance.status)"></span>
                            <span class="font-semibold" x-text="'Server #' + instance.id"></span>
                            <span class="text-xs px-2 py-0.5 rounded bg-gray-700" x-text="instance.players?.length + ' players'"></span>
                            <span class="text-xs text-gray-400" x-text="'Port: ' + instance.port"></span>
                            <template x-if="instance.proxy_enabled && instance.public_port != instance.port">
                                <span class="text-xs text-purple-400" x-text="'โ’ Public: ' + instance.public_port"></span>
                            </template>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                            <template x-for="player in (instance.players || []).filter(p => playerSearchQuery === '' || (p.name || p).toLowerCase().includes(playerSearchQuery.toLowerCase()))" :key="player.name || player">
                                <div class="bg-gray-700 px-3 py-2 rounded text-sm flex items-center justify-between hover:bg-gray-600 transition-colors group">
                                    <div class="flex items-center space-x-2">
                                        <i class="fas fa-user text-xs text-green-400"></i>
                                        <span x-text="player.name || player" class="truncate font-medium"></span>
                                    </div>
                                    <div class="flex items-center space-x-2 text-xs text-gray-400">
                                        <span x-show="player.location" x-text="player.location" class="hidden group-hover:inline"></span>
                                        <span x-show="player.account_id" class="hidden group-hover:inline" x-text="'#' + player.account_id"></span>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </template>
                
                <!-- No Players -->
                <div x-show="totalPlayers === 0" class="text-center text-gray-500 py-8">
                    <i class="fas fa-users-slash text-4xl mb-2"></i>
                    <p>No players online</p>
                </div>
                
                <!-- No Search Results -->
                <div x-show="totalPlayers > 0 && playerSearchQuery !== '' && !instances.some(i => i.players && i.players.some(p => (p.name || p).toLowerCase().includes(playerSearchQuery.toLowerCase())))" 
                     class="text-center text-gray-500 py-8">
                    <i class="fas fa-search text-4xl mb-2"></i>
                    <p>No players found matching "<span x-text="playerSearchQuery"></span>"</p>
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="flex justify-between items-center pt-4 border-t border-gray-600 mt-4">
                <div class="text-sm text-gray-400">
                    <i class="fas fa-info-circle mr-1"></i>
                    <span x-text="instances.filter(i => i.players && i.players.length > 0).length"></span> servers with players
                </div>
                <button @click="showPlayerListModal = false" 
                        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Health Check Modal -->
    <div x-show="showHealthModal" x-cloak
         class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
         @keydown.escape.window="showHealthModal = false">
        <div class="bg-gray-800 rounded-lg p-4 md:p-6 w-full max-w-4xl border border-gray-700 max-h-[90vh] overflow-hidden flex flex-col" 
             @click.away="showHealthModal = false">
            <!-- Modal Header -->
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-semibold">
                    <i class="fas fa-heartbeat mr-2 text-red-400"></i>Server Health Check
                </h3>
                <div class="flex items-center space-x-2">
                    <button @click="runHealthCheck()" 
                            class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors"
                            :disabled="healthLoading">
                        <i class="fas fa-sync-alt mr-1" :class="healthLoading && 'animate-spin'"></i>Refresh
                    </button>
                    <button @click="showHealthModal = false" 
                            class="text-gray-400 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <!-- Overall Status -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                <div class="bg-gray-700 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold" :class="getHealthyCount() === instances.length ? 'text-green-400' : 'text-yellow-400'" x-text="getHealthyCount()"></div>
                    <div class="text-xs text-gray-400">Healthy</div>
                </div>
                <div class="bg-gray-700 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-yellow-400" x-text="getWarningCount()"></div>
                    <div class="text-xs text-gray-400">Warning</div>
                </div>
                <div class="bg-gray-700 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-red-400" x-text="getCriticalCount()"></div>
                    <div class="text-xs text-gray-400">Critical</div>
                </div>
                <div class="bg-gray-700 rounded-lg p-3 text-center">
                    <div class="text-2xl font-bold text-gray-400" x-text="instances.length"></div>
                    <div class="text-xs text-gray-400">Total</div>
                </div>
            </div>
            
            <!-- Server Health List -->
            <div class="flex-1 overflow-y-auto space-y-3">
                <template x-for="instance in instances" :key="instance.id">
                    <div class="bg-gray-700 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center space-x-3">
                                <span class="w-3 h-3 rounded-full" :class="getHealthColor(instance)"></span>
                                <span class="font-semibold" x-text="'Server #' + instance.id"></span>
                                <span class="text-xs px-2 py-0.5 rounded" 
                                      :class="getStatusBadgeClass(instance.status)"
                                      x-text="instance.status"></span>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs px-2 py-1 rounded" :class="getHealthBadge(instance)">
                                    <i class="fas" :class="getHealthIcon(instance)"></i>
                                    <span x-text="getHealthStatus(instance)"></span>
                                </span>
                            </div>
                        </div>
                        
                        <!-- Health Metrics -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                            <!-- Uptime -->
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-clock text-gray-400"></i>
                                <div>
                                    <div class="text-gray-400 text-xs">Uptime</div>
                                    <div x-text="formatUptime(instance.uptime) || 'N/A'"></div>
                                </div>
                            </div>
                            
                            <!-- Players -->
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-users text-gray-400"></i>
                                <div>
                                    <div class="text-gray-400 text-xs">Players</div>
                                    <div><span x-text="instance.num_clients"></span>/<span x-text="instance.max_clients"></span></div>
                                </div>
                            </div>
                            
                            <!-- Memory -->
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-memory text-gray-400"></i>
                                <div>
                                    <div class="text-gray-400 text-xs">Memory</div>
                                    <div x-text="instance.memory_mb ? instance.memory_mb + ' MB' : 'N/A'"></div>
                                </div>
                            </div>
                            
                            <!-- Port -->
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-plug text-gray-400"></i>
                                <div>
                                    <div class="text-gray-400 text-xs">Local Port</div>
                                    <div x-text="instance.port"></div>
                                </div>
                            </div>
                            
                            <!-- Public Port (when proxy enabled) -->
                            <div class="flex items-center space-x-2" x-show="instance.proxy_enabled">
                                <i class="fas fa-shield-alt text-purple-400"></i>
                                <div>
                                    <div class="text-purple-400 text-xs">Public Port</div>
                                    <div class="text-purple-300" x-text="instance.public_port"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Health Issues -->
                        <div class="mt-3 space-y-1" x-show="getHealthIssues(instance).length > 0">
                            <template x-for="issue in getHealthIssues(instance)" :key="issue">
                                <div class="text-xs px-2 py-1 rounded bg-gray-800 flex items-center space-x-2"
                                     :class="issue.includes('Critical') ? 'text-red-400' : 'text-yellow-400'">
                                    <i class="fas" :class="issue.includes('Critical') ? 'fa-exclamation-circle' : 'fa-exclamation-triangle'"></i>
                                    <span x-text="issue"></span>
                                </div>
                            </template>
                        </div>
                        
                        <!-- Quick Actions -->
                        <div class="flex space-x-2 mt-3 pt-3 border-t border-gray-600">
                            <button @click="restartServer(instance.id)" 
                                    class="text-xs bg-yellow-600 hover:bg-yellow-700 px-3 py-1 rounded transition-colors">
                                <i class="fas fa-redo mr-1"></i>Restart
                            </button>
                            <button @click="showHealthModal = false; showInstanceDetails(instance)" 
                                    class="text-xs bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded transition-colors">
                                <i class="fas fa-info-circle mr-1"></i>Details
                            </button>
                        </div>
                    </div>
                </template>
                
                <!-- No Servers -->
                <div x-show="instances.length === 0" class="text-center text-gray-500 py-8">
                    <i class="fas fa-server text-4xl mb-2"></i>
                    <p>No servers to check</p>
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="flex justify-between items-center pt-4 border-t border-gray-600 mt-4">
                <div class="text-sm text-gray-400">
                    <i class="fas fa-info-circle mr-1"></i>
                    Last checked: <span x-text="new Date().toLocaleTimeString()"></span>
                </div>
                <button @click="showHealthModal = false" 
                        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded transition-colors">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications - Improved -->
    <div class="fixed bottom-4 right-4 space-y-3 z-50 max-w-sm">
        <template x-for="toast in toasts" :key="toast.id">
            <div class="glass-card px-4 py-3 rounded-xl shadow-2xl flex items-start space-x-3 border animate-slideInRight"
                 :class="{
                     'border-green-500/30 toast-success': toast.type === 'success',
                     'border-red-500/30 toast-error': toast.type === 'error',
                     'border-yellow-500/30 toast-warning': toast.type === 'warning',
                     'border-blue-500/30 toast-info': toast.type === 'info'
                 }"
                 x-show="toast.show"
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 transform translate-x-full"
                 x-transition:enter-end="opacity-100 transform translate-x-0"
                 x-transition:leave="transition ease-in duration-200"
                 x-transition:leave-start="opacity-100"
                 x-transition:leave-end="opacity-0">
                <div class="flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center"
                     :class="{
                         'bg-green-500/20 text-green-400': toast.type === 'success',
                         'bg-red-500/20 text-red-400': toast.type === 'error',
                         'bg-yellow-500/20 text-yellow-400': toast.type === 'warning',
                         'bg-blue-500/20 text-blue-400': toast.type === 'info'
                     }">
                    <i class="fas" :class="{
                        'fa-check': toast.type === 'success',
                        'fa-times': toast.type === 'error',
                        'fa-exclamation': toast.type === 'warning',
                        'fa-info': toast.type === 'info'
                    }"></i>
                </div>
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium text-white" x-text="toast.message"></p>
                </div>
                <button @click="toast.show = false" class="flex-shrink-0 text-gray-500 hover:text-white transition-colors">
                    <i class="fas fa-times text-xs"></i>
                </button>
            </div>
        </template>
    </div>

    <!-- Floating Action Button (FAB) for Quick Actions -->
    <div class="fixed bottom-20 right-4 z-40" x-data="{ fabOpen: false }">
        <!-- FAB Menu -->
        <div x-show="fabOpen" x-cloak
             x-transition:enter="transition ease-out duration-200"
             x-transition:enter-start="opacity-0 transform scale-90"
             x-transition:enter-end="opacity-100 transform scale-100"
             x-transition:leave="transition ease-in duration-150"
             x-transition:leave-start="opacity-100 transform scale-100"
             x-transition:leave-end="opacity-0 transform scale-90"
             class="absolute bottom-16 right-0 space-y-2 mb-2">
            <button @click="showAddServerModal = true; addServerCount = 1; fabOpen = false"
                    class="flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 px-4 py-2.5 rounded-full shadow-lg shadow-blue-600/30 transition-all hover:scale-105 whitespace-nowrap">
                <i class="fas fa-plus"></i>
                <span class="text-sm font-medium">Add Server</span>
            </button>
            <button @click="startupAll(); fabOpen = false"
                    class="flex items-center space-x-2 bg-green-600 hover:bg-green-700 px-4 py-2.5 rounded-full shadow-lg shadow-green-600/30 transition-all hover:scale-105 whitespace-nowrap">
                <i class="fas fa-play"></i>
                <span class="text-sm font-medium">Start All</span>
            </button>
            <button @click="shutdownAll(); fabOpen = false"
                    class="flex items-center space-x-2 bg-red-600 hover:bg-red-700 px-4 py-2.5 rounded-full shadow-lg shadow-red-600/30 transition-all hover:scale-105 whitespace-nowrap">
                <i class="fas fa-stop"></i>
                <span class="text-sm font-medium">Stop All</span>
            </button>
            <button @click="refresh(); fabOpen = false"
                    class="flex items-center space-x-2 bg-gray-600 hover:bg-gray-700 px-4 py-2.5 rounded-full shadow-lg transition-all hover:scale-105 whitespace-nowrap">
                <i class="fas fa-sync-alt"></i>
                <span class="text-sm font-medium">Refresh</span>
            </button>
        </div>
        
        <!-- FAB Button -->
        <button @click="fabOpen = !fabOpen"
                class="w-14 h-14 bg-gradient-to-br from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 rounded-full shadow-lg shadow-purple-600/30 flex items-center justify-center transition-all hover:scale-110"
                :class="fabOpen ? 'rotate-45' : ''">
            <i class="fas fa-plus text-xl transition-transform" :class="fabOpen ? 'rotate-90' : ''"></i>
        </button>
    </div>

    <!-- Player Details Modal -->
    <div x-show="showPlayerDetailsModal" x-cloak
         class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"
         @keydown.escape.window="showPlayerDetailsModal = false"
         x-transition>
        <div class="glass-card rounded-2xl p-6 w-full max-w-md border border-gray-700/50 shadow-2xl"
             @click.away="showPlayerDetailsModal = false">
            <template x-if="selectedPlayer">
                <div>
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-blue-600 rounded-xl flex items-center justify-center">
                                <i class="fas fa-user text-white text-lg"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-white" x-text="selectedPlayer.name"></h3>
                                <p class="text-xs text-gray-400" x-text="'Account ID: ' + selectedPlayer.account_id"></p>
                            </div>
                        </div>
                        <button @click="showPlayerDetailsModal = false" class="text-gray-400 hover:text-white p-2 hover:bg-gray-700/50 rounded-lg transition-all">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Player Info -->
                    <div class="space-y-3">
                        <!-- IP Address -->
                        <div class="flex justify-between items-center bg-gray-800/50 rounded-lg px-4 py-3">
                            <span class="text-gray-400 text-sm"><i class="fas fa-globe mr-2"></i>IP Address</span>
                            <span class="font-mono text-white text-sm" x-text="selectedPlayer.ip || 'N/A'"></span>
                        </div>

                        <!-- Location -->
                        <div class="flex justify-between items-center bg-gray-800/50 rounded-lg px-4 py-3">
                            <span class="text-gray-400 text-sm"><i class="fas fa-map-marker-alt mr-2"></i>Location</span>
                            <span class="text-white text-sm" x-text="selectedPlayer.location || 'Unknown'"></span>
                        </div>

                        <!-- Ping Stats -->
                        <div class="bg-gray-800/50 rounded-lg px-4 py-3">
                            <div class="text-gray-400 text-sm mb-2"><i class="fas fa-signal mr-2"></i>Ping Statistics</div>
                            <div class="grid grid-cols-3 gap-2">
                                <div class="text-center">
                                    <div class="text-green-400 text-lg font-bold" x-text="(selectedPlayer.minping || 0) + ' ms'"></div>
                                    <div class="text-xs text-gray-500">Min</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-yellow-400 text-lg font-bold" x-text="(selectedPlayer.avgping || 0) + ' ms'"></div>
                                    <div class="text-xs text-gray-500">Avg</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-red-400 text-lg font-bold" x-text="(selectedPlayer.maxping || 0) + ' ms'"></div>
                                    <div class="text-xs text-gray-500">Max</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Close Button -->
                    <div class="mt-4 pt-4 border-t border-gray-700/50">
                        <button @click="showPlayerDetailsModal = false" class="w-full bg-gray-700 hover:bg-gray-600 text-white py-2.5 rounded-lg transition-all">
                            Close
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Keyboard Shortcuts Help Modal -->
    <div x-show="showShortcutsModal" x-cloak
         class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4"
         @keydown.escape.window="showShortcutsModal = false"
         x-transition>
        <div class="glass-card rounded-2xl p-6 w-full max-w-md border border-gray-700/50 shadow-2xl"
             @click.away="showShortcutsModal = false">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <div class="w-10 h-10 bg-blue-500/20 rounded-xl flex items-center justify-center mr-3">
                    <i class="fas fa-keyboard text-blue-400"></i>
                </div>
                Keyboard Shortcuts
            </h3>
            <div class="space-y-3">
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Refresh Dashboard</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">R</kbd>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Go to Console</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">1</kbd>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Go to Servers</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">2</kbd>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Go to Config</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">3</kbd>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Go to System</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">4</kbd>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Add Server</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">A</kbd>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-gray-700/50">
                    <span class="text-gray-400">Show Shortcuts</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">?</kbd>
                </div>
                <div class="flex justify-between items-center py-2">
                    <span class="text-gray-400">Toggle Auto Refresh</span>
                    <kbd class="px-2 py-1 bg-gray-800 rounded text-xs font-mono">Space</kbd>
                </div>
            </div>
            <button @click="showShortcutsModal = false"
                    class="w-full mt-4 px-4 py-2.5 bg-gray-700 hover:bg-gray-600 rounded-xl transition-colors">
                Close
            </button>
        </div>
    </div>

    <script>
        // Auth check - redirect to login if not authenticated
        (function() {
            const token = localStorage.getItem('authToken') || sessionStorage.getItem('authToken');
            if (!token) {
                window.location.href = '/login.html';
                return;
            }
            // Store token globally for API calls
            window.authToken = token;
            window.authUser = localStorage.getItem('authUser') || sessionStorage.getItem('authUser');
        })();
    </script>
    <script>
        function dashboard() {
            return {
                loading: false,
                autoRefresh: true,
                refreshInterval: null,
                serverName: 'Loading...',
                activeTab: 'console',
                sidebarOpen: false,
                // Language settings
                currentLang: localStorage.getItem('dashboard_lang') || 'en',
                translations: {
                    en: {
                        // Header
                        autoRefresh: 'Auto Refresh',
                        refresh: 'Refresh',
                        logout: 'Logout',
                        // Sidebar
                        console: 'Console',
                        servers: 'Servers',
                        config: 'Config',
                        system: 'System',
                        logs: 'Logs',
                        replays: 'Replays',
                        masterServer: 'MasterServer',
                        chatServer: 'ChatServer',
                        players: 'Players',
                        healthCheck: 'Health Check',
                        // Server Manager
                        serverManager: 'Server Manager',
                        runningServers: 'Running Servers',
                        targetServers: 'Target Servers',
                        applyChanges: 'Apply Changes',
                        quickScale: 'Quick Scale',
                        startAll: 'Start All',
                        shutdownAll: 'Shutdown All',
                        restartAll: 'Restart All',
                        addServer: 'Add Server',
                        deleteAll: 'Delete All',
                        broadcastMessage: 'Broadcast Message',
                        // Instances
                        gameInstances: 'Game Instances',
                        search: 'Search...',
                        allStatus: 'All Status',
                        ready: 'Ready',
                        occupied: 'Occupied',
                        idle: 'Idle',
                        starting: 'Starting',
                        crashed: 'Crashed',
                        sortById: 'Sort by ID',
                        sortByPort: 'Sort by Port',
                        sortByStatus: 'Sort by Status',
                        sortByPlayers: 'Sort by Players',
                        sortByUptime: 'Sort by Uptime',
                        noInstances: 'No game instances found',
                        noMatchFilter: 'No instances match your filter',
                        clearFilters: 'Clear filters',
                        port: 'Port',
                        phase: 'Phase',
                        match: 'Match',
                        uptime: 'Uptime',
                        playersInMatch: 'Players in match',
                        legion: 'Legion',
                        hellbourne: 'Hellbourne',
                        spectators: 'Spectators',
                        actions: 'Actions',
                        // Config
                        configuration: 'Configuration',
                        saveConfiguration: 'Save Configuration',
                        // Modals
                        addNewServers: 'Add New Servers',
                        numberOfServersToAdd: 'Number of Servers to Add',
                        quickSelect: 'Quick Select',
                        cancel: 'Cancel',
                        deleteServers: 'Delete Servers',
                        deleteMode: 'Delete Mode',
                        byCount: 'By Count',
                        numberOfServersToDelete: 'Number of Servers to Delete',
                        warning: 'Warning!',
                        deleteAllWarning: 'This will delete ALL servers. This action cannot be undone!',
                        broadcastToAll: 'Broadcast Message to All Servers',
                        messageType: 'Message Type',
                        normal: 'Normal',
                        announcement: 'Announcement',
                        system: 'System',
                        enterMessage: 'Enter message...',
                        broadcast: 'Broadcast',
                        // System
                        systemStatus: 'System Status',
                        info: 'Info',
                        graphs: 'Graphs',
                        cpu: 'CPU',
                        memory: 'Memory',
                        disk: 'Disk',
                        network: 'Network',
                        cores: 'cores',
                        // Common
                        enabled: 'Enabled',
                        disabled: 'Disabled',
                        start: 'Start',
                        stop: 'Stop',
                        restart: 'Restart',
                        delete: 'Delete',
                        close: 'Close',
                        details: 'Details',
                        send: 'Send',
                        message: 'Message',
                        current: 'Current',
                        after: 'After',
                        language: 'Language',
                        // Additional keys
                        saveConfig: 'Save Configuration',
                        server: 'Server',
                        serverLogs: 'Server Logs',
                        managerLog: 'Manager Log',
                        download: 'Download',
                        loadingLogs: 'Loading logs...',
                        noLogs: 'No logs available',
                        replayManager: 'Replay Manager',
                        total: 'Total',
                        cleanOld: 'Clean Old',
                        deleteOldReplays: 'Delete Old Replays',
                        deleteReplaysOlderThan: 'Delete replays older than:',
                        days: 'days',
                        noReplayFound: 'No replay found',
                        noReplays: 'No replays found',
                        sendMessage: 'Send Message to Server',
                        willAdd: 'This will add',
                        newServers: 'new server(s)',
                        add: 'Add',
                        willDelete: 'This will delete',
                        deleteAllServers: 'Delete All Servers',
                        broadcastInfo: 'This will send a message to all',
                        id: 'ID',
                        status: 'Status',
                        // Instance Details
                        connectionInfo: 'Connection Info',
                        serverId: 'Server ID',
                        region: 'Region',
                        gameInfo: 'Game Info',
                        duration: 'Duration',
                        noPlayersInMatch: 'No players in this match',
                        // Console
                        noLogsConsole: 'No logs available. Click refresh or type a command.',
                        typeCommand: 'Type command...',
                        // Game Chat
                        gameChat: 'Game Chat',
                        noChatMessages: 'No chat messages',
                        // Statistics
                        statistics: 'Statistics',
                        totalMatches: 'Total Matches',
                        totalPlayers: 'Unique Players',
                        avgDuration: 'Avg Duration',
                        matchesToday: 'Today',
                        recentMatches: 'Recent Matches',
                        topPlayers: 'Top Players',
                        dailyStats: 'Daily Statistics',
                        noMatches: 'No matches recorded yet',
                        noPlayers: 'No player statistics yet',
                        // Auto-scaling
                        autoScaling: 'Auto-scaling',
                        autoScalingStatus: 'Auto-scaling Status',
                        serverCapacity: 'Server Capacity',
                        occupancyRate: 'Occupancy Rate',
                        readyServers: 'Ready Servers',
                        scaleUpThreshold: 'Scale Up Threshold',
                        scaleDownThreshold: 'Scale Down Threshold',
                        lastAction: 'Last Action',
                        cooldown: 'Cooldown',
                        scaleUp: 'Scale Up',
                        scaleDown: 'Scale Down'
                    },
                    th: {
                        // Header
                        autoRefresh: 'เธฃเธตเน€เธเธฃเธเธญเธฑเธ•เนเธเธกเธฑเธ•เธด',
                        refresh: 'เธฃเธตเน€เธเธฃเธ',
                        logout: 'เธญเธญเธเธเธฒเธเธฃเธฐเธเธ',
                        // Sidebar
                        console: 'เธเธญเธเนเธเธฅ',
                        servers: 'เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        config: 'เธเธฒเธฃเธ•เธฑเนเธเธเนเธฒ',
                        system: 'เธฃเธฐเธเธ',
                        logs: 'เธฅเนเธญเธ',
                        replays: 'เธฃเธตเน€เธเธฅเธขเน',
                        masterServer: 'เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธซเธฅเธฑเธ',
                        chatServer: 'เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธเธ—',
                        players: 'เธเธนเนเน€เธฅเนเธ',
                        healthCheck: 'เธ•เธฃเธงเธเธชเธญเธเธชเธธเธเธ เธฒเธ',
                        // Server Manager
                        serverManager: 'เธเธฑเธ”เธเธฒเธฃเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        runningServers: 'เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธ—เธตเนเธ—เธณเธเธฒเธ',
                        targetServers: 'เน€เธเนเธฒเธซเธกเธฒเธข',
                        applyChanges: 'เนเธเนเธเธฒเธฃเน€เธเธฅเธตเนเธขเธเนเธเธฅเธ',
                        quickScale: 'เธเธฃเธฑเธเธเธเธฒเธ”เธ”เนเธงเธ',
                        startAll: 'เน€เธฃเธดเนเธกเธ—เธฑเนเธเธซเธกเธ”',
                        shutdownAll: 'เธเธดเธ”เธ—เธฑเนเธเธซเธกเธ”',
                        restartAll: 'เธฃเธตเธชเธ•เธฒเธฃเนเธ—เธ—เธฑเนเธเธซเธกเธ”',
                        addServer: 'เน€เธเธดเนเธกเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        deleteAll: 'เธฅเธเธ—เธฑเนเธเธซเธกเธ”',
                        broadcastMessage: 'เธชเนเธเธเนเธญเธเธงเธฒเธก',
                        // Instances
                        gameInstances: 'เน€เธเธกเธญเธดเธเธชเนเธ•เธเธเน',
                        search: 'เธเนเธเธซเธฒ...',
                        allStatus: 'เธ—เธธเธเธชเธ–เธฒเธเธฐ',
                        ready: 'เธเธฃเนเธญเธก',
                        occupied: 'เธเธณเธฅเธฑเธเนเธเนเธเธฒเธ',
                        idle: 'เธงเนเธฒเธ',
                        starting: 'เธเธณเธฅเธฑเธเน€เธฃเธดเนเธก',
                        crashed: 'เธฅเนเธก',
                        sortById: 'เน€เธฃเธตเธขเธเธ•เธฒเธก ID',
                        sortByPort: 'เน€เธฃเธตเธขเธเธ•เธฒเธก Port',
                        sortByStatus: 'เน€เธฃเธตเธขเธเธ•เธฒเธกเธชเธ–เธฒเธเธฐ',
                        sortByPlayers: 'เน€เธฃเธตเธขเธเธ•เธฒเธกเธเธนเนเน€เธฅเนเธ',
                        sortByUptime: 'เน€เธฃเธตเธขเธเธ•เธฒเธกเน€เธงเธฅเธฒเธ—เธณเธเธฒเธ',
                        noInstances: 'เนเธกเนเธเธเน€เธเธกเธญเธดเธเธชเนเธ•เธเธเน',
                        noMatchFilter: 'เนเธกเนเธกเธตเธญเธดเธเธชเนเธ•เธเธเนเธ•เธฃเธเธ•เธฒเธกเธ•เธฑเธงเธเธฃเธญเธ',
                        clearFilters: 'เธฅเนเธฒเธเธ•เธฑเธงเธเธฃเธญเธ',
                        port: 'เธเธญเธฃเนเธ•',
                        phase: 'เน€เธเธช',
                        match: 'เนเธกเธ•เธเน',
                        uptime: 'เน€เธงเธฅเธฒเธ—เธณเธเธฒเธ',
                        playersInMatch: 'เธเธนเนเน€เธฅเนเธเนเธเนเธกเธ•เธเน',
                        legion: 'เธฅเธตเน€เธเธตเธขเธ',
                        hellbourne: 'เน€เธฎเธฅเธเธญเธฃเนเธ',
                        spectators: 'เธเธนเนเธเธก',
                        actions: 'เธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃ',
                        // Config
                        configuration: 'เธเธฒเธฃเธ•เธฑเนเธเธเนเธฒ',
                        saveConfiguration: 'เธเธฑเธเธ—เธถเธเธเธฒเธฃเธ•เธฑเนเธเธเนเธฒ',
                        // Modals
                        addNewServers: 'เน€เธเธดเนเธกเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธซเธกเน',
                        numberOfServersToAdd: 'เธเธณเธเธงเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธ—เธตเนเธ•เนเธญเธเธเธฒเธฃเน€เธเธดเนเธก',
                        quickSelect: 'เน€เธฅเธทเธญเธเธ”เนเธงเธ',
                        cancel: 'เธขเธเน€เธฅเธดเธ',
                        deleteServers: 'เธฅเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        deleteMode: 'เนเธซเธกเธ”เธเธฒเธฃเธฅเธ',
                        byCount: 'เธ•เธฒเธกเธเธณเธเธงเธ',
                        numberOfServersToDelete: 'เธเธณเธเธงเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธ—เธตเนเธ•เนเธญเธเธเธฒเธฃเธฅเธ',
                        warning: 'เธเธณเน€เธ•เธทเธญเธ!',
                        deleteAllWarning: 'เธเธฒเธฃเธ”เธณเน€เธเธดเธเธเธฒเธฃเธเธตเนเธเธฐเธฅเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธ—เธฑเนเธเธซเธกเธ” เนเธกเนเธชเธฒเธกเธฒเธฃเธ–เธขเธเน€เธฅเธดเธเนเธ”เน!',
                        broadcastToAll: 'เธชเนเธเธเนเธญเธเธงเธฒเธกเนเธเธขเธฑเธเธ—เธธเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        messageType: 'เธเธฃเธฐเน€เธ เธ—เธเนเธญเธเธงเธฒเธก',
                        normal: 'เธเธเธ•เธด',
                        announcement: 'เธเธฃเธฐเธเธฒเธจ',
                        system: 'เธฃเธฐเธเธ',
                        enterMessage: 'เธเธดเธกเธเนเธเนเธญเธเธงเธฒเธก...',
                        broadcast: 'เธชเนเธเธเนเธญเธเธงเธฒเธก',
                        // System
                        systemStatus: 'เธชเธ–เธฒเธเธฐเธฃเธฐเธเธ',
                        info: 'เธเนเธญเธกเธนเธฅ',
                        graphs: 'เธเธฃเธฒเธ',
                        cpu: 'เธเธตเธเธตเธขเธน',
                        memory: 'เธซเธเนเธงเธขเธเธงเธฒเธกเธเธณ',
                        disk: 'เธ”เธดเธชเธเน',
                        network: 'เน€เธเธฃเธทเธญเธเนเธฒเธข',
                        cores: 'เธเธญเธฃเน',
                        // Common
                        enabled: 'เน€เธเธดเธ”เนเธเนเธเธฒเธ',
                        disabled: 'เธเธดเธ”เนเธเนเธเธฒเธ',
                        start: 'เน€เธฃเธดเนเธก',
                        stop: 'เธซเธขเธธเธ”',
                        restart: 'เธฃเธตเธชเธ•เธฒเธฃเนเธ—',
                        delete: 'เธฅเธ',
                        close: 'เธเธดเธ”',
                        details: 'เธฃเธฒเธขเธฅเธฐเน€เธญเธตเธขเธ”',
                        send: 'เธชเนเธ',
                        message: 'เธเนเธญเธเธงเธฒเธก',
                        current: 'เธเธฑเธเธเธธเธเธฑเธ',
                        after: 'เธซเธฅเธฑเธเธเธฒเธ',
                        language: 'เธ เธฒเธฉเธฒ',
                        // Additional keys
                        saveConfig: 'เธเธฑเธเธ—เธถเธเธเธฒเธฃเธ•เธฑเนเธเธเนเธฒ',
                        server: 'เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        serverLogs: 'เธฅเนเธญเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        managerLog: 'เธฅเนเธญเธเธ•เธฑเธงเธเธฑเธ”เธเธฒเธฃ',
                        download: 'เธ”เธฒเธงเธเนเนเธซเธฅเธ”',
                        loadingLogs: 'เธเธณเธฅเธฑเธเนเธซเธฅเธ”เธฅเนเธญเธ...',
                        noLogs: 'เนเธกเนเธกเธตเธฅเนเธญเธ',
                        replayManager: 'เธเธฑเธ”เธเธฒเธฃเธฃเธตเน€เธเธฅเธขเน',
                        total: 'เธ—เธฑเนเธเธซเธกเธ”',
                        cleanOld: 'เธฅเธเนเธเธฅเนเน€เธเนเธฒ',
                        deleteOldReplays: 'เธฅเธเธฃเธตเน€เธเธฅเธขเนเน€เธเนเธฒ',
                        deleteReplaysOlderThan: 'เธฅเธเธฃเธตเน€เธเธฅเธขเนเธ—เธตเนเน€เธเนเธฒเธเธงเนเธฒ:',
                        days: 'เธงเธฑเธ',
                        noReplayFound: 'เนเธกเนเธเธเธฃเธตเน€เธเธฅเธขเนเธ—เธตเนเธเนเธเธซเธฒ',
                        noReplays: 'เนเธกเนเธกเธตเธฃเธตเน€เธเธฅเธขเน',
                        sendMessage: 'เธชเนเธเธเนเธญเธเธงเธฒเธกเนเธเธขเธฑเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        willAdd: 'เธเธฐเน€เธเธดเนเธก',
                        newServers: 'เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเนเธซเธกเน',
                        add: 'เน€เธเธดเนเธก',
                        willDelete: 'เธเธฐเธฅเธ',
                        deleteAllServers: 'เธฅเธเน€เธเธดเธฃเนเธเน€เธงเธญเธฃเนเธ—เธฑเนเธเธซเธกเธ”',
                        broadcastInfo: 'เธเนเธญเธเธงเธฒเธกเธเธตเนเธเธฐเธ–เธนเธเธชเนเธเนเธเธขเธฑเธเธ—เธธเธ',
                        replays: 'เธฃเธตเน€เธเธฅเธขเน',
                        id: 'ID',
                        status: 'เธชเธ–เธฒเธเธฐ',
                        // Instance Details
                        connectionInfo: 'เธเนเธญเธกเธนเธฅเธเธฒเธฃเน€เธเธทเนเธญเธกเธ•เนเธญ',
                        serverId: 'ID เน€เธเธดเธฃเนเธเน€เธงเธญเธฃเน',
                        region: 'เธ เธนเธกเธดเธ เธฒเธ',
                        gameInfo: 'เธเนเธญเธกเธนเธฅเน€เธเธก',
                        duration: 'เธฃเธฐเธขเธฐเน€เธงเธฅเธฒ',
                        noPlayersInMatch: 'เนเธกเนเธกเธตเธเธนเนเน€เธฅเนเธเนเธเนเธกเธ•เธเนเธเธตเน',
                        // Console
                        noLogsConsole: 'เนเธกเนเธกเธตเธฅเนเธญเธ เธเธ”เธฃเธตเน€เธเธฃเธเธซเธฃเธทเธญเธเธดเธกเธเนเธเธณเธชเธฑเนเธ',
                        typeCommand: 'เธเธดเธกเธเนเธเธณเธชเธฑเนเธ...',
                        // Game Chat
                        gameChat: 'เนเธเธ—เนเธเน€เธเธก',
                        noChatMessages: 'เนเธกเนเธกเธตเธเนเธญเธเธงเธฒเธกเนเธเธ—'
                    }
                },
                status: {
                    master_server_connected: false,
                    chat_server_connected: false
                },
                config: {
                    svr_starting_gamePort: { value: 10001, editable: true },
                    svr_maxClients: { value: 10, editable: true },
                    svr_name: { value: '', editable: true },
                    svr_total: { value: 4, editable: true }
                },
                instances: [],
                showConfig: false,
                showConsole: true,
                showMessageModal: false,
                showBroadcastModal: false,
                showAddServerModal: false,
                addServerCount: 1,
                showDeleteServerModal: false,
                deleteServerCount: 1,
                deleteMode: 'count',
                showShortcutsModal: false,
                // UI/UX state
                instanceSearch: '',
                instanceFilter: 'all',
                instanceSort: 'id',
                instanceSortAsc: true,
                instanceViewMode: 'grid',
                // Config UI state
                configSearch: '',
                configViewMode: 'grouped',
                
                // Translation helper function
                t(key) {
                    return this.translations[this.currentLang]?.[key] || this.translations['en'][key] || key;
                },
                
                setLanguage(lang) {
                    this.currentLang = lang;
                    localStorage.setItem('dashboard_lang', lang);
                    document.documentElement.lang = lang;
                },
                
                messageTargetId: null,
                messageText: '',
                messageType: 'normal',
                broadcastText: '',
                broadcastType: 'normal',
                targetServers: 2,
                toasts: [],
                // Console state
                consoleLogs: [],
                commandInput: '',
                commandHistory: [],
                commandHistoryIndex: -1,
                logsLoading: false,
                autoScrollLogs: true,
                // System state
                systemView: 'info',  // 'info' or 'graphs'
                systemStatus: {
                    cpu_percent: 0,
                    memory_percent: 0,
                    memory_used: 0,
                    memory_total: 0,
                    disk_percent: 0,
                    disk_used: 0,
                    disk_total: 0,
                    network_sent: 0,
                    network_recv: 0,
                    boot_time: '',
                    uptime: '',
                    python_version: '',
                    os_info: '',
                    process_count: 0,
                    cpu_count: 0,
                    cpu_freq: 0
                },
                systemLoading: false,
                // Auth state
                authUser: null,
                // Charts state
                charts: {},
                chartData: {
                    cpu: [],
                    memory: [],
                    networkSent: [],
                    networkRecv: [],
                    players: [],
                    labels: []
                },
                chartUpdateCount: 0,
                maxChartPoints: 60,
                // Logs state
                selectedLogServer: 'manager',
                serverLogs: [],
                serverLogsLoading: false,
                // Replays state
                replays: [],
                replaysLoading: false,
                replaysTotalSize: '0 MB',
                replaySearchQuery: '',
                showDeleteOldReplaysModal: false,
                deleteReplaysOlderThan: 30,
                // Notifications state
                notifications: [],
                notificationId: 0,
                // Instance Details Modal state
                showInstanceModal: false,
                selectedInstance: null,
                // Player List Modal state
                showPlayerListModal: false,
                playerSearchQuery: '',
                // Player Details Modal state
                showPlayerDetailsModal: false,
                selectedPlayer: null,
                // Health Check state
                showHealthModal: false,
                healthData: [],
                healthLoading: false,
                // Statistics state
                statistics: {
                    summary: null,
                    recentMatches: [],
                    topPlayers: [],
                    dailyStats: []
                },
                statisticsLoading: false,
                dailyStatsChart: null,
                // Auto-scaling state
                scaling: {
                    enabled: false,
                    totalServers: 0,
                    occupiedServers: 0,
                    readyServers: 0,
                    occupancyRate: 0,
                    minServers: 1,
                    maxServers: 10,
                    scaleUpThreshold: 80,
                    scaleDownThreshold: 20,
                    lastScaleAction: 'None',
                    inCooldown: false,
                    cooldownRemainingSeconds: 0
                },
                scalingLoading: false,
                
                async init() {
                    await this.checkAuth();
                    await this.refresh();
                    await this.refreshLogs();
                    await this.refreshSystemStatus();
                    this.startAutoRefresh();
                    // Setup WebSocket for real-time updates
                    this.setupWebSocket();
                    // Setup keyboard shortcuts
                    this.setupKeyboardShortcuts();
                },

                setupKeyboardShortcuts() {
                    document.addEventListener('keydown', (e) => {
                        // Skip if user is typing in an input
                        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.isContentEditable) {
                            return;
                        }
                        
                        // Skip if any modal is open (except shortcuts modal)
                        if (this.showMessageModal || this.showBroadcastModal || this.showAddServerModal || 
                            this.showDeleteServerModal || this.selectedInstance || this.showHealthModal) {
                            if (e.key === 'Escape') {
                                this.showMessageModal = false;
                                this.showBroadcastModal = false;
                                this.showAddServerModal = false;
                                this.showDeleteServerModal = false;
                                this.selectedInstance = null;
                                this.showHealthModal = false;
                                this.showShortcutsModal = false;
                            }
                            return;
                        }
                        
                        switch(e.key.toLowerCase()) {
                            case 'r':
                                e.preventDefault();
                                this.refresh();
                                this.showToast('Refreshing...', 'info');
                                break;
                            case '1':
                                e.preventDefault();
                                this.activeTab = 'console';
                                break;
                            case '2':
                                e.preventDefault();
                                this.activeTab = 'servers';
                                break;
                            case '3':
                                e.preventDefault();
                                this.activeTab = 'config';
                                break;
                            case '4':
                                e.preventDefault();
                                this.activeTab = 'system';
                                break;
                            case '5':
                                e.preventDefault();
                                this.activeTab = 'logs';
                                break;
                            case '6':
                                e.preventDefault();
                                this.activeTab = 'replays';
                                break;
                            case 'a':
                                e.preventDefault();
                                this.showAddServerModal = true;
                                this.addServerCount = 1;
                                break;
                            case '?':
                                e.preventDefault();
                                this.showShortcutsModal = !this.showShortcutsModal;
                                break;
                            case ' ':
                                e.preventDefault();
                                this.toggleAutoRefresh();
                                this.showToast(this.autoRefresh ? 'Auto refresh ON' : 'Auto refresh OFF', 'info');
                                break;
                        }
                    });
                },

                async checkAuth() {
                    try {
                        const response = await fetch('/api/auth/status');
                        const data = await response.json();
                        if (data.authenticated) {
                            this.authUser = data.user;
                        }
                    } catch (error) {
                        console.log('Auth check failed:', error);
                    }
                },
                
                startAutoRefresh() {
                    if (this.refreshInterval) clearInterval(this.refreshInterval);
                    if (this.autoRefresh) {
                        this.refreshInterval = setInterval(() => this.refresh(), 5000);
                    }
                },
                
                toggleAutoRefresh() {
                    this.autoRefresh = !this.autoRefresh;
                    this.startAutoRefresh();
                },
                
                async refresh() {
                    this.loading = true;
                    try {
                        // Fetch status
                        const statusRes = await fetch('/api/status');
                        const statusData = await statusRes.json();
                        this.status = statusData;
                        this.serverName = statusData.server_name || 'Unknown';
                        
                        // Fetch instances
                        const instancesRes = await fetch('/api/servers');
                        const instancesData = await instancesRes.json();
                        this.instances = instancesData.instances || [];
                        
                        // Fetch config
                        const configRes = await fetch('/api/config');
                        this.config = await configRes.json();
                        
                        // Update target servers from config
                        if (this.config.svr_total && this.config.svr_total.value !== undefined) {
                            this.targetServers = this.config.svr_total.value;
                        }
                    } catch (error) {
                        console.error('Error fetching data:', error);
                        this.showToast('Failed to fetch data', 'error');
                    }
                    this.loading = false;
                },
                
                get readyCount() {
                    return this.instances.filter(i => i.status === 'READY').length;
                },
                
                get occupiedCount() {
                    return this.instances.filter(i => i.status === 'OCCUPIED').length;
                },
                
                get totalPlayers() {
                    return this.instances.reduce((sum, i) => sum + (i.num_clients || 0), 0);
                },
                
                get filteredReplays() {
                    if (!this.replaySearchQuery.trim()) {
                        return this.replays;
                    }
                    const query = this.replaySearchQuery.trim().toLowerCase().replace(/^m/i, '');
                    return this.replays.filter(r => 
                        r.match_id.toLowerCase().includes(query) || 
                        r.filename.toLowerCase().includes(query)
                    );
                },
                
                // Filtered and sorted instances
                filteredInstances() {
                    let result = [...this.instances];
                    
                    // Search filter
                    if (this.instanceSearch) {
                        const search = this.instanceSearch.toLowerCase();
                        result = result.filter(i => 
                            String(i.id).includes(search) ||
                            String(i.port).includes(search) ||
                            (i.status && i.status.toLowerCase().includes(search)) ||
                            (i.game_phase && i.game_phase.toLowerCase().includes(search)) ||
                            (i.match_id && i.match_id.toLowerCase().includes(search)) ||
                            (i.players && i.players.some(p => p.name && p.name.toLowerCase().includes(search)))
                        );
                    }
                    
                    // Status filter
                    if (this.instanceFilter !== 'all') {
                        result = result.filter(i => i.status === this.instanceFilter);
                    }
                    
                    // Sort
                    result.sort((a, b) => {
                        let valA, valB;
                        switch (this.instanceSort) {
                            case 'id':
                                valA = a.id;
                                valB = b.id;
                                break;
                            case 'port':
                                valA = a.port;
                                valB = b.port;
                                break;
                            case 'status':
                                valA = a.status || '';
                                valB = b.status || '';
                                break;
                            case 'players':
                                valA = a.num_clients || 0;
                                valB = b.num_clients || 0;
                                break;
                            case 'uptime':
                                valA = a.uptime || 0;
                                valB = b.uptime || 0;
                                break;
                            default:
                                valA = a.id;
                                valB = b.id;
                        }
                        
                        if (typeof valA === 'string') {
                            return this.instanceSortAsc 
                                ? valA.localeCompare(valB) 
                                : valB.localeCompare(valA);
                        }
                        return this.instanceSortAsc ? valA - valB : valB - valA;
                    });
                    
                    return result;
                },
                
                toggleSort(field) {
                    if (this.instanceSort === field) {
                        this.instanceSortAsc = !this.instanceSortAsc;
                    } else {
                        this.instanceSort = field;
                        this.instanceSortAsc = true;
                    }
                },
                
                getStatusColor(status) {
                    const colors = {
                        'READY': 'bg-green-500',
                        'OCCUPIED': 'bg-yellow-500',
                        'STARTING': 'bg-blue-500 animate-pulse-slow',
                        'QUEUED': 'bg-blue-500 animate-pulse-slow',
                        'UNKNOWN': 'bg-gray-500',
                        'CRASHED': 'bg-red-500'
                    };
                    return colors[status] || 'bg-gray-500';
                },
                
                getStatusBadgeClass(status) {
                    const classes = {
                        'READY': 'bg-green-600 text-white',
                        'OCCUPIED': 'bg-yellow-600 text-white',
                        'STARTING': 'bg-blue-600 text-white',
                        'QUEUED': 'bg-blue-600 text-white',
                        'UNKNOWN': 'bg-gray-600 text-white',
                        'CRASHED': 'bg-red-600 text-white'
                    };
                    return classes[status] || 'bg-gray-600 text-white';
                },
                
                formatUptime(seconds) {
                    if (!seconds || seconds === 0 || isNaN(seconds)) return '-';
                    seconds = Math.floor(seconds);
                    const h = Math.floor(seconds / 3600);
                    const m = Math.floor((seconds % 3600) / 60);
                    const s = Math.floor(seconds % 60);
                    if (h > 0) return `${h}h ${m}m`;
                    if (m > 0) return `${m}m ${s}s`;
                    return `${s}s`;
                },
                
                // Health Check Functions
                openHealthCheck() {
                    this.showHealthModal = true;
                    this.runHealthCheck();
                },
                
                async runHealthCheck() {
                    this.healthLoading = true;
                    await this.refresh();
                    this.healthLoading = false;
                },
                
                getHealthStatus(instance) {
                    const issues = this.getHealthIssues(instance);
                    if (issues.some(i => i.includes('Critical'))) return 'Critical';
                    if (issues.length > 0) return 'Warning';
                    return 'Healthy';
                },
                
                getHealthColor(instance) {
                    const status = this.getHealthStatus(instance);
                    if (status === 'Critical') return 'bg-red-500';
                    if (status === 'Warning') return 'bg-yellow-500';
                    return 'bg-green-500';
                },
                
                getHealthBadge(instance) {
                    const status = this.getHealthStatus(instance);
                    if (status === 'Critical') return 'bg-red-600 text-white';
                    if (status === 'Warning') return 'bg-yellow-600 text-white';
                    return 'bg-green-600 text-white';
                },
                
                getHealthIcon(instance) {
                    const status = this.getHealthStatus(instance);
                    if (status === 'Critical') return 'fa-times-circle mr-1';
                    if (status === 'Warning') return 'fa-exclamation-triangle mr-1';
                    return 'fa-check-circle mr-1';
                },
                
                getHealthIssues(instance) {
                    const issues = [];
                    
                    // Check status
                    if (instance.status === 'CRASHED') {
                        issues.push('Critical: Server crashed');
                    }
                    if (instance.status === 'UNKNOWN') {
                        issues.push('Warning: Unknown status');
                    }
                    
                    // Check uptime (if server just started or restarted frequently)
                    if (instance.uptime && instance.uptime < 60) {
                        issues.push('Warning: Recently started (< 1 min)');
                    }
                    
                    // Check memory usage (if available)
                    if (instance.memory_mb && instance.memory_mb > 2000) {
                        issues.push('Warning: High memory usage (> 2GB)');
                    }
                    
                    // Check if server is stuck in starting state
                    if (instance.status === 'STARTING' && instance.uptime && instance.uptime > 120) {
                        issues.push('Warning: Stuck in starting state');
                    }
                    
                    return issues;
                },
                
                getHealthyCount() {
                    return this.instances.filter(i => this.getHealthStatus(i) === 'Healthy').length;
                },
                
                getWarningCount() {
                    return this.instances.filter(i => this.getHealthStatus(i) === 'Warning').length;
                },
                
                getCriticalCount() {
                    return this.instances.filter(i => this.getHealthStatus(i) === 'Critical').length;
                },
                
                async startServer(id) {
                    try {
                        await fetch(`/api/servers/${id}/start`, { method: 'POST' });
                        this.showToast(`Server #${id} start requested`, 'success');
                        setTimeout(() => this.refresh(), 1000);
                    } catch (error) {
                        this.showToast(`Failed to start server #${id}`, 'error');
                    }
                },
                
                async stopServer(id) {
                    if (!confirm(`Are you sure you want to stop Server #${id}?`)) return;
                    try {
                        await fetch(`/api/servers/${id}/stop`, { method: 'POST' });
                        this.showToast(`Server #${id} stop requested`, 'success');
                        setTimeout(() => this.refresh(), 1000);
                    } catch (error) {
                        this.showToast(`Failed to stop server #${id}`, 'error');
                    }
                },
                
                async restartServer(id) {
                    if (!confirm(`Are you sure you want to restart Server #${id}?`)) return;
                    try {
                        await fetch(`/api/servers/${id}/restart`, { method: 'POST' });
                        this.showToast(`Server #${id} restart requested`, 'success');
                        setTimeout(() => this.refresh(), 1000);
                    } catch (error) {
                        this.showToast(`Failed to restart server #${id}`, 'error');
                    }
                },
                
                messageServer(id) {
                    this.messageTargetId = id;
                    this.messageText = '';
                    this.showMessageModal = true;
                },
                
                showInstanceDetails(instance) {
                    this.selectedInstance = { ...instance };
                    this.showInstanceModal = true;
                },

                showPlayerDetails(player) {
                    this.selectedPlayer = { ...player };
                    this.showPlayerDetailsModal = true;
                },
                
                async deleteServer(id) {
                    if (!confirm(`Are you sure you want to DELETE Server #${id}? This will permanently remove this server instance.`)) return;
                    try {
                        this.showToast(`Deleting Server #${id}...`, 'info');
                        const response = await fetch(`/api/servers/${id}`, { method: 'DELETE' });
                        const result = await response.json();
                        
                        if (response.ok && result.status === 'ok') {
                            this.showToast(`Server #${id} deleted successfully`, 'success');
                            setTimeout(() => this.refresh(), 2000);
                        } else {
                            this.showToast(result.error || `Failed to delete server #${id}`, 'error');
                        }
                    } catch (error) {
                        console.error('Delete server error:', error);
                        this.showToast(`Failed to delete server #${id}: ` + error.message, 'error');
                    }
                },
                
                async sendMessage() {
                    if (!this.messageText.trim()) return;
                    try {
                        await fetch(`/api/servers/${this.messageTargetId}/message`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ message: this.messageText })
                        });
                        this.showToast(`Message sent to Server #${this.messageTargetId}`, 'success');
                        this.showMessageModal = false;
                    } catch (error) {
                        this.showToast('Failed to send message', 'error');
                    }
                },
                
                async startupAll() {
                    if (!confirm('Start all servers?')) return;
                    try {
                        await fetch('/api/servers/start-all', { method: 'POST' });
                        this.showToast('Starting all servers...', 'success');
                        setTimeout(() => this.refresh(), 2000);
                    } catch (error) {
                        this.showToast('Failed to start all servers', 'error');
                    }
                },
                
                async shutdownAll() {
                    if (!confirm('Shutdown all servers? This will end any active games!')) return;
                    try {
                        await fetch('/api/servers/stop-all', { method: 'POST' });
                        this.showToast('Shutting down all servers...', 'success');
                        setTimeout(() => this.refresh(), 2000);
                    } catch (error) {
                        this.showToast('Failed to shutdown all servers', 'error');
                    }
                },
                
                async addServer() {
                    // Legacy single server add
                    this.addServerCount = 1;
                    await this.addServers();
                },
                
                async addServers() {
                    try {
                        const count = this.addServerCount || 1;
                        this.showAddServerModal = false;
                        this.showToast(`Adding ${count} new server(s)...`, 'info');
                        
                        const response = await fetch('/api/servers/add', { 
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ count: count })
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok && result.status === 'ok') {
                            this.showToast(`Successfully added ${result.count} server(s). Total: ${result.new_total}`, 'success');
                            setTimeout(() => this.refresh(), 3000);
                        } else {
                            this.showToast(result.error || 'Failed to add servers', 'error');
                        }
                    } catch (error) {
                        console.error('Add servers error:', error);
                        this.showToast('Failed to add server: ' + error.message, 'error');
                    }
                },
                
                async deleteAll() {
                    // Legacy delete all - redirect to modal
                    this.deleteMode = 'all';
                    this.showDeleteServerModal = true;
                },
                
                async deleteServers() {
                    const isDeleteAll = this.deleteMode === 'all';
                    const count = isDeleteAll ? this.instances.length : this.deleteServerCount;
                    
                    if (isDeleteAll) {
                        if (!confirm('DELETE ALL SERVERS? This will permanently remove all server instances!')) return;
                        if (!confirm('Are you REALLY sure? This action cannot be undone!')) return;
                    } else {
                        if (!confirm(`Delete ${count} server(s)? This action cannot be undone!`)) return;
                    }
                    
                    try {
                        this.showDeleteServerModal = false;
                        this.showToast(isDeleteAll ? 'Deleting all servers...' : `Deleting ${count} server(s)...`, 'info');
                        
                        const response = await fetch('/api/servers/delete', { 
                            method: 'DELETE',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ count: isDeleteAll ? 'all' : count })
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok && result.status === 'ok') {
                            this.showToast(`Successfully deleted ${result.deleted} server(s)`, 'success');
                            // Refresh after a delay to let servers fully shutdown
                            setTimeout(() => this.refresh(), 2000);
                        } else {
                            this.showToast(result.error || 'Failed to delete servers', 'error');
                        }
                    } catch (error) {
                        console.error('Delete servers error:', error);
                        this.showToast('Failed to delete servers: ' + error.message, 'error');
                    }
                },
                
                increaseTargetServers() {
                    if (this.targetServers < 20) {
                        this.targetServers++;
                    }
                },
                
                decreaseTargetServers() {
                    if (this.targetServers > 0) {
                        this.targetServers--;
                    }
                },
                
                setTargetServers(n) {
                    this.targetServers = n;
                },
                
                async applyTargetServers() {
                    const current = this.instances.length;
                    const target = this.targetServers;
                    
                    if (current === target) {
                        this.showToast(`Already at ${target} servers`, 'info');
                        return;
                    }
                    
                    const action = target > current ? 'scale up' : 'scale down';
                    if (!confirm(`${action.toUpperCase()} from ${current} to ${target} servers?`)) return;
                    
                    try {
                        const response = await fetch('/api/servers/scale', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ target: target })
                        });
                        const result = await response.json();
                        if (result.status === 'ok') {
                            this.showToast(result.message, 'success');
                            setTimeout(() => this.refresh(), 3000);
                        } else {
                            this.showToast(result.error || 'Failed to scale', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to scale servers', 'error');
                    }
                },
                
                async restartAll() {
                    if (!confirm('Restart all servers? Active games will be interrupted!')) return;
                    try {
                        await fetch('/api/servers/restart-all', { method: 'POST' });
                        this.showToast('Restarting all servers...', 'success');
                        setTimeout(() => this.refresh(), 5000);
                    } catch (error) {
                        this.showToast('Failed to restart all servers', 'error');
                    }
                },
                
                messageAll() {
                    this.showBroadcastModal = true;
                    this.broadcastText = '';
                    this.broadcastType = 'normal';
                },
                
                formatBroadcastMessage(message, type) {
                    const prefixes = {
                        'normal': '',
                        'announcement': '^y[ANNOUNCEMENT] ^w',
                        'warning': '^r[WARNING] ^y',
                        'system': '^c[SYSTEM] ^w'
                    };
                    return (prefixes[type] || '') + message;
                },
                
                async sendBroadcastMessage() {
                    if (!this.broadcastText.trim()) return;
                    try {
                        const formattedMessage = this.formatBroadcastMessage(this.broadcastText, this.broadcastType);
                        const response = await fetch('/api/servers/message-all', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ 
                                message: formattedMessage,
                                type: this.broadcastType
                            })
                        });
                        const result = await response.json();
                        if (result.status === 'ok') {
                            this.showToast(result.message, 'success');
                            this.showBroadcastModal = false;
                        } else {
                            this.showToast(result.error || 'Failed to broadcast', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to send broadcast message', 'error');
                    }
                },

                // Console functions
                async refreshLogs() {
                    this.logsLoading = true;
                    try {
                        const response = await fetch('/api/logs/manager?lines=200');
                        const data = await response.json();
                        this.consoleLogs = data.logs || [];
                        this.$nextTick(() => this.scrollToBottom());
                    } catch (error) {
                        this.consoleLogs = ['Error fetching logs: ' + error.message];
                    }
                    this.logsLoading = false;
                },
                
                clearConsole() {
                    this.consoleLogs = [];
                },
                
                scrollToBottom() {
                    if (this.autoScrollLogs && this.$refs.logContainer) {
                        this.$refs.logContainer.scrollTop = this.$refs.logContainer.scrollHeight;
                    }
                },
                
                async executeCommand() {
                    const cmd = this.commandInput.trim();
                    if (!cmd) return;
                    
                    // Add to history
                    this.commandHistory.push(cmd);
                    this.commandHistoryIndex = this.commandHistory.length;
                    
                    // Show command in console
                    this.consoleLogs.push(`> ${cmd}`);
                    this.commandInput = '';
                    
                    try {
                        const response = await fetch('/api/console/execute', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ command: cmd })
                        });
                        const result = await response.json();
                        
                        if (result.output) {
                            result.output.forEach(line => this.consoleLogs.push(line));
                        }
                        if (result.error) {
                            this.consoleLogs.push(`ERROR: ${result.error}`);
                        }
                        
                        // Auto refresh after commands that change state
                        if (['shutdown', 'startup', 'restart', 'add'].some(c => cmd.toLowerCase().startsWith(c))) {
                            setTimeout(() => this.refresh(), 2000);
                        }
                    } catch (error) {
                        this.consoleLogs.push(`ERROR: ${error.message}`);
                    }
                    
                    this.$nextTick(() => this.scrollToBottom());
                },
                
                quickCommand(cmd) {
                    this.commandInput = cmd;
                    this.executeCommand();
                },
                
                prevCommand() {
                    if (this.commandHistoryIndex > 0) {
                        this.commandHistoryIndex--;
                        this.commandInput = this.commandHistory[this.commandHistoryIndex];
                    }
                },
                
                nextCommand() {
                    if (this.commandHistoryIndex < this.commandHistory.length - 1) {
                        this.commandHistoryIndex++;
                        this.commandInput = this.commandHistory[this.commandHistoryIndex];
                    } else {
                        this.commandHistoryIndex = this.commandHistory.length;
                        this.commandInput = '';
                    }
                },

                // Quick settings toggle (auto-save)
                async toggleQuickSetting(key) {
                    if (this.config[key] && typeof this.config[key].value === 'boolean') {
                        this.config[key].value = !this.config[key].value;
                        // Auto-save after toggle
                        await this.saveConfig();
                    }
                },

                formatConfigKey(key) {
                    // Convert svr_name to "Server Name", man_enableProxy to "Enable Proxy"
                    return key
                        .replace('svr_', '')
                        .replace('man_', '')
                        .replace(/_/g, ' ')
                        .replace(/([A-Z])/g, ' $1')
                        .split(' ')
                        .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                        .join(' ');
                },

                // Config helper functions
                filterConfig(key) {
                    if (!this.configSearch) return true;
                    const searchLower = this.configSearch.toLowerCase();
                    const keyLower = key.toLowerCase();
                    const formattedKey = this.formatConfigKey(key).toLowerCase();
                    return keyLower.includes(searchLower) || formattedKey.includes(searchLower);
                },

                getConfigTooltip(key) {
                    const tooltips = {
                        'svr_total': 'Total number of game servers to run',
                        'svr_starting_gamePort': 'Starting port number for game servers',
                        'man_enableProxy': 'Enable proxy for game connections (adds 10000 to port)',
                        'svr_ip': 'Server IP address for game connections',
                        'svr_name': 'Display name of the server',
                        'svr_location': 'Server geographic location/region',
                        'svr_maxClients': 'Maximum players per game server',
                        'man_enableProxy': 'Enable proxy mode for the manager',
                        'man_proxyAddress': 'Address for proxy connections',
                        'man_apiPort': 'Port for the dashboard API',
                        'man_enableAPI': 'Enable the dashboard API server'
                    };
                    return tooltips[key] || null;
                },

                // System Status functions
                async refreshSystemStatus() {
                    this.systemLoading = true;
                    try {
                        const response = await fetch('/api/health/resources');
                        const data = await response.json();
                        this.systemStatus = data;
                    } catch (error) {
                        console.error('Error fetching system status:', error);
                        this.showToast('Failed to fetch system status', 'error');
                    }
                    this.systemLoading = false;
                },
                
                async saveConfig() {
                    try {
                        // Extract values from config
                        const configToSave = {};
                        for (const [key, item] of Object.entries(this.config)) {
                            if (typeof item === 'object' && item.editable) {
                                configToSave[key] = item.value;
                            }
                        }
                        
                        const response = await fetch('/api/config', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(configToSave)
                        });
                        
                        const result = await response.json();
                        if (result.status === 'ok') {
                            this.showToast('Configuration saved!', 'success');
                            setTimeout(() => this.refresh(), 1000);
                        } else {
                            this.showToast(result.error || 'Failed to save', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to save configuration', 'error');
                    }
                },

                // SignalR for real-time updates
                setupWebSocket() {
                    // Skip SignalR if not available, use polling instead
                    if (typeof signalR === 'undefined') {
                        console.log('SignalR not loaded, using polling');
                        return;
                    }

                    try {
                        this.connection = new signalR.HubConnectionBuilder()
                            .withUrl('/hubs/dashboard')
                            .withAutomaticReconnect([0, 2000, 5000, 10000])
                            .build();

                        this.connection.on('StatusUpdate', (data) => {
                            this.handleWebSocketMessage({ type: 'status_update', payload: data });
                        });

                        this.connection.on('InstanceUpdate', (data) => {
                            this.handleWebSocketMessage({ type: 'instances_update', payload: { instances: data } });
                        });

                        this.connection.on('SystemUpdate', (data) => {
                            this.handleWebSocketMessage({ type: 'system_update', payload: data });
                        });

                        this.connection.on('LogMessage', (data) => {
                            this.handleWebSocketMessage({ type: 'log', payload: data });
                        });

                        this.connection.on('Notification', (type, title, message) => {
                            this.handleWebSocketMessage({ type: 'notification', payload: { type, title, message } });
                        });

                        this.connection.start()
                            .then(() => {
                                console.log('SignalR connected');
                                this.addNotification('info', 'Connected', 'Real-time updates enabled');
                            })
                            .catch(err => console.log('SignalR error, using polling:', err));
                    } catch (e) {
                        console.log('SignalR not available, using polling');
                    }
                },
                
                handleWebSocketMessage(data) {
                    switch (data.type) {
                        case 'status_update':
                            this.status = data.payload;
                            this.serverName = data.payload.server_name || this.serverName;
                            break;
                        case 'instances_update':
                            this.instances = data.payload.instances || [];
                            break;
                        case 'system_update':
                            this.systemStatus = data.payload;
                            this.updateChartData();
                            break;
                        case 'log':
                            this.consoleLogs.push(data.payload);
                            this.$nextTick(() => this.scrollToBottom());
                            break;
                        case 'notification':
                            this.addNotification(data.payload.type, data.payload.title, data.payload.message);
                            break;
                        case 'server_down':
                            this.addNotification('error', 'Server Down', `Server #${data.payload.id} has crashed!`);
                            break;
                        case 'disk_warning':
                            this.addNotification('warning', 'Disk Space Low', `Disk usage is at ${data.payload.percent}%`);
                            break;
                    }
                },

                // Charts functions
                initCharts() {
                    // Destroy existing charts
                    Object.values(this.charts).forEach(chart => chart.destroy());
                    this.charts = {};
                    
                    const chartOptions = {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: { duration: 0 },
                        scales: {
                            x: {
                                display: false
                            },
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(255,255,255,0.1)' },
                                ticks: { color: 'rgba(255,255,255,0.5)' }
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    };
                    
                    // CPU Chart
                    const cpuCtx = document.getElementById('cpuChart');
                    if (cpuCtx) {
                        this.charts.cpu = new Chart(cpuCtx, {
                            type: 'line',
                            data: {
                                labels: this.chartData.labels,
                                datasets: [{
                                    label: 'CPU %',
                                    data: this.chartData.cpu,
                                    borderColor: '#3b82f6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: chartOptions
                        });
                    }
                    
                    // Memory Chart
                    const memoryCtx = document.getElementById('memoryChart');
                    if (memoryCtx) {
                        this.charts.memory = new Chart(memoryCtx, {
                            type: 'line',
                            data: {
                                labels: this.chartData.labels,
                                datasets: [{
                                    label: 'Memory %',
                                    data: this.chartData.memory,
                                    borderColor: '#10b981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: chartOptions
                        });
                    }
                    
                    // Network Chart
                    const networkCtx = document.getElementById('networkChart');
                    if (networkCtx) {
                        this.charts.network = new Chart(networkCtx, {
                            type: 'line',
                            data: {
                                labels: this.chartData.labels,
                                datasets: [
                                    {
                                        label: 'Sent',
                                        data: this.chartData.networkSent,
                                        borderColor: '#f59e0b',
                                        backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                        fill: false,
                                        tension: 0.4
                                    },
                                    {
                                        label: 'Received',
                                        data: this.chartData.networkRecv,
                                        borderColor: '#8b5cf6',
                                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                                        fill: false,
                                        tension: 0.4
                                    }
                                ]
                            },
                            options: {
                                ...chartOptions,
                                scales: {
                                    ...chartOptions.scales,
                                    y: { ...chartOptions.scales.y, max: undefined }
                                },
                                plugins: {
                                    legend: { 
                                        display: true,
                                        labels: { color: 'rgba(255,255,255,0.7)' }
                                    }
                                }
                            }
                        });
                    }
                    
                    // Players Chart
                    const playersCtx = document.getElementById('playersChart');
                    if (playersCtx) {
                        this.charts.players = new Chart(playersCtx, {
                            type: 'line',
                            data: {
                                labels: this.chartData.labels,
                                datasets: [{
                                    label: 'Players',
                                    data: this.chartData.players,
                                    borderColor: '#ec4899',
                                    backgroundColor: 'rgba(236, 72, 153, 0.1)',
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: {
                                ...chartOptions,
                                scales: {
                                    ...chartOptions.scales,
                                    y: { ...chartOptions.scales.y, max: undefined }
                                }
                            }
                        });
                    }
                    
                    // Load initial data
                    this.loadChartHistory();
                },
                
                async loadChartHistory() {
                    try {
                        const response = await fetch('/api/metrics/history');
                        const data = await response.json();
                        if (data.history) {
                            this.chartData = data.history;
                            this.chartUpdateCount = data.history.labels.length;
                            this.updateAllCharts();
                        }
                    } catch (e) {
                        console.log('No chart history available');
                    }
                },
                
                updateChartData() {
                    const now = new Date().toLocaleTimeString();
                    
                    // Add new data points
                    this.chartData.labels.push(now);
                    this.chartData.cpu.push(this.systemStatus.cpu_percent || 0);
                    this.chartData.memory.push(this.systemStatus.memory_percent || 0);
                    this.chartData.networkSent.push(this.systemStatus.network_sent_rate || 0);
                    this.chartData.networkRecv.push(this.systemStatus.network_recv_rate || 0);
                    this.chartData.players.push(this.totalPlayers);
                    
                    // Keep only last N points
                    if (this.chartData.labels.length > this.maxChartPoints) {
                        this.chartData.labels.shift();
                        this.chartData.cpu.shift();
                        this.chartData.memory.shift();
                        this.chartData.networkSent.shift();
                        this.chartData.networkRecv.shift();
                        this.chartData.players.shift();
                    }
                    
                    this.chartUpdateCount++;
                    this.updateAllCharts();
                },
                
                updateAllCharts() {
                    Object.values(this.charts).forEach(chart => {
                        if (chart) chart.update('none');
                    });
                },

                // Server Logs functions
                async refreshServerLogs() {
                    this.serverLogsLoading = true;
                    try {
                        const serverId = this.selectedLogServer;
                        const response = await fetch(`/api/logs/${serverId}?lines=500`);
                        const data = await response.json();
                        this.serverLogs = data.logs || [];
                        
                        // Scroll to bottom
                        this.$nextTick(() => {
                            const container = document.getElementById('serverLogContainer');
                            if (container) container.scrollTop = container.scrollHeight;
                        });
                    } catch (error) {
                        this.serverLogs = ['Error fetching logs: ' + error.message];
                    }
                    this.serverLogsLoading = false;
                },
                
                async downloadLog() {
                    const serverId = this.selectedLogServer;
                    window.open(`/api/logs/${serverId}/download`, '_blank');
                },

                // Replays functions
                async refreshReplays() {
                    this.replaysLoading = true;
                    try {
                        const response = await fetch('/api/replays');
                        const data = await response.json();
                        this.replays = data.replays || [];
                        this.replaysTotalSize = data.total_size || '0 MB';
                    } catch (error) {
                        this.replays = [];
                        this.showToast('Failed to load replays', 'error');
                    }
                    this.replaysLoading = false;
                },
                
                async deleteReplay(filename) {
                    if (!confirm(`Delete replay ${filename}?`)) return;
                    try {
                        const response = await fetch(`/api/replays/${filename}`, { 
                            method: 'DELETE' 
                        });
                        const result = await response.json();
                        if (result.status === 'ok') {
                            this.showToast('Replay deleted', 'success');
                            await this.refreshReplays();
                        } else {
                            this.showToast(result.error || 'Failed to delete', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to delete replay', 'error');
                    }
                },
                
                async deleteOldReplays() {
                    const days = this.deleteReplaysOlderThan;
                    if (!confirm(`Delete all replays older than ${days} days?`)) return;
                    try {
                        const response = await fetch(`/api/replays/cleanup?days=${days}`, {
                            method: 'DELETE'
                        });
                        const result = await response.json();
                        if (result.status === 'ok') {
                            this.showToast(`Deleted ${result.count} replays`, 'success');
                            this.showDeleteOldReplaysModal = false;
                            await this.refreshReplays();
                        } else {
                            this.showToast(result.error || 'Failed to cleanup', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to cleanup replays', 'error');
                    }
                },

                // Statistics functions
                async loadStatistics() {
                    this.statisticsLoading = true;
                    try {
                        // Load summary
                        const summaryResp = await fetch('/api/statistics/summary');
                        if (summaryResp.ok) {
                            this.statistics.summary = await summaryResp.json();
                        }
                        
                        // Load recent matches
                        const matchesResp = await fetch('/api/statistics/matches?count=10');
                        if (matchesResp.ok) {
                            const data = await matchesResp.json();
                            this.statistics.recentMatches = data.matches || [];
                        }
                        
                        // Load top players
                        const playersResp = await fetch('/api/statistics/players/top?count=10');
                        if (playersResp.ok) {
                            const data = await playersResp.json();
                            this.statistics.topPlayers = data.players || [];
                        }
                        
                        // Load daily stats
                        const dailyResp = await fetch('/api/statistics/daily?days=7');
                        if (dailyResp.ok) {
                            const data = await dailyResp.json();
                            this.statistics.dailyStats = data.stats || [];
                            this.updateDailyStatsChart();
                        }
                    } catch (error) {
                        console.error('Failed to load statistics:', error);
                    } finally {
                        this.statisticsLoading = false;
                    }
                },
                
                updateDailyStatsChart() {
                    const ctx = document.getElementById('dailyStatsChart');
                    if (!ctx) return;
                    
                    if (this.dailyStatsChart) {
                        this.dailyStatsChart.destroy();
                    }
                    
                    const labels = this.statistics.dailyStats.map(d => d.date);
                    const matchesData = this.statistics.dailyStats.map(d => d.matchCount);
                    const playersData = this.statistics.dailyStats.map(d => d.uniquePlayers);
                    
                    this.dailyStatsChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Matches',
                                    data: matchesData,
                                    borderColor: 'rgb(59, 130, 246)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    fill: true,
                                    tension: 0.4
                                },
                                {
                                    label: 'Players',
                                    data: playersData,
                                    borderColor: 'rgb(16, 185, 129)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    fill: true,
                                    tension: 0.4
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    labels: { color: '#9CA3AF' }
                                }
                            },
                            scales: {
                                x: {
                                    ticks: { color: '#9CA3AF' },
                                    grid: { color: 'rgba(75, 85, 99, 0.3)' }
                                },
                                y: {
                                    ticks: { color: '#9CA3AF' },
                                    grid: { color: 'rgba(75, 85, 99, 0.3)' },
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                },

                // Auto-scaling functions
                async loadScalingStatus() {
                    this.scalingLoading = true;
                    try {
                        const response = await fetch('/api/scaling/status');
                        if (response.ok) {
                            const data = await response.json();
                            this.scaling = { ...this.scaling, ...data };
                        }
                    } catch (error) {
                        console.error('Failed to load scaling status:', error);
                    } finally {
                        this.scalingLoading = false;
                    }
                },
                
                async manualScaleUp() {
                    try {
                        const response = await fetch('/api/scaling/scale-up', { method: 'POST' });
                        const result = await response.json();
                        if (response.ok) {
                            this.showToast('Scale up initiated', 'success');
                            await this.loadScalingStatus();
                            await this.refresh();
                        } else {
                            this.showToast(result.error || 'Failed to scale up', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to scale up', 'error');
                    }
                },
                
                async manualScaleDown() {
                    try {
                        const response = await fetch('/api/scaling/scale-down', { method: 'POST' });
                        const result = await response.json();
                        if (response.ok) {
                            this.showToast('Scale down initiated', 'success');
                            await this.loadScalingStatus();
                            await this.refresh();
                        } else {
                            this.showToast(result.error || 'Failed to scale down', 'error');
                        }
                    } catch (error) {
                        this.showToast('Failed to scale down', 'error');
                    }
                },

                // Notification functions
                addNotification(type, title, message) {
                    const id = ++this.notificationId;
                    this.notifications.push({ id, type, title, message, show: true });
                    
                    // Auto dismiss after 10 seconds
                    setTimeout(() => this.dismissNotification(id), 10000);
                },
                
                dismissNotification(id) {
                    const notif = this.notifications.find(n => n.id === id);
                    if (notif) {
                        notif.show = false;
                        setTimeout(() => {
                            this.notifications = this.notifications.filter(n => n.id !== id);
                        }, 300);
                    }
                },
                
                
                logout() {
                    localStorage.removeItem('authToken');
                    localStorage.removeItem('authUser');
                    sessionStorage.removeItem('authToken');
                    sessionStorage.removeItem('authUser');
                    window.location.href = '/login.html';
                },

                showToast(message, type = 'info') {
                    const id = Date.now();
                    this.toasts.push({ id, message, type, show: true });
                    setTimeout(() => {
                        const toast = this.toasts.find(t => t.id === id);
                        if (toast) toast.show = false;
                        setTimeout(() => {
                            this.toasts = this.toasts.filter(t => t.id !== id);
                        }, 300);
                    }, 3000);
                }
            };
        }
    </script>
</body>
</html>




